<!-- Code generated by gomarkdoc. DO NOT EDIT -->

# cmd

```go
import "github.com/aaronlmathis/gosight-server/cmd"
```

File: server/cmd/main.go

## Index

- [Variables](<#variables>)


## Variables

<a name="Version"></a>

```go
var Version = "dev" // default
```

# debugtools

```go
import "github.com/aaronlmathis/gosight-server/debugtools"
```

## Index

- [func EstimateMetricCacheMemory\(mc cache.MetricCache\) int](<#EstimateMetricCacheMemory>)
- [func EstimateTagCacheMemory\(tc cache.TagCache\) int](<#EstimateTagCacheMemory>)
- [func PrintAuditReport\(title string, results \[\]CacheAuditResult\)](<#PrintAuditReport>)
- [type CacheAuditReport](<#CacheAuditReport>)
  - [func AuditCaches\(tagCache cache.TagCache, metricCache cache.MetricCache\) CacheAuditReport](<#AuditCaches>)
- [type CacheAuditResult](<#CacheAuditResult>)
  - [func AuditMetricCache\(mc cache.MetricCache\) \[\]CacheAuditResult](<#AuditMetricCache>)
  - [func AuditTagCache\(tc cache.TagCache\) \[\]CacheAuditResult](<#AuditTagCache>)


<a name="EstimateMetricCacheMemory"></a>
## func [EstimateMetricCacheMemory](<https://github.com/aaronlmathis/gosight-server/blob/main/debugtools/auditcache.go#L148>)

```go
func EstimateMetricCacheMemory(mc cache.MetricCache) int
```



<a name="EstimateTagCacheMemory"></a>
## func [EstimateTagCacheMemory](<https://github.com/aaronlmathis/gosight-server/blob/main/debugtools/auditcache.go#L134>)

```go
func EstimateTagCacheMemory(tc cache.TagCache) int
```



<a name="PrintAuditReport"></a>
## func [PrintAuditReport](<https://github.com/aaronlmathis/gosight-server/blob/main/debugtools/auditcache.go#L160>)

```go
func PrintAuditReport(title string, results []CacheAuditResult)
```



<a name="CacheAuditReport"></a>
## type [CacheAuditReport](<https://github.com/aaronlmathis/gosight-server/blob/main/debugtools/auditcache.go#L19-L25>)



```go
type CacheAuditReport struct {
    TagCache            []CacheAuditResult `json:"tag_cache"`
    MetricCache         []CacheAuditResult `json:"metric_cache"`
    RedundantKeys       []string           `json:"redundant_keys"`
    TagCacheMemoryKB    int                `json:"tag_cache_estimated_kb"`
    MetricCacheMemoryKB int                `json:"metric_cache_estimated_kb"`
}
```

<a name="AuditCaches"></a>
### func [AuditCaches](<https://github.com/aaronlmathis/gosight-server/blob/main/debugtools/auditcache.go#L27>)

```go
func AuditCaches(tagCache cache.TagCache, metricCache cache.MetricCache) CacheAuditReport
```



<a name="CacheAuditResult"></a>
## type [CacheAuditResult](<https://github.com/aaronlmathis/gosight-server/blob/main/debugtools/auditcache.go#L11-L17>)



```go
type CacheAuditResult struct {
    LabelKey        string   `json:"label_key"`
    UniqueValues    int      `json:"unique_values"`
    ExampleValues   []string `json:"example_values"`
    PossibleProblem string   `json:"possible_problem,omitempty"`
    Source          string   `json:"source"` // tag or meta
}
```

<a name="AuditMetricCache"></a>
### func [AuditMetricCache](<https://github.com/aaronlmathis/gosight-server/blob/main/debugtools/auditcache.go#L88>)

```go
func AuditMetricCache(mc cache.MetricCache) []CacheAuditResult
```



<a name="AuditTagCache"></a>
### func [AuditTagCache](<https://github.com/aaronlmathis/gosight-server/blob/main/debugtools/auditcache.go#L55>)

```go
func AuditTagCache(tc cache.TagCache) []CacheAuditResult
```



# alerts

```go
import "github.com/aaronlmathis/gosight-server/internal/alerts"
```

## Index

- [type Manager](<#Manager>)
  - [func NewManager\(emitter \*events.Emitter, dispatcher \*dispatcher.Dispatcher, store alertstore.AlertStore, hub \*websocket.AlertsHub\) \*Manager](<#NewManager>)
  - [func \(m \*Manager\) HandleLogState\(ctx context.Context, rule model.AlertRule, meta \*model.Meta, log model.LogEntry, triggered bool\)](<#Manager.HandleLogState>)
  - [func \(m \*Manager\) HandleState\(ctx context.Context, rule model.AlertRule, meta \*model.Meta, value float64, triggered bool\)](<#Manager.HandleState>)
  - [func \(m \*Manager\) ListActive\(\) \[\]model.AlertInstance](<#Manager.ListActive>)


<a name="Manager"></a>
## type [Manager](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/alerts/manager.go#L17-L24>)



```go
type Manager struct {
    // contains filtered or unexported fields
}
```

<a name="NewManager"></a>
### func [NewManager](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/alerts/manager.go#L26>)

```go
func NewManager(emitter *events.Emitter, dispatcher *dispatcher.Dispatcher, store alertstore.AlertStore, hub *websocket.AlertsHub) *Manager
```



<a name="Manager.HandleLogState"></a>
### func \(\*Manager\) [HandleLogState](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/alerts/manager.go#L127>)

```go
func (m *Manager) HandleLogState(ctx context.Context, rule model.AlertRule, meta *model.Meta, log model.LogEntry, triggered bool)
```



<a name="Manager.HandleState"></a>
### func \(\*Manager\) [HandleState](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/alerts/manager.go#L40>)

```go
func (m *Manager) HandleState(ctx context.Context, rule model.AlertRule, meta *model.Meta, value float64, triggered bool)
```



<a name="Manager.ListActive"></a>
### func \(\*Manager\) [ListActive](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/alerts/manager.go#L231>)

```go
func (m *Manager) ListActive() []model.AlertInstance
```



# gosightauth

```go
import "github.com/aaronlmathis/gosight-server/internal/auth"
```

local.go: Handles login, registration, password validation.

mfa.go: Uses TOTP to generate QR codes/secrets and verify codes.

session.go: Handles signed cookies or token generation/validation.

## Index

- [Variables](<#variables>)
- [func AccessLogMiddleware\(next http.Handler\) http.Handler](<#AccessLogMiddleware>)
- [func AuthMiddleware\(userStore userstore.UserStore\) mux.MiddlewareFunc](<#AuthMiddleware>)
- [func CheckPasswordHash\(password, hash string\) bool](<#CheckPasswordHash>)
- [func CheckRememberMFA\(r \*http.Request, userID string\) bool](<#CheckRememberMFA>)
- [func ClearCookie\(w http.ResponseWriter, name string\)](<#ClearCookie>)
- [func ClearRememberMFA\(w http.ResponseWriter\)](<#ClearRememberMFA>)
- [func ExtractRoleNames\(roles \[\]usermodel.Role\) \[\]string](<#ExtractRoleNames>)
- [func FlattenPermissions\(roles \[\]usermodel.Role\) \[\]string](<#FlattenPermissions>)
- [func GenerateTOTPSecret\(email string\) \(string, error\)](<#GenerateTOTPSecret>)
- [func GenerateToken\(userID string, roles \[\]string, traceID string\) \(string, error\)](<#GenerateToken>)
- [func GetSessionToken\(r \*http.Request\) \(string, error\)](<#GetSessionToken>)
- [func GetSessionUserID\(r \*http.Request\) \(string, error\)](<#GetSessionUserID>)
- [func HasAnyPermission\(ctx context.Context, required ...string\) bool](<#HasAnyPermission>)
- [func HasAnyRole\(roles \[\]string, requiredRoles ...string\) bool](<#HasAnyRole>)
- [func HasPermission\(ctx context.Context, required string\) bool](<#HasPermission>)
- [func HasRole\(roles \[\]string, required string\) bool](<#HasRole>)
- [func HashPassword\(password string\) \(string, error\)](<#HashPassword>)
- [func InitJWTSecret\(encoded string\) error](<#InitJWTSecret>)
- [func InitMFAKey\(encoded string\) error](<#InitMFAKey>)
- [func InjectSessionContext\(ctx context.Context, user \*usermodel.User\) context.Context](<#InjectSessionContext>)
- [func LoadPendingMFA\(r \*http.Request\) \(string, error\)](<#LoadPendingMFA>)
- [func RequireAnyPermissionWithStore\(store userstore.UserStore, required ...string\) func\(http.Handler\) http.Handler](<#RequireAnyPermissionWithStore>)
- [func RequirePermission\(required string, next http.Handler, userStore userstore.UserStore\) http.Handler](<#RequirePermission>)
- [func SavePendingMFA\(userID string, w http.ResponseWriter\)](<#SavePendingMFA>)
- [func SetRememberMFA\(w http.ResponseWriter, userID string, r \*http.Request\)](<#SetRememberMFA>)
- [func SetSessionCookie\(w http.ResponseWriter, token string\)](<#SetSessionCookie>)
- [func ValidateTOTP\(secret, code string\) bool](<#ValidateTOTP>)
- [type AuthProvider](<#AuthProvider>)
- [type GoogleAuth](<#GoogleAuth>)
  - [func \(g \*GoogleAuth\) HandleCallback\(w http.ResponseWriter, r \*http.Request\) \(\*usermodel.User, error\)](<#GoogleAuth.HandleCallback>)
  - [func \(g \*GoogleAuth\) StartLogin\(w http.ResponseWriter, r \*http.Request\)](<#GoogleAuth.StartLogin>)
- [type LocalAuth](<#LocalAuth>)
  - [func \(l \*LocalAuth\) HandleCallback\(w http.ResponseWriter, r \*http.Request\) \(\*usermodel.User, error\)](<#LocalAuth.HandleCallback>)
  - [func \(l \*LocalAuth\) StartLogin\(w http.ResponseWriter, r \*http.Request\)](<#LocalAuth.StartLogin>)
- [type SessionClaims](<#SessionClaims>)
  - [func GetSessionClaims\(r \*http.Request\) \(\*SessionClaims, error\)](<#GetSessionClaims>)
  - [func ValidateToken\(tokenStr string\) \(\*SessionClaims, error\)](<#ValidateToken>)


## Variables

<a name="ErrInvalidPassword"></a>

```go
var (
    ErrInvalidPassword = errors.New("invalid password")
    ErrInvalidTOTP     = errors.New("invalid TOTP code")
    ErrUserNotFound    = errors.New("user not found")
    ErrUnauthorized    = errors.New("unauthorized")
)
```

<a name="ErrNoSession"></a>

```go
var ErrNoSession = errors.New("no session token found")
```

<a name="AccessLogMiddleware"></a>
## func [AccessLogMiddleware](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/auth/middleware.go#L165>)

```go
func AccessLogMiddleware(next http.Handler) http.Handler
```



<a name="AuthMiddleware"></a>
## func [AuthMiddleware](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/auth/middleware.go#L91>)

```go
func AuthMiddleware(userStore userstore.UserStore) mux.MiddlewareFunc
```



<a name="CheckPasswordHash"></a>
## func [CheckPasswordHash](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/auth/password.go#L10>)

```go
func CheckPasswordHash(password, hash string) bool
```



<a name="CheckRememberMFA"></a>
## func [CheckRememberMFA](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/auth/mfa.go#L114>)

```go
func CheckRememberMFA(r *http.Request, userID string) bool
```



<a name="ClearCookie"></a>
## func [ClearCookie](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/auth/session.go#L117>)

```go
func ClearCookie(w http.ResponseWriter, name string)
```

ClearCookie clears a cookie by setting its MaxAge to \-1 and Expiration to the past

<a name="ClearRememberMFA"></a>
## func [ClearRememberMFA](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/auth/mfa.go#L166>)

```go
func ClearRememberMFA(w http.ResponseWriter)
```



<a name="ExtractRoleNames"></a>
## func [ExtractRoleNames](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/auth/common.go#L19>)

```go
func ExtractRoleNames(roles []usermodel.Role) []string
```



<a name="FlattenPermissions"></a>
## func [FlattenPermissions](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/auth/common.go#L5>)

```go
func FlattenPermissions(roles []usermodel.Role) []string
```



<a name="GenerateTOTPSecret"></a>
## func [GenerateTOTPSecret](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/auth/mfa.go#L33>)

```go
func GenerateTOTPSecret(email string) (string, error)
```

TOTP MFA

<a name="GenerateToken"></a>
## func [GenerateToken](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/auth/session.go#L34>)

```go
func GenerateToken(userID string, roles []string, traceID string) (string, error)
```



<a name="GetSessionToken"></a>
## func [GetSessionToken](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/auth/session.go#L85>)

```go
func GetSessionToken(r *http.Request) (string, error)
```

GetSessionToken retrieves the session token from cookie or header

<a name="GetSessionUserID"></a>
## func [GetSessionUserID](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/auth/session.go#L108>)

```go
func GetSessionUserID(r *http.Request) (string, error)
```

Convenience: get user ID from session token in request

<a name="HasAnyPermission"></a>
## func [HasAnyPermission](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/auth/permission.go#L30>)

```go
func HasAnyPermission(ctx context.Context, required ...string) bool
```



<a name="HasAnyRole"></a>
## func [HasAnyRole](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/auth/permission.go#L56>)

```go
func HasAnyRole(roles []string, requiredRoles ...string) bool
```



<a name="HasPermission"></a>
## func [HasPermission](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/auth/permission.go#L11>)

```go
func HasPermission(ctx context.Context, required string) bool
```

HasPermission checks if the current context includes the given permission

<a name="HasRole"></a>
## func [HasRole](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/auth/permission.go#L47>)

```go
func HasRole(roles []string, required string) bool
```



<a name="HashPassword"></a>
## func [HashPassword](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/auth/password.go#L6>)

```go
func HashPassword(password string) (string, error)
```

Password Utilities

<a name="InitJWTSecret"></a>
## func [InitJWTSecret](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/auth/session.go#L25>)

```go
func InitJWTSecret(encoded string) error
```



<a name="InitMFAKey"></a>
## func [InitMFAKey](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/auth/mfa.go#L23>)

```go
func InitMFAKey(encoded string) error
```



<a name="InjectSessionContext"></a>
## func [InjectSessionContext](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/auth/context.go#L11>)

```go
func InjectSessionContext(ctx context.Context, user *usermodel.User) context.Context
```



<a name="LoadPendingMFA"></a>
## func [LoadPendingMFA](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/auth/mfa.go#L49>)

```go
func LoadPendingMFA(r *http.Request) (string, error)
```

LoadPendingMFA retrieves the pending MFA cookie

<a name="RequireAnyPermissionWithStore"></a>
## func [RequireAnyPermissionWithStore](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/auth/middleware.go#L58>)

```go
func RequireAnyPermissionWithStore(store userstore.UserStore, required ...string) func(http.Handler) http.Handler
```



<a name="RequirePermission"></a>
## func [RequirePermission](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/auth/middleware.go#L18>)

```go
func RequirePermission(required string, next http.Handler, userStore userstore.UserStore) http.Handler
```



<a name="SavePendingMFA"></a>
## func [SavePendingMFA](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/auth/mfa.go#L64>)

```go
func SavePendingMFA(userID string, w http.ResponseWriter)
```

SavePendingMFA sets a cookie to remember the pending MFA for 5 minutes

<a name="SetRememberMFA"></a>
## func [SetRememberMFA](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/auth/mfa.go#L77>)

```go
func SetRememberMFA(w http.ResponseWriter, userID string, r *http.Request)
```

SetRememberMFA sets a cookie to remember the MFA for 30 days \- bind it to device

<a name="SetSessionCookie"></a>
## func [SetSessionCookie](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/auth/session.go#L70>)

```go
func SetSessionCookie(w http.ResponseWriter, token string)
```



<a name="ValidateTOTP"></a>
## func [ValidateTOTP](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/auth/mfa.go#L44>)

```go
func ValidateTOTP(secret, code string) bool
```



<a name="AuthProvider"></a>
## type [AuthProvider](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/auth/provider.go#L13-L16>)



```go
type AuthProvider interface {
    StartLogin(w http.ResponseWriter, r *http.Request)
    HandleCallback(w http.ResponseWriter, r *http.Request) (*usermodel.User, error)
}
```

<a name="GoogleAuth"></a>
## type [GoogleAuth](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/auth/google.go#L19-L22>)



```go
type GoogleAuth struct {
    OAuthConfig *oauth2.Config
    Store       userstore.UserStore
}
```

<a name="GoogleAuth.HandleCallback"></a>
### func \(\*GoogleAuth\) [HandleCallback](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/auth/google.go#L35>)

```go
func (g *GoogleAuth) HandleCallback(w http.ResponseWriter, r *http.Request) (*usermodel.User, error)
```



<a name="GoogleAuth.StartLogin"></a>
### func \(\*GoogleAuth\) [StartLogin](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/auth/google.go#L24>)

```go
func (g *GoogleAuth) StartLogin(w http.ResponseWriter, r *http.Request)
```



<a name="LocalAuth"></a>
## type [LocalAuth](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/auth/local.go#L12-L14>)



```go
type LocalAuth struct {
    Store userstore.UserStore
}
```

<a name="LocalAuth.HandleCallback"></a>
### func \(\*LocalAuth\) [HandleCallback](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/auth/local.go#L22>)

```go
func (l *LocalAuth) HandleCallback(w http.ResponseWriter, r *http.Request) (*usermodel.User, error)
```



<a name="LocalAuth.StartLogin"></a>
### func \(\*LocalAuth\) [StartLogin](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/auth/local.go#L16>)

```go
func (l *LocalAuth) StartLogin(w http.ResponseWriter, r *http.Request)
```



<a name="SessionClaims"></a>
## type [SessionClaims](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/auth/session.go#L17-L23>)



```go
type SessionClaims struct {
    UserID           string   `json:"sub"`
    Roles            []string `json:"roles,omitempty"`
    TraceID          string   `json:"trace_id,omitempty"`
    RolesRefreshedAt int64    `json:"roles_refreshed_at"`
    jwt.RegisteredClaims
}
```

<a name="GetSessionClaims"></a>
### func [GetSessionClaims](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/auth/session.go#L99>)

```go
func GetSessionClaims(r *http.Request) (*SessionClaims, error)
```

GetSessionClaims retrieves the session claims from the request

<a name="ValidateToken"></a>
### func [ValidateToken](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/auth/session.go#L51>)

```go
func ValidateToken(tokenStr string) (*SessionClaims, error)
```



# bootstrap

```go
import "github.com/aaronlmathis/gosight-server/internal/bootstrap"
```

server/internal/bootstrap/bufferengine.go

gosight/agent/internal/bootstrap/log\_store.go

## Index

- [func InitAlertStore\(cfg \*config.Config\) \(alertstore.AlertStore, error\)](<#InitAlertStore>)
- [func InitAuth\(cfg \*config.Config, userStore userstore.UserStore\) \(map\[string\]gosightauth.AuthProvider, error\)](<#InitAuth>)
- [func InitBufferEngine\(ctx context.Context, cfg \*config.BufferEngineConfig, stores \*sys.StoreModule\) \*sys.BufferModule](<#InitBufferEngine>)
- [func InitCaches\(ctx context.Context, dataStore datastore.DataStore\) \(\*cache.Cache, error\)](<#InitCaches>)
- [func InitDataStore\(cfg \*config.Config\) \(datastore.DataStore, error\)](<#InitDataStore>)
- [func InitEventStore\(cfg \*config.Config\) \(eventstore.EventStore, error\)](<#InitEventStore>)
- [func InitGoSight\(ctx context.Context\) \(\*sys.SystemContext, error\)](<#InitGoSight>)
- [func InitLogStore\(ctx context.Context, cfg \*config.Config, logCache cache.LogCache\) \(logstore.LogStore, error\)](<#InitLogStore>)
- [func InitMetaStore\(\) \*metastore.MetaTracker](<#InitMetaStore>)
- [func InitMetricIndex\(\) \(\*metricindex.MetricIndex, error\)](<#InitMetricIndex>)
- [func InitMetricStore\(ctx context.Context, cfg \*config.Config, metricCache cache.MetricCache\) \(metricstore.MetricStore, error\)](<#InitMetricStore>)
- [func InitRouteStore\(cfg \*config.Config\) \(\*routestore.RouteStore, error\)](<#InitRouteStore>)
- [func InitRuleStore\(cfg \*config.Config\) \(rulestore.RuleStore, error\)](<#InitRuleStore>)
- [func InitTracker\(ctx context.Context, dataStore datastore.DataStore, emitter \*events.Emitter\) \*tracker.EndpointTracker](<#InitTracker>)
- [func InitUserStore\(cfg \*config.Config\) \(userstore.UserStore, error\)](<#InitUserStore>)
- [func InitWebSocketHub\(ctx context.Context, metaStore \*metastore.MetaTracker\) \*websocket.HubManager](<#InitWebSocketHub>)
- [func LoadServerConfig\(\) \*config.Config](<#LoadServerConfig>)


<a name="InitAlertStore"></a>
## func [InitAlertStore](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/bootstrap/alertStore.go#L41>)

```go
func InitAlertStore(cfg *config.Config) (alertstore.AlertStore, error)
```



<a name="InitAuth"></a>
## func [InitAuth](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/bootstrap/auth.go#L35>)

```go
func InitAuth(cfg *config.Config, userStore userstore.UserStore) (map[string]gosightauth.AuthProvider, error)
```

InitAuth initializes the authentication providers for the GoSight server.

<a name="InitBufferEngine"></a>
## func [InitBufferEngine](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/bootstrap/bufferedEngine.go#L37>)

```go
func InitBufferEngine(ctx context.Context, cfg *config.BufferEngineConfig, stores *sys.StoreModule) *sys.BufferModule
```

InitBufferEngine initializes buffered stores and the central buffer engine. It wraps existing backend stores with buffering and returns the sys.BuffersModule wrapped buffers.

<a name="InitCaches"></a>
## func [InitCaches](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/bootstrap/caches.go#L35>)

```go
func InitCaches(ctx context.Context, dataStore datastore.DataStore) (*cache.Cache, error)
```

InitCaches initializes caches for the system context.

<a name="InitDataStore"></a>
## func [InitDataStore](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/bootstrap/dataStore.go#L40>)

```go
func InitDataStore(cfg *config.Config) (datastore.DataStore, error)
```



<a name="InitEventStore"></a>
## func [InitEventStore](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/bootstrap/eventStore.go#L43>)

```go
func InitEventStore(cfg *config.Config) (eventstore.EventStore, error)
```

InitEventStore initializes the event store for the GoSight server.

<a name="InitGoSight"></a>
## func [InitGoSight](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/bootstrap/init.go#L49>)

```go
func InitGoSight(ctx context.Context) (*sys.SystemContext, error)
```



<a name="InitLogStore"></a>
## func [InitLogStore](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/bootstrap/log_store.go#L37>)

```go
func InitLogStore(ctx context.Context, cfg *config.Config, logCache cache.LogCache) (logstore.LogStore, error)
```

InitLogStore initializes the log store for the GoSight agent. The log store is responsible for storing and retrieving logs.

<a name="InitMetaStore"></a>
## func [InitMetaStore](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/bootstrap/metric_store.go#L64>)

```go
func InitMetaStore() *metastore.MetaTracker
```

InitMetaStore initializes the meta store for the GoSight agent. The meta store is responsible for storing and retrieving metadata.

<a name="InitMetricIndex"></a>
## func [InitMetricIndex](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/bootstrap/metric_store.go#L40>)

```go
func InitMetricIndex() (*metricindex.MetricIndex, error)
```

InitMetricIndex initializes the metric index for the GoSight agent.

<a name="InitMetricStore"></a>
## func [InitMetricStore](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/bootstrap/metric_store.go#L49>)

```go
func InitMetricStore(ctx context.Context, cfg *config.Config, metricCache cache.MetricCache) (metricstore.MetricStore, error)
```

InitMetricStore initializes the metric store for the GoSight agent. The metric store is responsible for storing and retrieving metrics.

<a name="InitRouteStore"></a>
## func [InitRouteStore](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/bootstrap/route_store.go#L33>)

```go
func InitRouteStore(cfg *config.Config) (*routestore.RouteStore, error)
```

InitMetricIndex initializes the metric index for the GoSight agent.

<a name="InitRuleStore"></a>
## func [InitRuleStore](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/bootstrap/rule_store.go#L35>)

```go
func InitRuleStore(cfg *config.Config) (rulestore.RuleStore, error)
```

InitRuleStore initializes the rule store based on the configuration.

<a name="InitTracker"></a>
## func [InitTracker](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/bootstrap/tracker.go#L37>)

```go
func InitTracker(ctx context.Context, dataStore datastore.DataStore, emitter *events.Emitter) *tracker.EndpointTracker
```

InitEndpointTracker initializes the unified endpoint tracker. Tracks both agents and containers, and emits lifecycle events.

<a name="InitUserStore"></a>
## func [InitUserStore](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/bootstrap/user_store.go#L39>)

```go
func InitUserStore(cfg *config.Config) (userstore.UserStore, error)
```



<a name="InitWebSocketHub"></a>
## func [InitWebSocketHub](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/bootstrap/web_socket.go#L37>)

```go
func InitWebSocketHub(ctx context.Context, metaStore *metastore.MetaTracker) *websocket.HubManager
```

InitWebSocketHub initializes the WebSocket hub for the GoSight agent. The WebSocket hub is responsible for managing WebSocket connections and broadcasting messages to connected clients.

<a name="LoadServerConfig"></a>
## func [LoadServerConfig](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/bootstrap/config.go#L37>)

```go
func LoadServerConfig() *config.Config
```

TODO Update environment variables and flags

# bufferengine

```go
import "github.com/aaronlmathis/gosight-server/internal/bufferengine"
```

bufferengine/engine.go

bufferengine/log\_buffer.go

bufferengine/metricbuffer.go

## Index

- [type BufferEngine](<#BufferEngine>)
  - [func NewBufferEngine\(ctx context.Context, flushInterval time.Duration, maxWorkers int\) \*BufferEngine](<#NewBufferEngine>)
  - [func \(e \*BufferEngine\) RegisterStore\(store BufferedStore\)](<#BufferEngine.RegisterStore>)
  - [func \(e \*BufferEngine\) Start\(\)](<#BufferEngine.Start>)
  - [func \(e \*BufferEngine\) Stop\(\)](<#BufferEngine.Stop>)
- [type BufferedDataStore](<#BufferedDataStore>)
  - [func NewBufferedDataStore\(ctx context.Context, name string, store datastore.DataStore, maxSize int, flushInterval time.Duration\) \*BufferedDataStore](<#NewBufferedDataStore>)
  - [func \(b \*BufferedDataStore\) Close\(\) error](<#BufferedDataStore.Close>)
  - [func \(b \*BufferedDataStore\) Flush\(\) error](<#BufferedDataStore.Flush>)
  - [func \(b \*BufferedDataStore\) Interval\(\) time.Duration](<#BufferedDataStore.Interval>)
  - [func \(b \*BufferedDataStore\) Name\(\) string](<#BufferedDataStore.Name>)
  - [func \(b \*BufferedDataStore\) Write\(payload \*model.ProcessPayload\) error](<#BufferedDataStore.Write>)
  - [func \(b \*BufferedDataStore\) WriteAny\(payload interface\{\}\) error](<#BufferedDataStore.WriteAny>)
- [type BufferedLogStore](<#BufferedLogStore>)
  - [func NewBufferedLogStore\(name string, store LogStore, maxSize int, flushInterval time.Duration\) \*BufferedLogStore](<#NewBufferedLogStore>)
  - [func \(b \*BufferedLogStore\) Close\(\) error](<#BufferedLogStore.Close>)
  - [func \(b \*BufferedLogStore\) Flush\(\) error](<#BufferedLogStore.Flush>)
  - [func \(b \*BufferedLogStore\) Interval\(\) time.Duration](<#BufferedLogStore.Interval>)
  - [func \(b \*BufferedLogStore\) Name\(\) string](<#BufferedLogStore.Name>)
  - [func \(b \*BufferedLogStore\) Write\(payload model.LogPayload\) error](<#BufferedLogStore.Write>)
  - [func \(b \*BufferedLogStore\) WriteAny\(payload interface\{\}\) error](<#BufferedLogStore.WriteAny>)
- [type BufferedMetricStore](<#BufferedMetricStore>)
  - [func NewBufferedMetricStore\(name string, store MetricStore, maxSize int, flushInterval time.Duration\) \*BufferedMetricStore](<#NewBufferedMetricStore>)
  - [func \(b \*BufferedMetricStore\) Close\(\) error](<#BufferedMetricStore.Close>)
  - [func \(b \*BufferedMetricStore\) Flush\(\) error](<#BufferedMetricStore.Flush>)
  - [func \(b \*BufferedMetricStore\) Interval\(\) time.Duration](<#BufferedMetricStore.Interval>)
  - [func \(b \*BufferedMetricStore\) Name\(\) string](<#BufferedMetricStore.Name>)
  - [func \(b \*BufferedMetricStore\) Write\(payload model.MetricPayload\) error](<#BufferedMetricStore.Write>)
  - [func \(b \*BufferedMetricStore\) WriteAny\(payload interface\{\}\) error](<#BufferedMetricStore.WriteAny>)
- [type BufferedStore](<#BufferedStore>)
- [type DataStore](<#DataStore>)
- [type LogStore](<#LogStore>)
- [type MetricStore](<#MetricStore>)


<a name="BufferEngine"></a>
## type [BufferEngine](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/bufferengine/engine.go#L20-L26>)



```go
type BufferEngine struct {
    // contains filtered or unexported fields
}
```

<a name="NewBufferEngine"></a>
### func [NewBufferEngine](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/bufferengine/engine.go#L28>)

```go
func NewBufferEngine(ctx context.Context, flushInterval time.Duration, maxWorkers int) *BufferEngine
```



<a name="BufferEngine.RegisterStore"></a>
### func \(\*BufferEngine\) [RegisterStore](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/bufferengine/engine.go#L36>)

```go
func (e *BufferEngine) RegisterStore(store BufferedStore)
```



<a name="BufferEngine.Start"></a>
### func \(\*BufferEngine\) [Start](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/bufferengine/engine.go#L41>)

```go
func (e *BufferEngine) Start()
```



<a name="BufferEngine.Stop"></a>
### func \(\*BufferEngine\) [Stop](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/bufferengine/engine.go#L70>)

```go
func (e *BufferEngine) Stop()
```



<a name="BufferedDataStore"></a>
## type [BufferedDataStore](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/bufferengine/databuffer.go#L18-L26>)



```go
type BufferedDataStore struct {
    // contains filtered or unexported fields
}
```

<a name="NewBufferedDataStore"></a>
### func [NewBufferedDataStore](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/bufferengine/databuffer.go#L28>)

```go
func NewBufferedDataStore(ctx context.Context, name string, store datastore.DataStore, maxSize int, flushInterval time.Duration) *BufferedDataStore
```



<a name="BufferedDataStore.Close"></a>
### func \(\*BufferedDataStore\) [Close](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/bufferengine/databuffer.go#L82>)

```go
func (b *BufferedDataStore) Close() error
```



<a name="BufferedDataStore.Flush"></a>
### func \(\*BufferedDataStore\) [Flush](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/bufferengine/databuffer.go#L66>)

```go
func (b *BufferedDataStore) Flush() error
```



<a name="BufferedDataStore.Interval"></a>
### func \(\*BufferedDataStore\) [Interval](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/bufferengine/databuffer.go#L43>)

```go
func (b *BufferedDataStore) Interval() time.Duration
```



<a name="BufferedDataStore.Name"></a>
### func \(\*BufferedDataStore\) [Name](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/bufferengine/databuffer.go#L39>)

```go
func (b *BufferedDataStore) Name() string
```



<a name="BufferedDataStore.Write"></a>
### func \(\*BufferedDataStore\) [Write](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/bufferengine/databuffer.go#L55>)

```go
func (b *BufferedDataStore) Write(payload *model.ProcessPayload) error
```



<a name="BufferedDataStore.WriteAny"></a>
### func \(\*BufferedDataStore\) [WriteAny](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/bufferengine/databuffer.go#L47>)

```go
func (b *BufferedDataStore) WriteAny(payload interface{}) error
```



<a name="BufferedLogStore"></a>
## type [BufferedLogStore](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/bufferengine/logbuffer.go#L17-L24>)



```go
type BufferedLogStore struct {
    // contains filtered or unexported fields
}
```

<a name="NewBufferedLogStore"></a>
### func [NewBufferedLogStore](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/bufferengine/logbuffer.go#L26>)

```go
func NewBufferedLogStore(name string, store LogStore, maxSize int, flushInterval time.Duration) *BufferedLogStore
```



<a name="BufferedLogStore.Close"></a>
### func \(\*BufferedLogStore\) [Close](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/bufferengine/logbuffer.go#L79>)

```go
func (b *BufferedLogStore) Close() error
```



<a name="BufferedLogStore.Flush"></a>
### func \(\*BufferedLogStore\) [Flush](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/bufferengine/logbuffer.go#L63>)

```go
func (b *BufferedLogStore) Flush() error
```



<a name="BufferedLogStore.Interval"></a>
### func \(\*BufferedLogStore\) [Interval](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/bufferengine/logbuffer.go#L40>)

```go
func (b *BufferedLogStore) Interval() time.Duration
```



<a name="BufferedLogStore.Name"></a>
### func \(\*BufferedLogStore\) [Name](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/bufferengine/logbuffer.go#L36>)

```go
func (b *BufferedLogStore) Name() string
```



<a name="BufferedLogStore.Write"></a>
### func \(\*BufferedLogStore\) [Write](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/bufferengine/logbuffer.go#L52>)

```go
func (b *BufferedLogStore) Write(payload model.LogPayload) error
```



<a name="BufferedLogStore.WriteAny"></a>
### func \(\*BufferedLogStore\) [WriteAny](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/bufferengine/logbuffer.go#L44>)

```go
func (b *BufferedLogStore) WriteAny(payload interface{}) error
```



<a name="BufferedMetricStore"></a>
## type [BufferedMetricStore](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/bufferengine/metricbuffer.go#L12-L19>)



```go
type BufferedMetricStore struct {
    // contains filtered or unexported fields
}
```

<a name="NewBufferedMetricStore"></a>
### func [NewBufferedMetricStore](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/bufferengine/metricbuffer.go#L25>)

```go
func NewBufferedMetricStore(name string, store MetricStore, maxSize int, flushInterval time.Duration) *BufferedMetricStore
```



<a name="BufferedMetricStore.Close"></a>
### func \(\*BufferedMetricStore\) [Close](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/bufferengine/metricbuffer.go#L78>)

```go
func (b *BufferedMetricStore) Close() error
```



<a name="BufferedMetricStore.Flush"></a>
### func \(\*BufferedMetricStore\) [Flush](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/bufferengine/metricbuffer.go#L62>)

```go
func (b *BufferedMetricStore) Flush() error
```



<a name="BufferedMetricStore.Interval"></a>
### func \(\*BufferedMetricStore\) [Interval](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/bufferengine/metricbuffer.go#L39>)

```go
func (b *BufferedMetricStore) Interval() time.Duration
```



<a name="BufferedMetricStore.Name"></a>
### func \(\*BufferedMetricStore\) [Name](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/bufferengine/metricbuffer.go#L35>)

```go
func (b *BufferedMetricStore) Name() string
```



<a name="BufferedMetricStore.Write"></a>
### func \(\*BufferedMetricStore\) [Write](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/bufferengine/metricbuffer.go#L51>)

```go
func (b *BufferedMetricStore) Write(payload model.MetricPayload) error
```



<a name="BufferedMetricStore.WriteAny"></a>
### func \(\*BufferedMetricStore\) [WriteAny](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/bufferengine/metricbuffer.go#L43>)

```go
func (b *BufferedMetricStore) WriteAny(payload interface{}) error
```



<a name="BufferedStore"></a>
## type [BufferedStore](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/bufferengine/engine.go#L12-L18>)



```go
type BufferedStore interface {
    WriteAny(payload interface{}) error
    Flush() error
    Close() error
    Name() string
    Interval() time.Duration
}
```

<a name="DataStore"></a>
## type [DataStore](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/bufferengine/databuffer.go#L14-L16>)



```go
type DataStore interface {
    Write(ctx context.Context, batches []*model.ProcessPayload) error
}
```

<a name="LogStore"></a>
## type [LogStore](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/bufferengine/logbuffer.go#L13-L15>)



```go
type LogStore interface {
    Write(entries []model.LogPayload) error
}
```

<a name="MetricStore"></a>
## type [MetricStore](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/bufferengine/metricbuffer.go#L21-L23>)



```go
type MetricStore interface {
    Write(payloads []model.MetricPayload) error
}
```

# cache

```go
import "github.com/aaronlmathis/gosight-server/internal/cache"
```

## Index

- [func AddMetaFieldsToLabels\(meta \*model.Meta, labels map\[string\]StringSet\)](<#AddMetaFieldsToLabels>)
- [type Cache](<#Cache>)
- [type LogCache](<#LogCache>)
  - [func NewLogCache\(\) LogCache](<#NewLogCache>)
- [type MetricCache](<#MetricCache>)
  - [func NewMetricCache\(\) MetricCache](<#NewMetricCache>)
- [type MetricEntry](<#MetricEntry>)
- [type ProcessCache](<#ProcessCache>)
  - [func NewProcessCache\(\) ProcessCache](<#NewProcessCache>)
- [type StringSet](<#StringSet>)
  - [func \(s StringSet\) Add\(val string\)](<#StringSet.Add>)
- [type TagCache](<#TagCache>)
  - [func NewTagCache\(\) TagCache](<#NewTagCache>)


<a name="AddMetaFieldsToLabels"></a>
## func [AddMetaFieldsToLabels](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/cache/metrics.go#L374>)

```go
func AddMetaFieldsToLabels(meta *model.Meta, labels map[string]StringSet)
```



<a name="Cache"></a>
## type [Cache](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/cache/cache.go#L24-L39>)



```go
type Cache struct {
    Processes ProcessCache
    Metrics   MetricCache
    Tags      TagCache
    Logs      LogCache
}
```

<a name="LogCache"></a>
## type [LogCache](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/cache/logcache.go#L31-L34>)



```go
type LogCache interface {
    Add(batch []*model.StoredLog)
    Get(logID string) (*model.LogEntry, bool)
}
```

<a name="NewLogCache"></a>
### func [NewLogCache](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/cache/logcache.go#L42>)

```go
func NewLogCache() LogCache
```



<a name="MetricCache"></a>
## type [MetricCache](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/cache/metrics.go#L36-L58>)

MetricCache is an in\-memory cache for metrics as well as their meta data

```go
type MetricCache interface {
    Add(payload *model.MetricPayload)
    GetNamespaces() []string                                // Get all known namespaces
    GetSubNamespaces(nameSpace string) []string             // Get all subnamespaces for a namespace
    GetMetricNames(nameSpace, subNamespace string) []string // Get all metric names for Namespace+Subnamespace

    GetAllMetricNames() []string                    // Get all known metric names
    GetAvailableDimensions() map[string][]string    // Get all available dimensions (known)
    GetMetricDimensions(metricName string) []string // Get all dimension keys known for a metric

    GetAllTagKeys() []string                   // Get all known tag keys
    GetAllTagValuesForKey(key string) []string // Get all known values for tag key

    // Label = Metric dimension + Tags (prometheus labels)
    GetAllKnownLabelValues(label, contains string) []string  // Get all known values for a given label key (dimensions + tags) (optionally filtered)
    GetLabelValues(label, contains string) []string          // Get all label values for a known label (optionally filtered)
    GetMetricsWithLabels(filters map[string]string) []string // Get all metric names that match a given label filter

    Prune()

    // For debugtools
    GetAllEntries() []*MetricEntry
}
```

<a name="NewMetricCache"></a>
### func [NewMetricCache](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/cache/metrics.go#L83>)

```go
func NewMetricCache() MetricCache
```



<a name="MetricEntry"></a>
## type [MetricEntry](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/cache/metrics.go#L60-L71>)



```go
type MetricEntry struct {
    Namespace string
    SubNS     string
    Name      string
    Unit      string
    Type      string

    Dimensions map[string]StringSet // Dimensions are metric specific key value pairs, added by collectors
    Labels     map[string]StringSet // Labels are a superset of dimensions, including custom user-defined tags and meta fields
    Tags       map[string]StringSet // Tags are user-defined key value pairs, added by the user in the Meta
    Emitters   map[string]struct{}  // endpoint IDs
}
```

<a name="ProcessCache"></a>
## type [ProcessCache](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/cache/processes.go#L13-L17>)

ProcessCache stores recent process snapshots per endpoint.

```go
type ProcessCache interface {
    Add(snapshot model.ProcessSnapshot)
    Get(endpointID string) []model.ProcessSnapshot
    Prune()
}
```

<a name="NewProcessCache"></a>
### func [NewProcessCache](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/cache/processes.go#L24>)

```go
func NewProcessCache() ProcessCache
```



<a name="StringSet"></a>
## type [StringSet](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/cache/helpers.go#L5>)



```go
type StringSet map[string]struct{}
```

<a name="StringSet.Add"></a>
### func \(StringSet\) [Add](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/cache/tags.go#L11>)

```go
func (s StringSet) Add(val string)
```



<a name="TagCache"></a>
## type [TagCache](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/cache/tags.go#L20-L32>)



```go
type TagCache interface {
    Add(payload *model.MetricPayload)
    GetTagsForEndpoint(endpointID string) map[string]StringSet
    GetFlattenedTagsForEndpoint(endpointID string) map[string]string
    GetTagKeys() []string
    GetTagValues(key string) StringSet
    Flush(dataStore datastore.DataStore)
    LoadFromStore(tags []model.Tag)
    Prune()

    // For debugtools
    GetAllEndpoints() map[string]map[string]StringSet
}
```

<a name="NewTagCache"></a>
### func [NewTagCache](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/cache/tags.go#L45>)

```go
func NewTagCache() TagCache
```



# config

```go
import "github.com/aaronlmathis/gosight-server/internal/config"
```

Package config provides configuration loading and management for the GoSight server. It supports loading configuration from a YAML file and allows for environment variable overrides. The configuration includes settings for server address, storage engine, database path, logging, TLS settings, and debug options.

## Index

- [func ApplyEnvOverrides\(cfg \*Config\)](<#ApplyEnvOverrides>)
- [func EnsureDefaultConfig\(path string\) error](<#EnsureDefaultConfig>)
- [type AlertBufferConfig](<#AlertBufferConfig>)
- [type BufferEngineConfig](<#BufferEngineConfig>)
- [type Config](<#Config>)
  - [func LoadConfig\(path string\) \(\*Config, error\)](<#LoadConfig>)
- [type DataBufferConfig](<#DataBufferConfig>)
- [type DiskBufferConfig](<#DiskBufferConfig>)
- [type EventBufferConfig](<#EventBufferConfig>)
- [type GoogleConfig](<#GoogleConfig>)
  - [func \(g \*GoogleConfig\) ToOAuthConfig\(\) \*oauth2.Config](<#GoogleConfig.ToOAuthConfig>)
- [type LogBufferConfig](<#LogBufferConfig>)
- [type MetricBufferConfig](<#MetricBufferConfig>)


<a name="ApplyEnvOverrides"></a>
## func [ApplyEnvOverrides](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/config/config.go#L158>)

```go
func ApplyEnvOverrides(cfg *Config)
```



<a name="EnsureDefaultConfig"></a>
## func [EnsureDefaultConfig](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/config/default.go#L34>)

```go
func EnsureDefaultConfig(path string) error
```



<a name="AlertBufferConfig"></a>
## type [AlertBufferConfig](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/config/bufferConfig.go#L75-L81>)



```go
type AlertBufferConfig struct {
    Enabled          bool          `yaml:"enabled"`
    BufferSize       int           `yaml:"buffer_size"`
    FlushInterval    time.Duration `yaml:"flush_interval"`
    DropOnOverflow   bool          `yaml:"drop_on_overflow"`
    RetryFailedFlush bool          `yaml:"retry_failed_flush"`
}
```

<a name="BufferEngineConfig"></a>
## type [BufferEngineConfig](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/config/bufferConfig.go#L29-L39>)

Buff

```go
type BufferEngineConfig struct {
    Enabled              bool               `yaml:"enabled"`
    FlushInterval        time.Duration      `yaml:"flush_interval"`
    ShutdownFlushTimeout time.Duration      `yaml:"shutdown_flush_timeout"`
    MaxWorkers           int                `yaml:"max_workers"`
    Metrics              MetricBufferConfig `yaml:"metrics"`
    Logs                 LogBufferConfig    `yaml:"logs"`
    Data                 DataBufferConfig   `yaml:"data"`
    Events               EventBufferConfig  `yaml:"events"`
    Alerts               AlertBufferConfig  `yaml:"alerts"`
}
```

<a name="Config"></a>
## type [Config](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/config/config.go#L39-L138>)



```go
type Config struct {
    Server struct {
        GRPCAddr     string        `yaml:"grpc_addr"`
        HTTPAddr     string        `yaml:"http_addr"`
        Environment  string        `yaml:"environment"`
        SyncInterval time.Duration `yaml:"sync_interval" default:"5m"`
    }   `yaml:"server"`

    Logs struct {
        ErrorLogFile  string `yaml:"error_log_file"`
        AppLogFile    string `yaml:"app_log_file"`
        AccessLogFile string `yaml:"access_log_file"`
        DebugLogFile  string `yaml:"debug_log_file"`
        LogLevel      string `yaml:"log_level"`
    }
    Web struct {
        StaticDir     string   `yaml:"static_dir"`
        TemplateDir   string   `yaml:"template_dir"`
        DefaultTitle  string   `yaml:"default_title"`
        AuthProviders []string `yaml:"auth_providers"`
    }   `yaml:"web"`

    TLS struct {
        HttpsCertFile string `yaml:"https_cert_file"`
        HttpsKeyFile  string `yaml:"https_key_file"`
        CertFile      string `yaml:"cert_file"`
        KeyFile       string `yaml:"key_file"`
        ClientCAFile  string `yaml:"client_ca_file"`
    }   `yaml:"tls"`

    Debug struct {
        EnableReflection bool `yaml:"enable_reflection"`
    }   `yaml:"debug"`

    // TODO - split up storage engine configs.
    MetricStore struct {
        Engine        string `yaml:"engine"`
        URL           string `yaml:"url"`
        Workers       int    `yaml:"workers"`
        QueueSize     int    `yaml:"queue_size"`
        BatchSize     int    `yaml:"batch_size"`
        BatchTimeout  int    `yaml:"batch_timeout"`
        BatchRetry    int    `yaml:"batch_retry"`
        BatchInterval int    `yaml:"batch_interval"`
    }   `yaml:"metricstore"`

    LogStore struct {
        Engine        string `yaml:"engine"` // file, victoriametric etc
        Dir           string `yaml:"dir"`
        Url           string `yaml:"url,omitempty"` // optional URL for remote storage
        Workers       int    `yaml:"workers"`
        QueueSize     int    `yaml:"queue_size"`
        BatchSize     int    `yaml:"batch_size"`
        BatchTimeout  int    `yaml:"batch_timeout"`
        BatchRetry    int    `yaml:"batch_retry"`
        BatchInterval int    `yaml:"batch_interval"`
    }

    UserStore struct {
        Engine   string `yaml:"engine"`    // e.g. "postgres", "memory", "ldap"
        DSN      string `yaml:"dsn"`       // e.g. PostgreSQL connection string
        LDAPBase string `yaml:"ldap_base"` // optional: LDAP-specific config
    }   `yaml:"userstore"`

    DataStore struct {
        Engine string `yaml:"engine"`         // "memory", "json", or "postgres"
        Path   string `yaml:"path,omitempty"` // optional path for JSON file
        DSN    string `yaml:"dsn,omitempty"`  // optional DSN for PostgreSQL
    }   `yaml:"datastore"`

    AlertStore struct {
        Engine string `yaml:"engine"`         // "memory", "json", or "postgres"
        Path   string `yaml:"path,omitempty"` // optional path for JSON file
        DSN    string `yaml:"dsn,omitempty"`  // optional DSN for PostgreSQL
    }   `yaml:"alertstore"`

    EventStore struct {
        Engine string `yaml:"engine"`        // "memory", "json", or "postgres"
        Path   string `yaml:"path"`          // optional path for JSON file
        DSN    string `yaml:"dsn,omitempty"` // optional DSN for PostgreSQL
    }   `yaml:"eventstore"`

    RuleStore struct {
        Engine string `yaml:"engine"` // "memory", "json", or "postgres"
        Path   string `yaml:"path"`   // optional path for JSON file
    }   `yaml:"rulestore"`

    RouteStore struct {
        Path string `yaml:"path"` // path for YAML file
    }   `yaml:"routestore"`

    BufferEngine BufferEngineConfig `yaml:"buffer_engine"`

    Auth struct {
        SSOEnabled bool         `yaml:"sso_enabled"`
        MFASecret  string       `yaml:"mfa_secret_key"`
        JWTSecret  string       `yaml:"jwt_secret"`
        Google     GoogleConfig `yaml:"google"`
    }   `yaml:"auth"`
}
```

<a name="LoadConfig"></a>
### func [LoadConfig](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/config/config.go#L146>)

```go
func LoadConfig(path string) (*Config, error)
```



<a name="DataBufferConfig"></a>
## type [DataBufferConfig](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/config/bufferConfig.go#L59-L67>)



```go
type DataBufferConfig struct {
    Enabled           bool             `yaml:"enabled"`
    BufferSize        int              `yaml:"buffer_size"`
    FlushInterval     time.Duration    `yaml:"flush_interval"`
    DropOnOverflow    bool             `yaml:"drop_on_overflow"`
    RetryFailedFlush  bool             `yaml:"retry_failed_flush"`
    FlushOnDisconnect bool             `yaml:"flush_on_disconnect"`
    FallbackDisk      DiskBufferConfig `yaml:"fallback_disk"`
}
```

<a name="DiskBufferConfig"></a>
## type [DiskBufferConfig](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/config/bufferConfig.go#L83-L87>)



```go
type DiskBufferConfig struct {
    Enabled       bool   `yaml:"enabled"`
    Path          string `yaml:"path"`
    MaxDiskSizeMB int    `yaml:"max_disk_size_mb"`
}
```

<a name="EventBufferConfig"></a>
## type [EventBufferConfig](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/config/bufferConfig.go#L68-L73>)



```go
type EventBufferConfig struct {
    Enabled          bool          `yaml:"enabled"`
    BufferSize       int           `yaml:"buffer_size"`
    FlushInterval    time.Duration `yaml:"flush_interval"`
    RetryFailedFlush bool          `yaml:"retry_failed_flush"`
}
```

<a name="GoogleConfig"></a>
## type [GoogleConfig](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/config/config.go#L140-L144>)



```go
type GoogleConfig struct {
    ClientID     string `yaml:"client_id"`
    ClientSecret string `yaml:"client_secret"`
    RedirectURI  string `yaml:"redirect_uri"`
}
```

<a name="GoogleConfig.ToOAuthConfig"></a>
### func \(\*GoogleConfig\) [ToOAuthConfig](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/config/config.go#L200>)

```go
func (g *GoogleConfig) ToOAuthConfig() *oauth2.Config
```



<a name="LogBufferConfig"></a>
## type [LogBufferConfig](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/config/bufferConfig.go#L51-L58>)



```go
type LogBufferConfig struct {
    Enabled          bool             `yaml:"enabled"`
    BufferSize       int              `yaml:"buffer_size"`
    FlushInterval    time.Duration    `yaml:"flush_interval"`
    DropOnOverflow   bool             `yaml:"drop_on_overflow"`
    RetryFailedFlush bool             `yaml:"retry_failed_flush"`
    FallbackDisk     DiskBufferConfig `yaml:"fallback_disk"`
}
```

<a name="MetricBufferConfig"></a>
## type [MetricBufferConfig](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/config/bufferConfig.go#L41-L49>)



```go
type MetricBufferConfig struct {
    Enabled           bool             `yaml:"enabled"`
    BufferSize        int              `yaml:"buffer_size"`
    FlushInterval     time.Duration    `yaml:"flush_interval"`
    DropOnOverflow    bool             `yaml:"drop_on_overflow"`
    RetryFailedFlush  bool             `yaml:"retry_failed_flush"`
    FlushOnDisconnect bool             `yaml:"flush_on_disconnect"`
    FallbackDisk      DiskBufferConfig `yaml:"fallback_disk"`
}
```

# contextutil

```go
import "github.com/aaronlmathis/gosight-server/internal/contextutil"
```

Package contextutil provides safe helpers for working with context values

## Index

- [func GetTraceID\(ctx context.Context\) \(string, bool\)](<#GetTraceID>)
- [func GetUserID\(ctx context.Context\) \(string, bool\)](<#GetUserID>)
- [func GetUserPermissions\(ctx context.Context\) \(\[\]string, bool\)](<#GetUserPermissions>)
- [func GetUserRoles\(ctx context.Context\) \(\[\]string, bool\)](<#GetUserRoles>)
- [func GetUserScopes\(ctx context.Context\) \(map\[string\]\[\]string, bool\)](<#GetUserScopes>)
- [func IsForbidden\(ctx context.Context\) bool](<#IsForbidden>)
- [func SetForbidden\(ctx context.Context\) context.Context](<#SetForbidden>)
- [func SetTraceID\(ctx context.Context, traceID string\) context.Context](<#SetTraceID>)
- [func SetUserID\(ctx context.Context, userID string\) context.Context](<#SetUserID>)
- [func SetUserPermissions\(ctx context.Context, perms \[\]string\) context.Context](<#SetUserPermissions>)
- [func SetUserRoles\(ctx context.Context, roles \[\]string\) context.Context](<#SetUserRoles>)
- [func SetUserScopes\(ctx context.Context, scopes map\[string\]\[\]string\) context.Context](<#SetUserScopes>)


<a name="GetTraceID"></a>
## func [GetTraceID](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/contextutil/contextutil.go#L67>)

```go
func GetTraceID(ctx context.Context) (string, bool)
```

GetTraceID retrieves the trace ID if set

<a name="GetUserID"></a>
## func [GetUserID](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/contextutil/contextutil.go#L25>)

```go
func GetUserID(ctx context.Context) (string, bool)
```

GetUserID retrieves the user ID from the context

<a name="GetUserPermissions"></a>
## func [GetUserPermissions](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/contextutil/contextutil.go#L53>)

```go
func GetUserPermissions(ctx context.Context) ([]string, bool)
```

GetUserPermissions retrieves the permissions slice from context

<a name="GetUserRoles"></a>
## func [GetUserRoles](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/contextutil/contextutil.go#L39>)

```go
func GetUserRoles(ctx context.Context) ([]string, bool)
```

GetUserRoles retrieves the roles slice from context

<a name="GetUserScopes"></a>
## func [GetUserScopes](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/contextutil/contextutil.go#L81>)

```go
func GetUserScopes(ctx context.Context) (map[string][]string, bool)
```

GetUserScopes retrieves the user scopes from the context

<a name="IsForbidden"></a>
## func [IsForbidden](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/contextutil/contextutil.go#L96>)

```go
func IsForbidden(ctx context.Context) bool
```



<a name="SetForbidden"></a>
## func [SetForbidden](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/contextutil/contextutil.go#L90>)

```go
func SetForbidden(ctx context.Context) context.Context
```

SetForbidden sets a flag in the context to indicate forbidden access

<a name="SetTraceID"></a>
## func [SetTraceID](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/contextutil/contextutil.go#L62>)

```go
func SetTraceID(ctx context.Context, traceID string) context.Context
```

SetTraceID stores a trace ID for request correlation

<a name="SetUserID"></a>
## func [SetUserID](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/contextutil/contextutil.go#L20>)

```go
func SetUserID(ctx context.Context, userID string) context.Context
```

SetUserID returns a new context with the user ID stored

<a name="SetUserPermissions"></a>
## func [SetUserPermissions](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/contextutil/contextutil.go#L48>)

```go
func SetUserPermissions(ctx context.Context, perms []string) context.Context
```

SetUserPermissions stores a slice of permission strings in the context

<a name="SetUserRoles"></a>
## func [SetUserRoles](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/contextutil/contextutil.go#L34>)

```go
func SetUserRoles(ctx context.Context, roles []string) context.Context
```

SetUserRoles stores a slice of role names in the context

<a name="SetUserScopes"></a>
## func [SetUserScopes](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/contextutil/contextutil.go#L76>)

```go
func SetUserScopes(ctx context.Context, scopes map[string][]string) context.Context
```

SetUserScopes stores a map of user scopes in the context for the user

# dispatcher

```go
import "github.com/aaronlmathis/gosight-server/internal/dispatcher"
```

Package dispatcher provides functionality to manage and dispatch

## Index

- [type Dispatcher](<#Dispatcher>)
  - [func NewDispatcher\(routeMap map\[string\]model.ActionRoute\) \*Dispatcher](<#NewDispatcher>)
  - [func \(d \*Dispatcher\) Dispatch\(ctx context.Context, event model.EventEntry\)](<#Dispatcher.Dispatch>)
  - [func \(d \*Dispatcher\) ExecuteAction\(ctx context.Context, a model.ActionSpec, e model.EventEntry\)](<#Dispatcher.ExecuteAction>)
  - [func \(d \*Dispatcher\) TriggerActionByID\(ctx context.Context, actionID string, event model.EventEntry\)](<#Dispatcher.TriggerActionByID>)


<a name="Dispatcher"></a>
## type [Dispatcher](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/dispatcher/dispatcher.go#L39-L41>)



```go
type Dispatcher struct {
    Routes map[string]model.ActionRoute
}
```

<a name="NewDispatcher"></a>
### func [NewDispatcher](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/dispatcher/dispatcher.go#L43>)

```go
func NewDispatcher(routeMap map[string]model.ActionRoute) *Dispatcher
```



<a name="Dispatcher.Dispatch"></a>
### func \(\*Dispatcher\) [Dispatch](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/dispatcher/dispatcher.go#L48>)

```go
func (d *Dispatcher) Dispatch(ctx context.Context, event model.EventEntry)
```

Dispatch processes an event against all routes and triggers matching actions.

<a name="Dispatcher.ExecuteAction"></a>
### func \(\*Dispatcher\) [ExecuteAction](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/dispatcher/dispatcher.go#L93>)

```go
func (d *Dispatcher) ExecuteAction(ctx context.Context, a model.ActionSpec, e model.EventEntry)
```

executeAction executes the action specified in the route. It determines the action type \(webhook or script\) and calls the appropriate function.

<a name="Dispatcher.TriggerActionByID"></a>
### func \(\*Dispatcher\) [TriggerActionByID](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/dispatcher/dispatcher.go#L61>)

```go
func (d *Dispatcher) TriggerActionByID(ctx context.Context, actionID string, event model.EventEntry)
```

TriggerActionByID looks up a route by ID and executes its actions.

# events

```go
import "github.com/aaronlmathis/gosight-server/internal/events"
```

gosight/agent/shared/model/event.go Package events provides an event emitter for the GoSight application.

## Index

- [func BuildLogEventMeta\(log \*model.LogEntry, payload \*model.LogPayload\) map\[string\]string](<#BuildLogEventMeta>)
- [type Emitter](<#Emitter>)
  - [func NewEmitter\(store eventstore.EventStore, hub \*websocket.EventsHub\) \*Emitter](<#NewEmitter>)
  - [func \(e \*Emitter\) Emit\(ctx context.Context, event model.EventEntry\)](<#Emitter.Emit>)


<a name="BuildLogEventMeta"></a>
## func [BuildLogEventMeta](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/events/helpers.go#L28>)

```go
func BuildLogEventMeta(log *model.LogEntry, payload *model.LogPayload) map[string]string
```



<a name="Emitter"></a>
## type [Emitter](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/events/emitter.go#L38-L41>)

Emitter is an event emitter that stores events in an event store. It provides a method to emit events with various attributes such as level, category, message, source, and metadata.

```go
type Emitter struct {
    Store eventstore.EventStore
    // contains filtered or unexported fields
}
```

<a name="NewEmitter"></a>
### func [NewEmitter](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/events/emitter.go#L44>)

```go
func NewEmitter(store eventstore.EventStore, hub *websocket.EventsHub) *Emitter
```

NewEmitter creates a new Emitter instance with the provided event store.

<a name="Emitter.Emit"></a>
### func \(\*Emitter\) [Emit](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/events/emitter.go#L52>)

```go
func (e *Emitter) Emit(ctx context.Context, event model.EventEntry)
```

Emit emits an event with the specified attributes.

# grpcserver

```go
import "github.com/aaronlmathis/gosight-server/internal/grpc"
```

## Index

- [type GrpcServer](<#GrpcServer>)
  - [func NewGRPCServer\(sys \*sys.SystemContext\) \(\*GrpcServer, error\)](<#NewGRPCServer>)
  - [func \(g \*GrpcServer\) GracefulDisconnectAllAgents\(\)](<#GrpcServer.GracefulDisconnectAllAgents>)


<a name="GrpcServer"></a>
## type [GrpcServer](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/grpc/grpc.go#L46-L52>)



```go
type GrpcServer struct {
    Sys           *sys.SystemContext
    LogHandler    *telemetry.LogsHandler
    StreamHandler *telemetry.StreamHandler
    Listener      net.Listener
    Server        *grpc.Server
}
```

<a name="NewGRPCServer"></a>
### func [NewGRPCServer](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/grpc/grpc.go#L58>)

```go
func NewGRPCServer(sys *sys.SystemContext) (*GrpcServer, error)
```



<a name="GrpcServer.GracefulDisconnectAllAgents"></a>
### func \(\*GrpcServer\) [GracefulDisconnectAllAgents](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/grpc/grpc.go#L178>)

```go
func (g *GrpcServer) GracefulDisconnectAllAgents()
```



# httpserver

```go
import "github.com/aaronlmathis/gosight-server/internal/http"
```

File: server/internal/http/handleAlertContextAPI.go

Basic Handler for http server server/internal/http/handler.go

server/internal/http/router.go Router for HTTPServer

## Index

- [func FilterAgents\(list \[\]\*model.Agent, filter EndpointFilter\) \[\]\*model.Agent](<#FilterAgents>)
- [func FilterContainers\(list \[\]\*model.Container, filter EndpointFilter\) \[\]\*model.Container](<#FilterContainers>)
- [func GetFlash\(w http.ResponseWriter, r \*http.Request\) string](<#GetFlash>)
- [func InjectUserContext\(ctx context.Context, user \*usermodel.User\) context.Context](<#InjectUserContext>)
- [func SetFlash\(w http.ResponseWriter, message string\)](<#SetFlash>)
- [func SortAndLimitAgents\(list \[\]\*model.Agent, sortBy, order string, limit int\) \[\]\*model.Agent](<#SortAndLimitAgents>)
- [func SortAndLimitContainers\(list \[\]\*model.Container, sortBy, order string, limit int\) \[\]\*model.Container](<#SortAndLimitContainers>)
- [func SortBy\(alerts \*\[\]model.AlertInstance, field, order string\)](<#SortBy>)
- [type APIMetricStore](<#APIMetricStore>)
  - [func \(a \*APIMetricStore\) Close\(\) error](<#APIMetricStore.Close>)
  - [func \(a \*APIMetricStore\) FetchDimensionsForMetric\(metric string\) \(\[\]string, error\)](<#APIMetricStore.FetchDimensionsForMetric>)
  - [func \(a \*APIMetricStore\) QueryInstant\(metric string, filters map\[string\]string\) \(\[\]model.MetricRow, error\)](<#APIMetricStore.QueryInstant>)
  - [func \(a \*APIMetricStore\) QueryMultiInstant\(metricNames \[\]string, filters map\[string\]string\) \(\[\]model.MetricRow, error\)](<#APIMetricStore.QueryMultiInstant>)
  - [func \(a \*APIMetricStore\) QueryMultiRange\(metrics \[\]string, start, end time.Time, step string, filters map\[string\]string\) \(\[\]model.MetricRow, error\)](<#APIMetricStore.QueryMultiRange>)
  - [func \(a \*APIMetricStore\) QueryRange\(metric string, start, end time.Time, step string, filters map\[string\]string\) \(\[\]model.Point, error\)](<#APIMetricStore.QueryRange>)
  - [func \(a \*APIMetricStore\) Write\(metrics \[\]model.MetricPayload\) error](<#APIMetricStore.Write>)
- [type AlertContextResponse](<#AlertContextResponse>)
- [type ContainerMetrics](<#ContainerMetrics>)
- [type ContainerRow](<#ContainerRow>)
- [type EndpointFilter](<#EndpointFilter>)
  - [func ParseEndpointFilters\(r \*http.Request\) EndpointFilter](<#ParseEndpointFilters>)
- [type HostRow](<#HostRow>)
- [type HttpServer](<#HttpServer>)
  - [func NewServer\(sys \*sys.SystemContext\) \*HttpServer](<#NewServer>)
  - [func \(s \*HttpServer\) BuildAuthEventMeta\(user \*usermodel.User, r \*http.Request\) map\[string\]string](<#HttpServer.BuildAuthEventMeta>)
  - [func \(s \*HttpServer\) GetDimensions\(w http.ResponseWriter, r \*http.Request\)](<#HttpServer.GetDimensions>)
  - [func \(s \*HttpServer\) GetMetricData\(w http.ResponseWriter, r \*http.Request\)](<#HttpServer.GetMetricData>)
  - [func \(s \*HttpServer\) GetMetricDimensions\(w http.ResponseWriter, r \*http.Request\)](<#HttpServer.GetMetricDimensions>)
  - [func \(s \*HttpServer\) GetMetricLatest\(w http.ResponseWriter, r \*http.Request\)](<#HttpServer.GetMetricLatest>)
  - [func \(s \*HttpServer\) GetMetricNames\(w http.ResponseWriter, r \*http.Request\)](<#HttpServer.GetMetricNames>)
  - [func \(s \*HttpServer\) GetNamespaces\(w http.ResponseWriter, r \*http.Request\)](<#HttpServer.GetNamespaces>)
  - [func \(s \*HttpServer\) GetSubNamespaces\(w http.ResponseWriter, r \*http.Request\)](<#HttpServer.GetSubNamespaces>)
  - [func \(s \*HttpServer\) HandleAPIQuery\(w http.ResponseWriter, r \*http.Request\)](<#HttpServer.HandleAPIQuery>)
  - [func \(s \*HttpServer\) HandleActiveAlertsAPI\(w http.ResponseWriter, r \*http.Request\)](<#HttpServer.HandleActiveAlertsAPI>)
  - [func \(s \*HttpServer\) HandleActivityPage\(w http.ResponseWriter, r \*http.Request\)](<#HttpServer.HandleActivityPage>)
  - [func \(s \*HttpServer\) HandleAddAlertRulePage\(w http.ResponseWriter, r \*http.Request\)](<#HttpServer.HandleAddAlertRulePage>)
  - [func \(s \*HttpServer\) HandleAgentsAPI\(w http.ResponseWriter, r \*http.Request\)](<#HttpServer.HandleAgentsAPI>)
  - [func \(s \*HttpServer\) HandleAgentsPage\(w http.ResponseWriter, r \*http.Request, templateDir, env string\)](<#HttpServer.HandleAgentsPage>)
  - [func \(s \*HttpServer\) HandleAlertContext\(w http.ResponseWriter, r \*http.Request\)](<#HttpServer.HandleAlertContext>)
  - [func \(s \*HttpServer\) HandleAlertRulesAPI\(w http.ResponseWriter, r \*http.Request\)](<#HttpServer.HandleAlertRulesAPI>)
  - [func \(s \*HttpServer\) HandleAlertsAPI\(w http.ResponseWriter, r \*http.Request\)](<#HttpServer.HandleAlertsAPI>)
  - [func \(s \*HttpServer\) HandleAlertsActivePage\(w http.ResponseWriter, r \*http.Request\)](<#HttpServer.HandleAlertsActivePage>)
  - [func \(s \*HttpServer\) HandleAlertsHistoryPage\(w http.ResponseWriter, r \*http.Request\)](<#HttpServer.HandleAlertsHistoryPage>)
  - [func \(s \*HttpServer\) HandleAlertsPage\(w http.ResponseWriter, r \*http.Request\)](<#HttpServer.HandleAlertsPage>)
  - [func \(s \*HttpServer\) HandleAlertsSummaryAPI\(w http.ResponseWriter, r \*http.Request\)](<#HttpServer.HandleAlertsSummaryAPI>)
  - [func \(s \*HttpServer\) HandleCacheAudit\(w http.ResponseWriter, r \*http.Request\)](<#HttpServer.HandleCacheAudit>)
  - [func \(s \*HttpServer\) HandleCallback\(w http.ResponseWriter, r \*http.Request\)](<#HttpServer.HandleCallback>)
  - [func \(s \*HttpServer\) HandleCommandsAPI\(w http.ResponseWriter, r \*http.Request\)](<#HttpServer.HandleCommandsAPI>)
  - [func \(s \*HttpServer\) HandleContainers\(w http.ResponseWriter, r \*http.Request\)](<#HttpServer.HandleContainers>)
  - [func \(s \*HttpServer\) HandleCreateAlertRuleAPI\(w http.ResponseWriter, r \*http.Request\)](<#HttpServer.HandleCreateAlertRuleAPI>)
  - [func \(s \*HttpServer\) HandleDeleteTag\(w http.ResponseWriter, r \*http.Request\)](<#HttpServer.HandleDeleteTag>)
  - [func \(s \*HttpServer\) HandleEndpointDetail\(w http.ResponseWriter, r \*http.Request\)](<#HttpServer.HandleEndpointDetail>)
  - [func \(s \*HttpServer\) HandleEndpointPage\(w http.ResponseWriter, r \*http.Request\)](<#HttpServer.HandleEndpointPage>)
  - [func \(s \*HttpServer\) HandleEndpointsAPI\(w http.ResponseWriter, r \*http.Request\)](<#HttpServer.HandleEndpointsAPI>)
  - [func \(s \*HttpServer\) HandleEndpointsByTypeAPI\(w http.ResponseWriter, r \*http.Request\)](<#HttpServer.HandleEndpointsByTypeAPI>)
  - [func \(s \*HttpServer\) HandleEventsAPI\(w http.ResponseWriter, r \*http.Request\)](<#HttpServer.HandleEventsAPI>)
  - [func \(s \*HttpServer\) HandleExportQuery\(w http.ResponseWriter, r \*http.Request\)](<#HttpServer.HandleExportQuery>)
  - [func \(s \*HttpServer\) HandleGetTags\(w http.ResponseWriter, r \*http.Request\)](<#HttpServer.HandleGetTags>)
  - [func \(s \*HttpServer\) HandleGlobalSearchAPI\(w http.ResponseWriter, r \*http.Request\)](<#HttpServer.HandleGlobalSearchAPI>)
  - [func \(s \*HttpServer\) HandleIndexPage\(w http.ResponseWriter, r \*http.Request\)](<#HttpServer.HandleIndexPage>)
  - [func \(s \*HttpServer\) HandleLabelValues\(w http.ResponseWriter, r \*http.Request\)](<#HttpServer.HandleLabelValues>)
  - [func \(s \*HttpServer\) HandleLogAPI\(w http.ResponseWriter, r \*http.Request\)](<#HttpServer.HandleLogAPI>)
  - [func \(s \*HttpServer\) HandleLogin\(w http.ResponseWriter, r \*http.Request\)](<#HttpServer.HandleLogin>)
  - [func \(s \*HttpServer\) HandleLoginStart\(w http.ResponseWriter, r \*http.Request\)](<#HttpServer.HandleLoginStart>)
  - [func \(s \*HttpServer\) HandleLogout\(w http.ResponseWriter, r \*http.Request\)](<#HttpServer.HandleLogout>)
  - [func \(s \*HttpServer\) HandleLogsPage\(w http.ResponseWriter, r \*http.Request\)](<#HttpServer.HandleLogsPage>)
  - [func \(s \*HttpServer\) HandleMFA\(w http.ResponseWriter, r \*http.Request\)](<#HttpServer.HandleMFA>)
  - [func \(s \*HttpServer\) HandleMFAPage\(w http.ResponseWriter, r \*http.Request\)](<#HttpServer.HandleMFAPage>)
  - [func \(s \*HttpServer\) HandleMetricExplorerPage\(w http.ResponseWriter, r \*http.Request\)](<#HttpServer.HandleMetricExplorerPage>)
  - [func \(s \*HttpServer\) HandlePatchTags\(w http.ResponseWriter, r \*http.Request\)](<#HttpServer.HandlePatchTags>)
  - [func \(s \*HttpServer\) HandleRecentLogs\(w http.ResponseWriter, r \*http.Request\)](<#HttpServer.HandleRecentLogs>)
  - [func \(s \*HttpServer\) HandleSetTags\(w http.ResponseWriter, r \*http.Request\)](<#HttpServer.HandleSetTags>)
  - [func \(s \*HttpServer\) HandleTagKeys\(w http.ResponseWriter, r \*http.Request\)](<#HttpServer.HandleTagKeys>)
  - [func \(s \*HttpServer\) HandleTagValues\(w http.ResponseWriter, r \*http.Request\)](<#HttpServer.HandleTagValues>)
  - [func \(s \*HttpServer\) Shutdown\(\) error](<#HttpServer.Shutdown>)
  - [func \(s \*HttpServer\) Start\(\) error](<#HttpServer.Start>)
- [type LogResponse](<#LogResponse>)
- [type SearchResult](<#SearchResult>)


<a name="FilterAgents"></a>
## func [FilterAgents](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/http/handleEndpoints.go#L281>)

```go
func FilterAgents(list []*model.Agent, filter EndpointFilter) []*model.Agent
```

FilterAgents filters a list of agents based on the provided filter criteria. It checks for matching endpoint ID, hostname, status, host ID, tags, and last seen time. The filtered list is then sorted and limited based on the specified criteria.

<a name="FilterContainers"></a>
## func [FilterContainers](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/http/handleEndpoints.go#L394>)

```go
func FilterContainers(list []*model.Container, filter EndpointFilter) []*model.Container
```

FilterContainers filters a list of containers based on the provided filter criteria. It checks for matching endpoint ID, hostname, status, host ID, tags, and last seen time. The filtered list is then sorted and limited based on the specified criteria.

<a name="GetFlash"></a>
## func [GetFlash](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/http/flash.go#L47>)

```go
func GetFlash(w http.ResponseWriter, r *http.Request) string
```



<a name="InjectUserContext"></a>
## func [InjectUserContext](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/http/context.go#L11>)

```go
func InjectUserContext(ctx context.Context, user *usermodel.User) context.Context
```



<a name="SetFlash"></a>
## func [SetFlash](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/http/flash.go#L35>)

```go
func SetFlash(w http.ResponseWriter, message string)
```



<a name="SortAndLimitAgents"></a>
## func [SortAndLimitAgents](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/http/handleEndpoints.go#L429>)

```go
func SortAndLimitAgents(list []*model.Agent, sortBy, order string, limit int) []*model.Agent
```

SortAndLimitAgents sorts a list of agents based on the specified criteria and limits the number of results. It sorts by hostname or last seen time, and can reverse the order.

<a name="SortAndLimitContainers"></a>
## func [SortAndLimitContainers](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/http/handleEndpoints.go#L451>)

```go
func SortAndLimitContainers(list []*model.Container, sortBy, order string, limit int) []*model.Container
```

SortAndLimitContainers sorts a list of containers based on the specified criteria and limits the number of results. It sorts by name or last seen time, and can reverse the order.

<a name="SortBy"></a>
## func [SortBy](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/http/handleAlertsAPI.go#L206>)

```go
func SortBy(alerts *[]model.AlertInstance, field, order string)
```



<a name="APIMetricStore"></a>
## type [APIMetricStore](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/http/apistore.go#L13-L15>)



```go
type APIMetricStore struct {
    Store metricstore.MetricStore
}
```

<a name="APIMetricStore.Close"></a>
### func \(\*APIMetricStore\) [Close](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/http/apistore.go#L21>)

```go
func (a *APIMetricStore) Close() error
```



<a name="APIMetricStore.FetchDimensionsForMetric"></a>
### func \(\*APIMetricStore\) [FetchDimensionsForMetric](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/http/apistore.go#L41>)

```go
func (a *APIMetricStore) FetchDimensionsForMetric(metric string) ([]string, error)
```



<a name="APIMetricStore.QueryInstant"></a>
### func \(\*APIMetricStore\) [QueryInstant](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/http/apistore.go#L25>)

```go
func (a *APIMetricStore) QueryInstant(metric string, filters map[string]string) ([]model.MetricRow, error)
```



<a name="APIMetricStore.QueryMultiInstant"></a>
### func \(\*APIMetricStore\) [QueryMultiInstant](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/http/apistore.go#L34>)

```go
func (a *APIMetricStore) QueryMultiInstant(metricNames []string, filters map[string]string) ([]model.MetricRow, error)
```



<a name="APIMetricStore.QueryMultiRange"></a>
### func \(\*APIMetricStore\) [QueryMultiRange](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/http/apistore.go#L37>)

```go
func (a *APIMetricStore) QueryMultiRange(metrics []string, start, end time.Time, step string, filters map[string]string) ([]model.MetricRow, error)
```



<a name="APIMetricStore.QueryRange"></a>
### func \(\*APIMetricStore\) [QueryRange](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/http/apistore.go#L30>)

```go
func (a *APIMetricStore) QueryRange(metric string, start, end time.Time, step string, filters map[string]string) ([]model.Point, error)
```



<a name="APIMetricStore.Write"></a>
### func \(\*APIMetricStore\) [Write](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/http/apistore.go#L17>)

```go
func (a *APIMetricStore) Write(metrics []model.MetricPayload) error
```



<a name="AlertContextResponse"></a>
## type [AlertContextResponse](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/http/handleAlertsContextAPI.go#L34-L38>)



```go
type AlertContextResponse struct {
    Alert  model.AlertInstance `json:"alert"`
    Logs   []model.LogEntry    `json:"logs"`
    Events []model.EventEntry  `json:"events"`
}
```

<a name="ContainerMetrics"></a>
## type [ContainerMetrics](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/http/containers.go#L37-L49>)



```go
type ContainerMetrics struct {
    Host   string            `json:"host"`
    Name   string            `json:"name"`
    Image  string            `json:"image"`
    Status string            `json:"status"`
    CPU    *float64          `json:"cpu,omitempty"`
    Mem    *float64          `json:"mem,omitempty"`
    RX     *float64          `json:"rx,omitempty"`
    TX     *float64          `json:"tx,omitempty"`
    Uptime *float64          `json:"uptime,omitempty"`
    Labels map[string]string `json:"labels,omitempty"`
    Ports  string            `json:"ports,omitempty"`
}
```

<a name="ContainerRow"></a>
## type [ContainerRow](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/http/handleEndpoints.go#L51-L61>)



```go
type ContainerRow struct {
    ID     string
    Name   string
    Image  string
    Status string
    CPU    string
    Mem    string
    RX     string
    TX     string
    Uptime string
}
```

<a name="EndpointFilter"></a>
## type [EndpointFilter](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/http/handleEndpoints.go#L147-L162>)



```go
type EndpointFilter struct {
    EndpointID string
    Hostname   string
    Status     string
    HostID     string
    IP         string //  Add this
    OS         string
    Arch       string

    Tags        map[string]string
    LastSeenMin time.Duration
    LastSeenMax time.Duration
    Limit       int
    Sort        string
    Order       string
}
```

<a name="ParseEndpointFilters"></a>
### func [ParseEndpointFilters](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/http/handleEndpoints.go#L164>)

```go
func ParseEndpointFilters(r *http.Request) EndpointFilter
```



<a name="HostRow"></a>
## type [HostRow](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/http/handleEndpoints.go#L46-L49>)



```go
type HostRow struct {
    Agent   model.Agent
    Metrics map[string]string // uptime, cpu %, mem %, etc.
}
```

<a name="HttpServer"></a>
## type [HttpServer](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/http/httpserver.go#L37-L42>)



```go
type HttpServer struct {
    Router *mux.Router
    Sys    *sys.SystemContext
    Tmpl   *gosighttemplate.GoSightTemplate
    // contains filtered or unexported fields
}
```

<a name="NewServer"></a>
### func [NewServer](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/http/httpserver.go#L46>)

```go
func NewServer(sys *sys.SystemContext) *HttpServer
```

NewServer creates a new HTTP server instance with the provided system context. It initializes the router and sets up the server configuration.

<a name="HttpServer.BuildAuthEventMeta"></a>
### func \(\*HttpServer\) [BuildAuthEventMeta](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/http/helpers.go#L41>)

```go
func (s *HttpServer) BuildAuthEventMeta(user *usermodel.User, r *http.Request) map[string]string
```



<a name="HttpServer.GetDimensions"></a>
### func \(\*HttpServer\) [GetDimensions](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/http/handleMetricCacheAPI.go#L74>)

```go
func (s *HttpServer) GetDimensions(w http.ResponseWriter, r *http.Request)
```

GetDimensions retrieves all available dimensions.

<a name="HttpServer.GetMetricData"></a>
### func \(\*HttpServer\) [GetMetricData](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/http/handleMetricCacheAPI.go#L96>)

```go
func (s *HttpServer) GetMetricData(w http.ResponseWriter, r *http.Request)
```



<a name="HttpServer.GetMetricDimensions"></a>
### func \(\*HttpServer\) [GetMetricDimensions](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/http/handleMetricCacheAPI.go#L79>)

```go
func (s *HttpServer) GetMetricDimensions(w http.ResponseWriter, r *http.Request)
```

GetMetricDimensions retrieves the dimensions for a specific metric.

<a name="HttpServer.GetMetricLatest"></a>
### func \(\*HttpServer\) [GetMetricLatest](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/http/handleMetricCacheAPI.go#L143>)

```go
func (s *HttpServer) GetMetricLatest(w http.ResponseWriter, r *http.Request)
```



<a name="HttpServer.GetMetricNames"></a>
### func \(\*HttpServer\) [GetMetricNames](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/http/handleMetricCacheAPI.go#L61>)

```go
func (s *HttpServer) GetMetricNames(w http.ResponseWriter, r *http.Request)
```

GetMetricNames retrieves all metric names for a given namespace and subnamespace.

<a name="HttpServer.GetNamespaces"></a>
### func \(\*HttpServer\) [GetNamespaces](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/http/handleMetricCacheAPI.go#L44>)

```go
func (s *HttpServer) GetNamespaces(w http.ResponseWriter, r *http.Request)
```



<a name="HttpServer.GetSubNamespaces"></a>
### func \(\*HttpServer\) [GetSubNamespaces](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/http/handleMetricCacheAPI.go#L50>)

```go
func (s *HttpServer) GetSubNamespaces(w http.ResponseWriter, r *http.Request)
```



<a name="HttpServer.HandleAPIQuery"></a>
### func \(\*HttpServer\) [HandleAPIQuery](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/http/handleMetricCacheAPI.go#L170>)

```go
func (s *HttpServer) HandleAPIQuery(w http.ResponseWriter, r *http.Request)
```



<a name="HttpServer.HandleActiveAlertsAPI"></a>
### func \(\*HttpServer\) [HandleActiveAlertsAPI](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/http/handleAlertsAPI.go#L94>)

```go
func (s *HttpServer) HandleActiveAlertsAPI(w http.ResponseWriter, r *http.Request)
```



<a name="HttpServer.HandleActivityPage"></a>
### func \(\*HttpServer\) [HandleActivityPage](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/http/handleActivity.go#L36>)

```go
func (s *HttpServer) HandleActivityPage(w http.ResponseWriter, r *http.Request)
```

HandleActivityPage handles requests to the activity page.

<a name="HttpServer.HandleAddAlertRulePage"></a>
### func \(\*HttpServer\) [HandleAddAlertRulePage](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/http/handleAlerts.go#L145>)

```go
func (s *HttpServer) HandleAddAlertRulePage(w http.ResponseWriter, r *http.Request)
```



<a name="HttpServer.HandleAgentsAPI"></a>
### func \(\*HttpServer\) [HandleAgentsAPI](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/http/handleAgents.go#L70>)

```go
func (s *HttpServer) HandleAgentsAPI(w http.ResponseWriter, r *http.Request)
```

// HandleAgentsAPI returns a JSON list of active agents

```
func (s *HttpServer) HandleAgentsAPI(w http.ResponseWriter, r *http.Request) {
	agents := s.Sys.Agents.GetAgents()

	sort.SliceStable(agents, func(i, j int) bool {
		return agents[i].Hostname < agents[j].Hostname
	})

	w.Header().Set("Content-Type", "application/json")
	_ = json.NewEncoder(w).Encode(agents)
}
```

<a name="HttpServer.HandleAgentsPage"></a>
### func \(\*HttpServer\) [HandleAgentsPage](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/http/handleAgents.go#L39>)

```go
func (s *HttpServer) HandleAgentsPage(w http.ResponseWriter, r *http.Request, templateDir, env string)
```

RenderAgentsPage serves the agents.html template

<a name="HttpServer.HandleAlertContext"></a>
### func \(\*HttpServer\) [HandleAlertContext](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/http/handleAlertsContextAPI.go#L40>)

```go
func (s *HttpServer) HandleAlertContext(w http.ResponseWriter, r *http.Request)
```



<a name="HttpServer.HandleAlertRulesAPI"></a>
### func \(\*HttpServer\) [HandleAlertRulesAPI](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/http/handleAlertsAPI.go#L111>)

```go
func (s *HttpServer) HandleAlertRulesAPI(w http.ResponseWriter, r *http.Request)
```



<a name="HttpServer.HandleAlertsAPI"></a>
### func \(\*HttpServer\) [HandleAlertsAPI](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/http/handleAlertsAPI.go#L42>)

```go
func (s *HttpServer) HandleAlertsAPI(w http.ResponseWriter, r *http.Request)
```



<a name="HttpServer.HandleAlertsActivePage"></a>
### func \(\*HttpServer\) [HandleAlertsActivePage](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/http/handleAlerts.go#L72>)

```go
func (s *HttpServer) HandleAlertsActivePage(w http.ResponseWriter, r *http.Request)
```



<a name="HttpServer.HandleAlertsHistoryPage"></a>
### func \(\*HttpServer\) [HandleAlertsHistoryPage](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/http/handleAlerts.go#L108>)

```go
func (s *HttpServer) HandleAlertsHistoryPage(w http.ResponseWriter, r *http.Request)
```

HandleAlertsHistoryPage handles the page for viewing alert history at /alerts/history

<a name="HttpServer.HandleAlertsPage"></a>
### func \(\*HttpServer\) [HandleAlertsPage](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/http/handleAlerts.go#L35>)

```go
func (s *HttpServer) HandleAlertsPage(w http.ResponseWriter, r *http.Request)
```

HandleAlertsHistoryPage handles the page for viewing configured alerts at /alerts

<a name="HttpServer.HandleAlertsSummaryAPI"></a>
### func \(\*HttpServer\) [HandleAlertsSummaryAPI](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/http/handleAlertsAPI.go#L133>)

```go
func (s *HttpServer) HandleAlertsSummaryAPI(w http.ResponseWriter, r *http.Request)
```

HandleAlertsSummaryAPI handles requests to the /api/alerts/summary endpoint It returns a summary of alerts grouped by rule\_id, showing the latest state and last change time.

<a name="HttpServer.HandleCacheAudit"></a>
### func \(\*HttpServer\) [HandleCacheAudit](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/http/handleDebug.go#L10>)

```go
func (s *HttpServer) HandleCacheAudit(w http.ResponseWriter, r *http.Request)
```



<a name="HttpServer.HandleCallback"></a>
### func \(\*HttpServer\) [HandleCallback](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/http/handleAuth.go#L52>)

```go
func (s *HttpServer) HandleCallback(w http.ResponseWriter, r *http.Request)
```

handleCallback handles the callback route for various auth providers.

<a name="HttpServer.HandleCommandsAPI"></a>
### func \(\*HttpServer\) [HandleCommandsAPI](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/http/handleCommandsAPI.go#L36>)

```go
func (s *HttpServer) HandleCommandsAPI(w http.ResponseWriter, r *http.Request)
```



<a name="HttpServer.HandleContainers"></a>
### func \(\*HttpServer\) [HandleContainers](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/http/containers.go#L51>)

```go
func (s *HttpServer) HandleContainers(w http.ResponseWriter, r *http.Request)
```



<a name="HttpServer.HandleCreateAlertRuleAPI"></a>
### func \(\*HttpServer\) [HandleCreateAlertRuleAPI](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/http/handleAlertsAPI.go#L167>)

```go
func (s *HttpServer) HandleCreateAlertRuleAPI(w http.ResponseWriter, r *http.Request)
```

HandleCreateAlert handles POST /api/v1/alerts

<a name="HttpServer.HandleDeleteTag"></a>
### func \(\*HttpServer\) [HandleDeleteTag](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/http/handleTagsAPI.go#L102>)

```go
func (s *HttpServer) HandleDeleteTag(w http.ResponseWriter, r *http.Request)
```

HandleDeleteTag deletes a specific tag key

<a name="HttpServer.HandleEndpointDetail"></a>
### func \(\*HttpServer\) [HandleEndpointDetail](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/http/handleEndpoints.go#L101>)

```go
func (s *HttpServer) HandleEndpointDetail(w http.ResponseWriter, r *http.Request)
```



<a name="HttpServer.HandleEndpointPage"></a>
### func \(\*HttpServer\) [HandleEndpointPage](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/http/handleEndpoints.go#L63>)

```go
func (s *HttpServer) HandleEndpointPage(w http.ResponseWriter, r *http.Request)
```



<a name="HttpServer.HandleEndpointsAPI"></a>
### func \(\*HttpServer\) [HandleEndpointsAPI](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/http/handleEndpoints.go#L197>)

```go
func (s *HttpServer) HandleEndpointsAPI(w http.ResponseWriter, r *http.Request)
```

HandleEndpointsAPI returns a JSON list of active endpoints It supports querying or listing all endpoints as well as /api/v1/endpoints/\{endpoint\_type\} \(hosts / containers\)

<a name="HttpServer.HandleEndpointsByTypeAPI"></a>
### func \(\*HttpServer\) [HandleEndpointsByTypeAPI](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/http/handleEndpoints.go#L327>)

```go
func (s *HttpServer) HandleEndpointsByTypeAPI(w http.ResponseWriter, r *http.Request)
```

HandleEndpointsByTypeAPI handles the /api/v1/endpoints/\{endpointType\} endpoint. It returns a JSON list of active endpoints filtered by the specified type \(hosts or containers\). It supports querying or listing all endpoints of the specified type. The endpoint type is specified in the URL path.

<a name="HttpServer.HandleEventsAPI"></a>
### func \(\*HttpServer\) [HandleEventsAPI](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/http/handleEventAPI.go#L30>)

```go
func (s *HttpServer) HandleEventsAPI(w http.ResponseWriter, r *http.Request)
```



<a name="HttpServer.HandleExportQuery"></a>
### func \(\*HttpServer\) [HandleExportQuery](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/http/handleMetricCacheAPI.go#L330>)

```go
func (s *HttpServer) HandleExportQuery(w http.ResponseWriter, r *http.Request)
```

ExportQueryHandler handles flexible label\-based queries without requiring a metric name. Supports optional time range via start= and end= query params.

<a name="HttpServer.HandleGetTags"></a>
### func \(\*HttpServer\) [HandleGetTags](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/http/handleTagsAPI.go#L36>)

```go
func (s *HttpServer) HandleGetTags(w http.ResponseWriter, r *http.Request)
```

HandleGetTags returns all tags for an endpoint

<a name="HttpServer.HandleGlobalSearchAPI"></a>
### func \(\*HttpServer\) [HandleGlobalSearchAPI](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/http/handleSearchAPI.go#L42>)

```go
func (s *HttpServer) HandleGlobalSearchAPI(w http.ResponseWriter, r *http.Request)
```



<a name="HttpServer.HandleIndexPage"></a>
### func \(\*HttpServer\) [HandleIndexPage](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/http/handleIndex.go#L35>)

```go
func (s *HttpServer) HandleIndexPage(w http.ResponseWriter, r *http.Request)
```



<a name="HttpServer.HandleLabelValues"></a>
### func \(\*HttpServer\) [HandleLabelValues](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/http/handleLabelsAPI.go#L36>)

```go
func (s *HttpServer) HandleLabelValues(w http.ResponseWriter, r *http.Request)
```

HandleLabelValues returns all values for a given label key from

<a name="HttpServer.HandleLogAPI"></a>
### func \(\*HttpServer\) [HandleLogAPI](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/http/handleLogAPI.go#L92>)

```go
func (s *HttpServer) HandleLogAPI(w http.ResponseWriter, r *http.Request)
```



<a name="HttpServer.HandleLogin"></a>
### func \(\*HttpServer\) [HandleLogin](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/http/handleAuth.go#L160>)

```go
func (s *HttpServer) HandleLogin(w http.ResponseWriter, r *http.Request)
```

HandleLogin renders the login page. It lists all available auth providers and handles flash messages.

<a name="HttpServer.HandleLoginStart"></a>
### func \(\*HttpServer\) [HandleLoginStart](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/http/handleAuth.go#L42>)

```go
func (s *HttpServer) HandleLoginStart(w http.ResponseWriter, r *http.Request)
```

startLogin handles the login/start route for various auth providers.

<a name="HttpServer.HandleLogout"></a>
### func \(\*HttpServer\) [HandleLogout](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/http/handleAuth.go#L283>)

```go
func (s *HttpServer) HandleLogout(w http.ResponseWriter, r *http.Request)
```

HandleLogout handles the logout process.

<a name="HttpServer.HandleLogsPage"></a>
### func \(\*HttpServer\) [HandleLogsPage](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/http/handleLogsPage.go#L34>)

```go
func (s *HttpServer) HandleLogsPage(w http.ResponseWriter, r *http.Request)
```



<a name="HttpServer.HandleMFA"></a>
### func \(\*HttpServer\) [HandleMFA](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/http/handleAuth.go#L191>)

```go
func (s *HttpServer) HandleMFA(w http.ResponseWriter, r *http.Request)
```



<a name="HttpServer.HandleMFAPage"></a>
### func \(\*HttpServer\) [HandleMFAPage](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/http/handleAuth.go#L269>)

```go
func (s *HttpServer) HandleMFAPage(w http.ResponseWriter, r *http.Request)
```



<a name="HttpServer.HandleMetricExplorerPage"></a>
### func \(\*HttpServer\) [HandleMetricExplorerPage](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/http/handleMetricExplorer.go#L40>)

```go
func (s *HttpServer) HandleMetricExplorerPage(w http.ResponseWriter, r *http.Request)
```



<a name="HttpServer.HandlePatchTags"></a>
### func \(\*HttpServer\) [HandlePatchTags](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/http/handleTagsAPI.go#L72>)

```go
func (s *HttpServer) HandlePatchTags(w http.ResponseWriter, r *http.Request)
```

HandlePatchTags updates or adds individual tags

<a name="HttpServer.HandleRecentLogs"></a>
### func \(\*HttpServer\) [HandleRecentLogs](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/http/handleLogAPI.go#L47>)

```go
func (s *HttpServer) HandleRecentLogs(w http.ResponseWriter, r *http.Request)
```



<a name="HttpServer.HandleSetTags"></a>
### func \(\*HttpServer\) [HandleSetTags](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/http/handleTagsAPI.go#L52>)

```go
func (s *HttpServer) HandleSetTags(w http.ResponseWriter, r *http.Request)
```

HandleSetTags replaces all tags for an endpoint

<a name="HttpServer.HandleTagKeys"></a>
### func \(\*HttpServer\) [HandleTagKeys](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/http/handleTagsAPI.go#L123>)

```go
func (s *HttpServer) HandleTagKeys(w http.ResponseWriter, r *http.Request)
```

HandleTagKeys returns all known tag keys

<a name="HttpServer.HandleTagValues"></a>
### func \(\*HttpServer\) [HandleTagValues](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/http/handleTagsAPI.go#L129>)

```go
func (s *HttpServer) HandleTagValues(w http.ResponseWriter, r *http.Request)
```

HandleTagValues returns all values for a given key

<a name="HttpServer.Shutdown"></a>
### func \(\*HttpServer\) [Shutdown](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/http/httpserver.go#L116>)

```go
func (s *HttpServer) Shutdown() error
```



<a name="HttpServer.Start"></a>
### func \(\*HttpServer\) [Start](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/http/httpserver.go#L61>)

```go
func (s *HttpServer) Start() error
```



<a name="LogResponse"></a>
## type [LogResponse](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/http/handleLogAPI.go#L85-L90>)

HandleLogAPI handles the HTTP request for the log API. It retrieves the logs from the log store, applies any filters specified in the query parameters, and returns the logs as a JSON response. The function uses the LogQueryParams struct to parse the query parameters and filter the logs. It handles errors and returns appropriate HTTP status codes and messages. The logs are filtered based on the specified levels, unit, source, contains string, and start and end times. The function limits the number of logs returned to the specified limit in the query parameters, with a maximum of 1000 logs. If the limit is not specified, it defaults to 100 logs. The function also handles errors and returns appropriate HTTP status codes and messages.

```go
type LogResponse struct {
    Logs       []model.LogEntry `json:"logs"`
    NextCursor string           `json:"next_cursor,omitempty"`
    HasMore    bool             `json:"has_more"`
    Count      int              `json:"count"`
}
```

<a name="SearchResult"></a>
## type [SearchResult](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/http/handleSearchAPI.go#L34-L40>)



```go
type SearchResult struct {
    Hosts      []map[string]string `json:"hosts"`
    Containers []map[string]string `json:"containers"`
    Rules      []map[string]string `json:"rules"`
    Tags       []map[string]string `json:"tags"`
    Logs       []map[string]string `json:"logs"`
}
```

# rules

```go
import "github.com/aaronlmathis/gosight-server/internal/rules"
```

Package rules provides the core logic for evaluating alert rules and emitting events based on metric data.

## Index

- [type Evaluator](<#Evaluator>)
  - [func NewEvaluator\(store rulestore.RuleStore, alertMgr \*alerts.Manager\) \*Evaluator](<#NewEvaluator>)
  - [func \(e \*Evaluator\) EvaluateLogs\(ctx context.Context, logs \[\]model.LogEntry, meta \*model.Meta\)](<#Evaluator.EvaluateLogs>)
  - [func \(e \*Evaluator\) EvaluateMetric\(ctx context.Context, metrics \[\]model.Metric, meta \*model.Meta\)](<#Evaluator.EvaluateMetric>)


<a name="Evaluator"></a>
## type [Evaluator](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/rules/engine.go#L39-L44>)



```go
type Evaluator struct {
    AlertMgr *alerts.Manager
    // contains filtered or unexported fields
}
```

<a name="NewEvaluator"></a>
### func [NewEvaluator](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/rules/engine.go#L53>)

```go
func NewEvaluator(store rulestore.RuleStore, alertMgr *alerts.Manager) *Evaluator
```



<a name="Evaluator.EvaluateLogs"></a>
### func \(\*Evaluator\) [EvaluateLogs](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/rules/engine.go#L131>)

```go
func (e *Evaluator) EvaluateLogs(ctx context.Context, logs []model.LogEntry, meta *model.Meta)
```

EvaluateLogs processes the given logs and metadata, checking them against active rules in the store. It emits events when rules are triggered based on the logs. The evaluation is done in the context of the provided context.Context. The logs are expected to be in the format of model.LogEntry, and the metadata is expected to be in the format of model.Meta. Logs are point\-in\-time events, so they are always evaluated immediately.

<a name="Evaluator.EvaluateMetric"></a>
### func \(\*Evaluator\) [EvaluateMetric](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/rules/engine.go#L68>)

```go
func (e *Evaluator) EvaluateMetric(ctx context.Context, metrics []model.Metric, meta *model.Meta)
```

EvaluateMetric processes the given metrics and metadata, checking them against active rules in the store. It emits events when rules are triggered based on the metrics. The evaluation is done in the context of the provided context.Context. The metrics are expected to be in the format of model.Metric, and the metadata is expected to be in the format of model.Meta.

# runner

```go
import "github.com/aaronlmathis/gosight-server/internal/runner"
```

## Index



# syncmanager

```go
import "github.com/aaronlmathis/gosight-server/internal/syncmanager"
```

## Index

- [type SyncManager](<#SyncManager>)
  - [func NewSyncManager\(ctx context.Context, c \*cache.Cache, ds datastore.DataStore, tracker \*tracker.EndpointTracker, interval time.Duration\) \*SyncManager](<#NewSyncManager>)
  - [func \(s \*SyncManager\) Run\(\)](<#SyncManager.Run>)
  - [func \(s \*SyncManager\) SyncOnce\(\)](<#SyncManager.SyncOnce>)


<a name="SyncManager"></a>
## type [SyncManager](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/syncmanager/syncmanager.go#L40-L47>)

SyncManager handles periodic persistence of in\-memory caches to the database.

```go
type SyncManager struct {
    Cache     *cache.Cache
    DataStore datastore.DataStore
    Tracker   *tracker.EndpointTracker
    Interval  time.Duration
    // contains filtered or unexported fields
}
```

<a name="NewSyncManager"></a>
### func [NewSyncManager](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/syncmanager/syncmanager.go#L50>)

```go
func NewSyncManager(ctx context.Context, c *cache.Cache, ds datastore.DataStore, tracker *tracker.EndpointTracker, interval time.Duration) *SyncManager
```

New creates a new SyncManager.

<a name="SyncManager.Run"></a>
### func \(\*SyncManager\) [Run](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/syncmanager/syncmanager.go#L61>)

```go
func (s *SyncManager) Run()
```

Run starts the sync manager and blocks until ctx is cancelled. On shutdown, it flushes all caches.

<a name="SyncManager.SyncOnce"></a>
### func \(\*SyncManager\) [SyncOnce](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/syncmanager/syncmanager.go#L133>)

```go
func (s *SyncManager) SyncOnce()
```

SyncOnce triggers a one\-time flush for all caches. Useful for shutdown or CLI tools.

# sys

```go
import "github.com/aaronlmathis/gosight-server/internal/sys"
```

gosight/agent/internal/sys/caches.go Package sys provides system\-level caches and context for the agent. This includes caches for metrics, logs, and processes.

gosight/agent/internal/sys/sys.go Package sys provides the system context for the GoSight application.

## Index

- [type BufferModule](<#BufferModule>)
- [type CacheModule](<#CacheModule>)
- [type StoreModule](<#StoreModule>)
  - [func NewStoreModule\(metrics metricstore.MetricStore, logs logstore.LogStore, users userstore.UserStore, data datastore.DataStore, events eventstore.EventStore, rules rulestore.RuleStore, actions \*routestore.RouteStore, alerts alertstore.AlertStore\) \*StoreModule](<#NewStoreModule>)
- [type SystemContext](<#SystemContext>)
  - [func NewSystemContext\(ctx context.Context, cfg \*config.Config, tracker \*tracker.EndpointTracker, wsHub \*websocket.HubManager, authProviders map\[string\]gosightauth.AuthProvider, stores \*StoreModule, telemetry \*TelemetryModule, caches \*cache.Cache, buffers \*BufferModule, syncMgr \*syncmanager.SyncManager\) \*SystemContext](<#NewSystemContext>)
- [type TelemetryModule](<#TelemetryModule>)
  - [func NewTelemetryModule\(index \*metricindex.MetricIndex, meta \*metastore.MetaTracker, evaluator \*rules.Evaluator, alerts \*alerts.Manager, emitter \*events.Emitter, dispatcher \*dispatcher.Dispatcher\) \*TelemetryModule](<#NewTelemetryModule>)


<a name="BufferModule"></a>
## type [BufferModule](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/sys/buffers.go#L5-L11>)



```go
type BufferModule struct {
    Metrics bufferengine.BufferedStore
    Logs    bufferengine.BufferedStore
    Data    bufferengine.BufferedStore
    Events  bufferengine.BufferedStore
    Alerts  bufferengine.BufferedStore
}
```

<a name="CacheModule"></a>
## type [CacheModule](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/sys/caches.go#L29-L33>)



```go
type CacheModule struct {
    Process cache.ProcessCache
    Metric  cache.MetricCache
}
```

<a name="StoreModule"></a>
## type [StoreModule](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/sys/stores.go#L39-L48>)

StoreModule contains all persistent or semi\-persistent storage components.

```go
type StoreModule struct {
    Metrics metricstore.MetricStore // Time-series metrics (e.g., VictoriaMetrics)
    Logs    logstore.LogStore       // Structured logs (e.g., journald, /var/log/secure)
    Users   userstore.UserStore     // User auth, roles, permissions
    Data    datastore.DataStore     // Hosts, endpoints, agents, etc.
    Events  eventstore.EventStore   // Event logs, audit, alert events
    Rules   rulestore.RuleStore     // Alert rules defined by users
    Actions *routestore.RouteStore  // Routes loaded from alert_routes.yaml
    Alerts  alertstore.AlertStore   // Alert instances (active, resolved, history)
}
```

<a name="NewStoreModule"></a>
### func [NewStoreModule](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/sys/stores.go#L52-L61>)

```go
func NewStoreModule(metrics metricstore.MetricStore, logs logstore.LogStore, users userstore.UserStore, data datastore.DataStore, events eventstore.EventStore, rules rulestore.RuleStore, actions *routestore.RouteStore, alerts alertstore.AlertStore) *StoreModule
```



<a name="SystemContext"></a>
## type [SystemContext](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/sys/sys.go#L38-L49>)

SystemContext is passed to all subsystems, providing full access to config, state, and interfaces.

```go
type SystemContext struct {
    Ctx     context.Context
    Cfg     *config.Config
    Tracker *tracker.EndpointTracker // Tracks endpoint state, uptime, heartbeat
    WSHub   *websocket.HubManager
    Auth    map[string]gosightauth.AuthProvider
    Stores  *StoreModule
    Tele    *TelemetryModule
    Cache   *cache.Cache
    Buffers *BufferModule
    SyncMgr *syncmanager.SyncManager
}
```

<a name="NewSystemContext"></a>
### func [NewSystemContext](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/sys/sys.go#L51-L63>)

```go
func NewSystemContext(ctx context.Context, cfg *config.Config, tracker *tracker.EndpointTracker, wsHub *websocket.HubManager, authProviders map[string]gosightauth.AuthProvider, stores *StoreModule, telemetry *TelemetryModule, caches *cache.Cache, buffers *BufferModule, syncMgr *syncmanager.SyncManager) *SystemContext
```



<a name="TelemetryModule"></a>
## type [TelemetryModule](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/sys/telemetry.go#L37-L44>)

TelemetryModule encapsulates telemetry\-related state and processing.

```go
type TelemetryModule struct {
    Index      *metricindex.MetricIndex // Metric name/dimension catalog
    Meta       *metastore.MetaTracker   // Tracks source metadata (labels, tags, endpoint info)
    Evaluator  *rules.Evaluator         // Rule evaluator (metrics  match?)
    Alerts     *alerts.Manager          // Tracks alert state per rule/endpoint
    Emitter    *events.Emitter          // Emits events (alerts, system actions)
    Dispatcher *dispatcher.Dispatcher   // Routes alert events to actions
}
```

<a name="NewTelemetryModule"></a>
### func [NewTelemetryModule](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/sys/telemetry.go#L48-L55>)

```go
func NewTelemetryModule(index *metricindex.MetricIndex, meta *metastore.MetaTracker, evaluator *rules.Evaluator, alerts *alerts.Manager, emitter *events.Emitter, dispatcher *dispatcher.Dispatcher) *TelemetryModule
```



# telemetry

```go
import "github.com/aaronlmathis/gosight-server/internal/telemetry"
```

## Index

- [func ConvertProtoProcessPayload\(pb \*proto.ProcessPayload\) model.ProcessPayload](<#ConvertProtoProcessPayload>)
- [func ConvertToModelLogPayload\(pbPayload \*proto.LogPayload\) model.LogPayload](<#ConvertToModelLogPayload>)
- [func ConvertToModelPayload\(pbPayload \*proto.MetricPayload\) model.MetricPayload](<#ConvertToModelPayload>)
- [func MergeDimensionsWithMeta\(base map\[string\]string, meta \*model.Meta\) map\[string\]string](<#MergeDimensionsWithMeta>)
- [func SafeHandlePayload\(handler func\(\)\)](<#SafeHandlePayload>)
- [type LogsHandler](<#LogsHandler>)
  - [func NewLogsHandler\(sys \*sys.SystemContext\) \*LogsHandler](<#NewLogsHandler>)
  - [func \(h \*LogsHandler\) EvaluateSeverityLevel\(logPayload \*model.LogPayload\)](<#LogsHandler.EvaluateSeverityLevel>)
  - [func \(h \*LogsHandler\) SubmitStream\(stream pb.LogService\_SubmitStreamServer\) error](<#LogsHandler.SubmitStream>)
- [type StreamHandler](<#StreamHandler>)
  - [func NewStreamHandler\(sys \*sys.SystemContext\) \*StreamHandler](<#NewStreamHandler>)
  - [func \(h \*StreamHandler\) EnqueueCommandToAgent\(ctx context.Context, agentID string, commandType, command string, args \[\]string\) error](<#StreamHandler.EnqueueCommandToAgent>)
  - [func \(h \*StreamHandler\) Stream\(stream pb.StreamService\_StreamServer\) error](<#StreamHandler.Stream>)


<a name="ConvertProtoProcessPayload"></a>
## func [ConvertProtoProcessPayload](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/telemetry/convert.go#L72>)

```go
func ConvertProtoProcessPayload(pb *proto.ProcessPayload) model.ProcessPayload
```

ConvertProtoProcessPayload converts a protobuf ProcessPayload to a model.ProcessPayload.

<a name="ConvertToModelLogPayload"></a>
## func [ConvertToModelLogPayload](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/telemetry/convert.go#L107>)

```go
func ConvertToModelLogPayload(pbPayload *proto.LogPayload) model.LogPayload
```

ConvertToModelLogPayload converts a protobuf LogPayload to a model.LogPayload.

<a name="ConvertToModelPayload"></a>
## func [ConvertToModelPayload](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/telemetry/convert.go#L30>)

```go
func ConvertToModelPayload(pbPayload *proto.MetricPayload) model.MetricPayload
```

ConvertToModelPayload converts a protobuf MetricPayload to a model.MetricPayload.

<a name="MergeDimensionsWithMeta"></a>
## func [MergeDimensionsWithMeta](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/telemetry/helpers.go#L6>)

```go
func MergeDimensionsWithMeta(base map[string]string, meta *model.Meta) map[string]string
```

TODO \- do this better.

<a name="SafeHandlePayload"></a>
## func [SafeHandlePayload](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/telemetry/guardrail.go#L34>)

```go
func SafeHandlePayload(handler func())
```

SafeHandlePayload wraps a handler function to recover from any panics that occur during its execution.

<a name="LogsHandler"></a>
## type [LogsHandler](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/telemetry/logs.go#L36-L39>)



```go
type LogsHandler struct {
    Sys *sys.SystemContext
    pb.UnimplementedLogServiceServer
}
```

<a name="NewLogsHandler"></a>
### func [NewLogsHandler](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/telemetry/logs.go#L41>)

```go
func NewLogsHandler(sys *sys.SystemContext) *LogsHandler
```



<a name="LogsHandler.EvaluateSeverityLevel"></a>
### func \(\*LogsHandler\) [EvaluateSeverityLevel](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/telemetry/logs.go#L107>)

```go
func (h *LogsHandler) EvaluateSeverityLevel(logPayload *model.LogPayload)
```

EvaluateSeverityLevel evaluates the severity level of logs based on thresholds defined in the system. Based on that severity, different actions can be taken such as generating events that can trigger alerts.

<a name="LogsHandler.SubmitStream"></a>
### func \(\*LogsHandler\) [SubmitStream](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/telemetry/logs.go#L48>)

```go
func (h *LogsHandler) SubmitStream(stream pb.LogService_SubmitStreamServer) error
```



<a name="StreamHandler"></a>
## type [StreamHandler](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/telemetry/streams.go#L39-L42>)

StreamHandler implements pb.MetricsServiceServer StreamHandler implements MetricsServiceServer

```go
type StreamHandler struct {
    Sys *sys.SystemContext
    pb.UnimplementedStreamServiceServer
}
```

<a name="NewStreamHandler"></a>
### func [NewStreamHandler](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/telemetry/streams.go#L44>)

```go
func NewStreamHandler(sys *sys.SystemContext) *StreamHandler
```



<a name="StreamHandler.EnqueueCommandToAgent"></a>
### func \(\*StreamHandler\) [EnqueueCommandToAgent](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/telemetry/command.go#L32>)

```go
func (h *StreamHandler) EnqueueCommandToAgent(ctx context.Context, agentID string, commandType, command string, args []string) error
```



<a name="StreamHandler.Stream"></a>
### func \(\*StreamHandler\) [Stream](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/telemetry/streams.go#L51>)

```go
func (h *StreamHandler) Stream(stream pb.StreamService_StreamServer) error
```



# testutils

```go
import "github.com/aaronlmathis/gosight-server/internal/testutils"
```

## Index

- [func TriggerTestAlert\(sys \*sys.SystemContext\)](<#TriggerTestAlert>)


<a name="TriggerTestAlert"></a>
## func [TriggerTestAlert](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/testutils/metric_simulator.go#L12>)

```go
func TriggerTestAlert(sys *sys.SystemContext)
```

TriggerTestAlert simulates a high memory usage metric to trigger a test rule.

# tracker

```go
import "github.com/aaronlmathis/gosight-server/internal/tracker"
```

## Index

- [func BuildAgentEventMeta\(agent \*model.Agent\) map\[string\]string](<#BuildAgentEventMeta>)
- [func BuildContainerEventMeta\(c \*model.Container\) map\[string\]string](<#BuildContainerEventMeta>)
- [func NormalizeContainerStatus\(raw string\) string](<#NormalizeContainerStatus>)
- [type CommandQueue](<#CommandQueue>)
- [type EndpointTracker](<#EndpointTracker>)
  - [func NewEndpointTracker\(ctx context.Context, emitter \*events.Emitter, dataStore datastore.DataStore\) \*EndpointTracker](<#NewEndpointTracker>)
  - [func \(t \*EndpointTracker\) CheckAgentStatusesAndEmitEvents\(\)](<#EndpointTracker.CheckAgentStatusesAndEmitEvents>)
  - [func \(t \*EndpointTracker\) CheckContainerStatusesAndEmit\(\)](<#EndpointTracker.CheckContainerStatusesAndEmit>)
  - [func \(t \*EndpointTracker\) DequeueCommand\(agentID string\) \*proto.CommandRequest](<#EndpointTracker.DequeueCommand>)
  - [func \(t \*EndpointTracker\) EnqueueCommand\(agentID string, cmd \*proto.CommandRequest\) bool](<#EndpointTracker.EnqueueCommand>)
  - [func \(t \*EndpointTracker\) GetAgentMap\(\) map\[string\]model.Agent](<#EndpointTracker.GetAgentMap>)
  - [func \(t \*EndpointTracker\) GetAgentSession\(agentID string\) \(\*LiveAgentSession, bool\)](<#EndpointTracker.GetAgentSession>)
  - [func \(t \*EndpointTracker\) GetAgents\(\) \[\]model.Agent](<#EndpointTracker.GetAgents>)
  - [func \(t \*EndpointTracker\) GetEndpointIdByAgentId\(agentID string\) \(string, bool\)](<#EndpointTracker.GetEndpointIdByAgentId>)
  - [func \(t \*EndpointTracker\) GetLiveAgentIDs\(\) \[\]string](<#EndpointTracker.GetLiveAgentIDs>)
  - [func \(t \*EndpointTracker\) HasLiveSession\(agentID string\) bool](<#EndpointTracker.HasLiveSession>)
  - [func \(t \*EndpointTracker\) IsAgentLive\(agentID string\) bool](<#EndpointTracker.IsAgentLive>)
  - [func \(t \*EndpointTracker\) IsContainerLive\(endpointID string\) bool](<#EndpointTracker.IsContainerLive>)
  - [func \(t \*EndpointTracker\) ListEndpoints\(\) \[\]model.Endpoint](<#EndpointTracker.ListEndpoints>)
  - [func \(t \*EndpointTracker\) RegisterAgentSession\(agentID string, client proto.StreamService\_StreamServer\)](<#EndpointTracker.RegisterAgentSession>)
  - [func \(t \*EndpointTracker\) RemoveAgentSession\(agentID string\)](<#EndpointTracker.RemoveAgentSession>)
  - [func \(t \*EndpointTracker\) SyncToStore\(ctx context.Context, store datastore.DataStore\)](<#EndpointTracker.SyncToStore>)
  - [func \(t \*EndpointTracker\) UpdateAgent\(meta \*model.Meta\)](<#EndpointTracker.UpdateAgent>)
  - [func \(t \*EndpointTracker\) UpdateContainer\(meta \*model.Meta\)](<#EndpointTracker.UpdateContainer>)
- [type LiveAgentSession](<#LiveAgentSession>)


<a name="BuildAgentEventMeta"></a>
## func [BuildAgentEventMeta](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/tracker/helpers.go#L43>)

```go
func BuildAgentEventMeta(agent *model.Agent) map[string]string
```



<a name="BuildContainerEventMeta"></a>
## func [BuildContainerEventMeta](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/tracker/helpers.go#L66>)

```go
func BuildContainerEventMeta(c *model.Container) map[string]string
```

BuildContainerEventMeta builds a map of container metadata for event tracking. This is used to track container events such as creation, updates, and deletions. The metadata includes various attributes of the container such as container ID, name, image, runtime, status, endpoint ID, and host ID. The function takes a container object as input and returns a map of strings representing the metadata.

<a name="NormalizeContainerStatus"></a>
## func [NormalizeContainerStatus](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/tracker/helpers.go#L79>)

```go
func NormalizeContainerStatus(raw string) string
```



<a name="CommandQueue"></a>
## type [CommandQueue](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/tracker/commandQueue.go#L29-L31>)



```go
type CommandQueue struct {
    Pending []*proto.CommandRequest
}
```

<a name="EndpointTracker"></a>
## type [EndpointTracker](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/tracker/endpoint.go#L39-L48>)



```go
type EndpointTracker struct {
    // contains filtered or unexported fields
}
```

<a name="NewEndpointTracker"></a>
### func [NewEndpointTracker](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/tracker/endpoint.go#L50>)

```go
func NewEndpointTracker(ctx context.Context, emitter *events.Emitter, dataStore datastore.DataStore) *EndpointTracker
```



<a name="EndpointTracker.CheckAgentStatusesAndEmitEvents"></a>
### func \(\*EndpointTracker\) [CheckAgentStatusesAndEmitEvents](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/tracker/endpoint.go#L384>)

```go
func (t *EndpointTracker) CheckAgentStatusesAndEmitEvents()
```



<a name="EndpointTracker.CheckContainerStatusesAndEmit"></a>
### func \(\*EndpointTracker\) [CheckContainerStatusesAndEmit](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/tracker/endpoint.go#L426>)

```go
func (t *EndpointTracker) CheckContainerStatusesAndEmit()
```



<a name="EndpointTracker.DequeueCommand"></a>
### func \(\*EndpointTracker\) [DequeueCommand](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/tracker/commandQueue.go#L60>)

```go
func (t *EndpointTracker) DequeueCommand(agentID string) *proto.CommandRequest
```



<a name="EndpointTracker.EnqueueCommand"></a>
### func \(\*EndpointTracker\) [EnqueueCommand](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/tracker/commandQueue.go#L33>)

```go
func (t *EndpointTracker) EnqueueCommand(agentID string, cmd *proto.CommandRequest) bool
```



<a name="EndpointTracker.GetAgentMap"></a>
### func \(\*EndpointTracker\) [GetAgentMap](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/tracker/endpoint.go#L298>)

```go
func (t *EndpointTracker) GetAgentMap() map[string]model.Agent
```



<a name="EndpointTracker.GetAgentSession"></a>
### func \(\*EndpointTracker\) [GetAgentSession](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/tracker/session.go#L70>)

```go
func (t *EndpointTracker) GetAgentSession(agentID string) (*LiveAgentSession, bool)
```

GetAgentSession retrieves a live agent session

<a name="EndpointTracker.GetAgents"></a>
### func \(\*EndpointTracker\) [GetAgents](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/tracker/endpoint.go#L265>)

```go
func (t *EndpointTracker) GetAgents() []model.Agent
```



<a name="EndpointTracker.GetEndpointIdByAgentId"></a>
### func \(\*EndpointTracker\) [GetEndpointIdByAgentId](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/tracker/endpoint.go#L519>)

```go
func (t *EndpointTracker) GetEndpointIdByAgentId(agentID string) (string, bool)
```



<a name="EndpointTracker.GetLiveAgentIDs"></a>
### func \(\*EndpointTracker\) [GetLiveAgentIDs](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/tracker/session.go#L93>)

```go
func (t *EndpointTracker) GetLiveAgentIDs() []string
```



<a name="EndpointTracker.HasLiveSession"></a>
### func \(\*EndpointTracker\) [HasLiveSession](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/tracker/session.go#L86>)

```go
func (t *EndpointTracker) HasLiveSession(agentID string) bool
```

HasLiveSession checks if an agent has a live session

<a name="EndpointTracker.IsAgentLive"></a>
### func \(\*EndpointTracker\) [IsAgentLive](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/tracker/endpoint.go#L469>)

```go
func (t *EndpointTracker) IsAgentLive(agentID string) bool
```



<a name="EndpointTracker.IsContainerLive"></a>
### func \(\*EndpointTracker\) [IsContainerLive](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/tracker/endpoint.go#L479>)

```go
func (t *EndpointTracker) IsContainerLive(endpointID string) bool
```



<a name="EndpointTracker.ListEndpoints"></a>
### func \(\*EndpointTracker\) [ListEndpoints](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/tracker/endpoint.go#L489>)

```go
func (t *EndpointTracker) ListEndpoints() []model.Endpoint
```



<a name="EndpointTracker.RegisterAgentSession"></a>
### func \(\*EndpointTracker\) [RegisterAgentSession](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/tracker/session.go#L39>)

```go
func (t *EndpointTracker) RegisterAgentSession(agentID string, client proto.StreamService_StreamServer)
```

RegisterAgentSession registers a live connected agent

<a name="EndpointTracker.RemoveAgentSession"></a>
### func \(\*EndpointTracker\) [RemoveAgentSession](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/tracker/session.go#L79>)

```go
func (t *EndpointTracker) RemoveAgentSession(agentID string)
```

RemoveAgentSession cleans up after disconnect

<a name="EndpointTracker.SyncToStore"></a>
### func \(\*EndpointTracker\) [SyncToStore](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/tracker/endpoint.go#L339>)

```go
func (t *EndpointTracker) SyncToStore(ctx context.Context, store datastore.DataStore)
```



<a name="EndpointTracker.UpdateAgent"></a>
### func \(\*EndpointTracker\) [UpdateAgent](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/tracker/endpoint.go#L82>)

```go
func (t *EndpointTracker) UpdateAgent(meta *model.Meta)
```



<a name="EndpointTracker.UpdateContainer"></a>
### func \(\*EndpointTracker\) [UpdateContainer](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/tracker/endpoint.go#L150>)

```go
func (t *EndpointTracker) UpdateContainer(meta *model.Meta)
```



<a name="LiveAgentSession"></a>
## type [LiveAgentSession](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/tracker/session.go#L31-L36>)



```go
type LiveAgentSession struct {
    Stream        proto.StreamService_StreamServer
    ConnectedAt   time.Time
    LastHeartbeat time.Time
    SendQueue     chan *proto.StreamResponse
}
```

# usermodel

```go
import "github.com/aaronlmathis/gosight-server/internal/usermodel"
```

## Index

- [type Permission](<#Permission>)
- [type Role](<#Role>)
- [type SafeUser](<#SafeUser>)
- [type User](<#User>)


<a name="Permission"></a>
## type [Permission](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/usermodel/user.go#L37-L41>)



```go
type Permission struct {
    ID          string
    Name        string
    Description string
}
```

<a name="Role"></a>
## type [Role](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/usermodel/user.go#L30-L35>)



```go
type Role struct {
    ID          string
    Name        string
    Description string
    Permissions []Permission
}
```

<a name="SafeUser"></a>
## type [SafeUser](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/usermodel/user.go#L23-L28>)



```go
type SafeUser struct {
    Username  string `json:"username"`
    Email     string `json:"email"`
    FirstName string `json:"firstName"`
    LastName  string `json:"lastName"`
}
```

<a name="User"></a>
## type [User](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/usermodel/user.go#L5-L22>)



```go
type User struct {
    ID            string
    Username      string
    Email         string
    PasswordHash  string
    FirstName     string
    LastName      string
    MFAEnabled    bool
    MFAMethod     string // "totp", "webauthn"
    TOTPSecret    string
    WebAuthnCreds []byte
    SSOProvider   string
    SSOID         string
    Roles         []Role
    CreatedAt     time.Time
    LastLogin     time.Time
    Scopes        map[string][]string
}
```

# websocket

```go
import "github.com/aaronlmathis/gosight-server/internal/websocket"
```

server/internal/http/websocket/commandhub.go

## Index

- [type AlertsHub](<#AlertsHub>)
  - [func NewAlertsHub\(metaTracker \*metastore.MetaTracker\) \*AlertsHub](<#NewAlertsHub>)
  - [func \(h \*AlertsHub\) Broadcast\(payload model.AlertInstance\)](<#AlertsHub.Broadcast>)
  - [func \(h \*AlertsHub\) Run\(ctx context.Context\)](<#AlertsHub.Run>)
  - [func \(h \*AlertsHub\) ServeWS\(w http.ResponseWriter, r \*http.Request\)](<#AlertsHub.ServeWS>)
- [type Client](<#Client>)
  - [func \(c \*Client\) Close\(\)](<#Client.Close>)
- [type CommandHub](<#CommandHub>)
  - [func NewCommandHub\(metaTracker \*metastore.MetaTracker\) \*CommandHub](<#NewCommandHub>)
  - [func \(h \*CommandHub\) Broadcast\(result \*model.CommandResult\)](<#CommandHub.Broadcast>)
  - [func \(h \*CommandHub\) Run\(ctx context.Context\)](<#CommandHub.Run>)
  - [func \(h \*CommandHub\) ServeWS\(w http.ResponseWriter, r \*http.Request\)](<#CommandHub.ServeWS>)
- [type EventsHub](<#EventsHub>)
  - [func NewEventsHub\(metaTracker \*metastore.MetaTracker\) \*EventsHub](<#NewEventsHub>)
  - [func \(h \*EventsHub\) Broadcast\(payload model.EventEntry\)](<#EventsHub.Broadcast>)
  - [func \(h \*EventsHub\) Run\(ctx context.Context\)](<#EventsHub.Run>)
  - [func \(h \*EventsHub\) ServeWS\(w http.ResponseWriter, r \*http.Request\)](<#EventsHub.ServeWS>)
- [type HubManager](<#HubManager>)
  - [func NewHubManager\(metaTracker \*metastore.MetaTracker\) \*HubManager](<#NewHubManager>)
  - [func \(h \*HubManager\) StartAll\(ctx context.Context\)](<#HubManager.StartAll>)
- [type LogHub](<#LogHub>)
  - [func NewLogHub\(metaTracker \*metastore.MetaTracker\) \*LogHub](<#NewLogHub>)
  - [func \(h \*LogHub\) Broadcast\(payload model.LogPayload\)](<#LogHub.Broadcast>)
  - [func \(h \*LogHub\) Run\(ctx context.Context\)](<#LogHub.Run>)
  - [func \(h \*LogHub\) ServeWS\(w http.ResponseWriter, r \*http.Request\)](<#LogHub.ServeWS>)
- [type MetricHub](<#MetricHub>)
  - [func NewMetricHub\(metaTracker \*metastore.MetaTracker\) \*MetricHub](<#NewMetricHub>)
  - [func \(h \*MetricHub\) Broadcast\(payload model.MetricPayload\)](<#MetricHub.Broadcast>)
  - [func \(h \*MetricHub\) Run\(ctx context.Context\)](<#MetricHub.Run>)
  - [func \(h \*MetricHub\) ServeWS\(w http.ResponseWriter, r \*http.Request\)](<#MetricHub.ServeWS>)
- [type ProcessHub](<#ProcessHub>)
  - [func NewProcessHub\(metaTracker \*metastore.MetaTracker\) \*ProcessHub](<#NewProcessHub>)
  - [func \(h \*ProcessHub\) Broadcast\(payload model.ProcessPayload\)](<#ProcessHub.Broadcast>)
  - [func \(h \*ProcessHub\) Run\(ctx context.Context\)](<#ProcessHub.Run>)
  - [func \(h \*ProcessHub\) ServeWS\(w http.ResponseWriter, r \*http.Request\)](<#ProcessHub.ServeWS>)


<a name="AlertsHub"></a>
## type [AlertsHub](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/websocket/alerthub.go#L41-L46>)



```go
type AlertsHub struct {
    // contains filtered or unexported fields
}
```

<a name="NewAlertsHub"></a>
### func [NewAlertsHub](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/websocket/alerthub.go#L49>)

```go
func NewAlertsHub(metaTracker *metastore.MetaTracker) *AlertsHub
```

NewAlertsHub creates a new AlertsHub instance.

<a name="AlertsHub.Broadcast"></a>
### func \(\*AlertsHub\) [Broadcast](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/websocket/alerthub.go#L149>)

```go
func (h *AlertsHub) Broadcast(payload model.AlertInstance)
```



<a name="AlertsHub.Run"></a>
### func \(\*AlertsHub\) [Run](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/websocket/alerthub.go#L57>)

```go
func (h *AlertsHub) Run(ctx context.Context)
```



<a name="AlertsHub.ServeWS"></a>
### func \(\*AlertsHub\) [ServeWS](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/websocket/alerthub.go#L92>)

```go
func (h *AlertsHub) ServeWS(w http.ResponseWriter, r *http.Request)
```



<a name="Client"></a>
## type [Client](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/websocket/hub.go#L39-L47>)



```go
type Client struct {
    Conn       *websocket.Conn
    EndpointID string
    AgentID    string
    HostID     string
    Send       chan []byte
    ID         string
    // contains filtered or unexported fields
}
```

<a name="Client.Close"></a>
### func \(\*Client\) [Close](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/websocket/hub.go#L106>)

```go
func (c *Client) Close()
```



<a name="CommandHub"></a>
## type [CommandHub](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/websocket/command.go#L39-L44>)



```go
type CommandHub struct {
    // contains filtered or unexported fields
}
```

<a name="NewCommandHub"></a>
### func [NewCommandHub](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/websocket/command.go#L46>)

```go
func NewCommandHub(metaTracker *metastore.MetaTracker) *CommandHub
```



<a name="CommandHub.Broadcast"></a>
### func \(\*CommandHub\) [Broadcast](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/websocket/command.go#L142>)

```go
func (h *CommandHub) Broadcast(result *model.CommandResult)
```



<a name="CommandHub.Run"></a>
### func \(\*CommandHub\) [Run](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/websocket/command.go#L54>)

```go
func (h *CommandHub) Run(ctx context.Context)
```



<a name="CommandHub.ServeWS"></a>
### func \(\*CommandHub\) [ServeWS](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/websocket/command.go#L89>)

```go
func (h *CommandHub) ServeWS(w http.ResponseWriter, r *http.Request)
```



<a name="EventsHub"></a>
## type [EventsHub](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/websocket/eventhub.go#L41-L46>)



```go
type EventsHub struct {
    // contains filtered or unexported fields
}
```

<a name="NewEventsHub"></a>
### func [NewEventsHub](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/websocket/eventhub.go#L48>)

```go
func NewEventsHub(metaTracker *metastore.MetaTracker) *EventsHub
```



<a name="EventsHub.Broadcast"></a>
### func \(\*EventsHub\) [Broadcast](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/websocket/eventhub.go#L157>)

```go
func (h *EventsHub) Broadcast(payload model.EventEntry)
```



<a name="EventsHub.Run"></a>
### func \(\*EventsHub\) [Run](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/websocket/eventhub.go#L56>)

```go
func (h *EventsHub) Run(ctx context.Context)
```



<a name="EventsHub.ServeWS"></a>
### func \(\*EventsHub\) [ServeWS](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/websocket/eventhub.go#L97>)

```go
func (h *EventsHub) ServeWS(w http.ResponseWriter, r *http.Request)
```



<a name="HubManager"></a>
## type [HubManager](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/websocket/hub.go#L49-L56>)



```go
type HubManager struct {
    Metrics   *MetricHub
    Logs      *LogHub
    Alerts    *AlertsHub
    Events    *EventsHub
    Commands  *CommandHub
    Processes *ProcessHub
}
```

<a name="NewHubManager"></a>
### func [NewHubManager](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/websocket/hub.go#L59>)

```go
func NewHubManager(metaTracker *metastore.MetaTracker) *HubManager
```

NewHubManager creates a new HubManager with initialized hubs.

<a name="HubManager.StartAll"></a>
### func \(\*HubManager\) [StartAll](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/websocket/hub.go#L71>)

```go
func (h *HubManager) StartAll(ctx context.Context)
```

StartAll starts all hubs in separate goroutines.

<a name="LogHub"></a>
## type [LogHub](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/websocket/loghub.go#L42-L47>)



```go
type LogHub struct {
    // contains filtered or unexported fields
}
```

<a name="NewLogHub"></a>
### func [NewLogHub](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/websocket/loghub.go#L49>)

```go
func NewLogHub(metaTracker *metastore.MetaTracker) *LogHub
```



<a name="LogHub.Broadcast"></a>
### func \(\*LogHub\) [Broadcast](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/websocket/loghub.go#L158>)

```go
func (h *LogHub) Broadcast(payload model.LogPayload)
```



<a name="LogHub.Run"></a>
### func \(\*LogHub\) [Run](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/websocket/loghub.go#L57>)

```go
func (h *LogHub) Run(ctx context.Context)
```



<a name="LogHub.ServeWS"></a>
### func \(\*LogHub\) [ServeWS](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/websocket/loghub.go#L99>)

```go
func (h *LogHub) ServeWS(w http.ResponseWriter, r *http.Request)
```



<a name="MetricHub"></a>
## type [MetricHub](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/websocket/metrichub.go#L42-L47>)



```go
type MetricHub struct {
    // contains filtered or unexported fields
}
```

<a name="NewMetricHub"></a>
### func [NewMetricHub](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/websocket/metrichub.go#L49>)

```go
func NewMetricHub(metaTracker *metastore.MetaTracker) *MetricHub
```



<a name="MetricHub.Broadcast"></a>
### func \(\*MetricHub\) [Broadcast](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/websocket/metrichub.go#L160>)

```go
func (h *MetricHub) Broadcast(payload model.MetricPayload)
```

Broadcast sends a pre\-serialized metric payload to all MetricHub clients.

<a name="MetricHub.Run"></a>
### func \(\*MetricHub\) [Run](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/websocket/metrichub.go#L58>)

```go
func (h *MetricHub) Run(ctx context.Context)
```

Run starts the MetricHub's broadcast loop.

<a name="MetricHub.ServeWS"></a>
### func \(\*MetricHub\) [ServeWS](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/websocket/metrichub.go#L100>)

```go
func (h *MetricHub) ServeWS(w http.ResponseWriter, r *http.Request)
```

ServeWS upgrades HTTP to WebSocket and registers client to MetricHub.

<a name="ProcessHub"></a>
## type [ProcessHub](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/websocket/processhub.go#L41-L46>)



```go
type ProcessHub struct {
    // contains filtered or unexported fields
}
```

<a name="NewProcessHub"></a>
### func [NewProcessHub](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/websocket/processhub.go#L48>)

```go
func NewProcessHub(metaTracker *metastore.MetaTracker) *ProcessHub
```



<a name="ProcessHub.Broadcast"></a>
### func \(\*ProcessHub\) [Broadcast](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/websocket/processhub.go#L158>)

```go
func (h *ProcessHub) Broadcast(payload model.ProcessPayload)
```

Broadcast sends a pre\-serialized metric payload to all ProcessHub clients.

<a name="ProcessHub.Run"></a>
### func \(\*ProcessHub\) [Run](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/websocket/processhub.go#L57>)

```go
func (h *ProcessHub) Run(ctx context.Context)
```

Run starts the ProcessHub's broadcast loop.

<a name="ProcessHub.ServeWS"></a>
### func \(\*ProcessHub\) [ServeWS](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/websocket/processhub.go#L98>)

```go
func (h *ProcessHub) ServeWS(w http.ResponseWriter, r *http.Request)
```

ServeWS upgrades HTTP to WebSocket and registers client to ProcessHub.

# gosightauth

```go
import "github.com/aaronlmathis/gosight-server/internal/auth/webauthn"
```

## Index



# gosighttemplate

```go
import "github.com/aaronlmathis/gosight-server/internal/http/templates"
```

## Index

- [Variables](<#variables>)
- [func Div\(a, b float64\) float64](<#Div>)
- [func FlattenInstant\(rows \[\]model.MetricRow\) map\[string\]float64](<#FlattenInstant>)
- [func FlattenRange\(rows \[\]model.MetricRow\) map\[string\]\[\]model.MetricPoint](<#FlattenRange>)
- [func FormatUptime\(seconds float64\) string](<#FormatUptime>)
- [func GetMetricNames\(metrics \[\]model.MetricSelector, instantOnly bool\) \[\]string](<#GetMetricNames>)
- [func HasPermission\(userPermissions \[\]string, permission string\) bool](<#HasPermission>)
- [func HasPrefix\(s, prefix string\) bool](<#HasPrefix>)
- [func HumanizeBytes\(b float64\) string](<#HumanizeBytes>)
- [func Marshal\(v interface\{\}\) template.JS](<#Marshal>)
- [func SafeHTML\(s string\) template.HTML](<#SafeHTML>)
- [func Seq\(from, to int\) \[\]int](<#Seq>)
- [func Since\(ts string\) string](<#Since>)
- [type Breadcrumb](<#Breadcrumb>)
- [type GoSightTemplate](<#GoSightTemplate>)
  - [func NewGoSightTemplate\(ctx context.Context, cfg \*config.Config, metricStore metricstore.MetricStore, metricIndex \*metricindex.MetricIndex, userStore userstore.UserStore\) \(\*GoSightTemplate, error\)](<#NewGoSightTemplate>)
  - [func \(t \*GoSightTemplate\) BuildPageData\(user \*usermodel.User, breadcrumbs, labels map\[string\]string, path, title string, meta \*model.Meta, permissions \[\]string\) \*TemplateData](<#GoSightTemplate.BuildPageData>)
  - [func \(t \*GoSightTemplate\) RenderTemplate\(w http.ResponseWriter, layout, page string, data any\) error](<#GoSightTemplate.RenderTemplate>)
- [type TemplateData](<#TemplateData>)


## Variables

<a name="ContainerMetrics"></a>

```go
var ContainerMetrics = []model.MetricSelector{
    {Name: "container.podman.uptime_seconds", Namespace: "Container", SubNamespace: "Container.Podman", Instant: true},
    {Name: "container.podman.running", Namespace: "Container", SubNamespace: "Container.Podman", Instant: true},
    {Name: "container.podman.cpu_percent", Namespace: "Container", SubNamespace: "Container.Podman", Instant: true},
    {Name: "container.podman.mem_usage_bytes", Namespace: "Container", SubNamespace: "Container.Podman", Instant: true},
    {Name: "container.podman.mem_limit_bytes", Namespace: "Container", SubNamespace: "Container.Podman", Instant: true},
    {Name: "container.podman.net_rx_bytes", Namespace: "Container", SubNamespace: "Container.Podman", Instant: true},
    {Name: "container.podman.net_tx_bytes", Namespace: "Container", SubNamespace: "Container.Podman", Instant: true},
}
```

<a name="HostMetrics"></a>

```go
var HostMetrics = []model.MetricSelector{
    {Name: "system.cpu.count_physical", Namespace: "System", SubNamespace: "System.CPU", Instant: true},
    {Name: "system.cpu.usage_percent", Namespace: "System", SubNamespace: "System.CPU", Instant: true},
    {Name: "system.cpu.time_user", Namespace: "System", SubNamespace: "System.CPU", Instant: false},
    {Name: "system.cpu.time_system", Namespace: "System", SubNamespace: "System.CPU", Instant: false},
    {Name: "system.cpu.time_idle", Namespace: "System", SubNamespace: "System.CPU", Instant: false},
    {Name: "system.cpu.time_nice", Namespace: "System", SubNamespace: "System.CPU", Instant: false},
    {Name: "system.cpu.time_guest", Namespace: "System", SubNamespace: "System.CPU", Instant: false},
    {Name: "system.cpu.time_guest_nice", Namespace: "System", SubNamespace: "System.CPU", Instant: false},
    {Name: "system.cpu.time_iowait", Namespace: "System", SubNamespace: "System.CPU", Instant: false},
    {Name: "system.cpu.time_irq", Namespace: "System", SubNamespace: "System.CPU", Instant: false},
    {Name: "system.cpu.time_softirq", Namespace: "System", SubNamespace: "System.CPU", Instant: false},
    {Name: "system.cpu.time_steal", Namespace: "System", SubNamespace: "System.CPU", Instant: false},
    {Name: "system.cpu.clock_mhz", Namespace: "System", SubNamespace: "System.CPU", Instant: true},
    {Name: "system.cpu.count_logical", Namespace: "System", SubNamespace: "System.CPU", Instant: true},

    {Name: "system.memory.available", Namespace: "System", SubNamespace: "System.Memory", Instant: true},
    {Name: "system.memory.used", Namespace: "System", SubNamespace: "System.Memory", Instant: true},
    {Name: "system.memory.used_percent", Namespace: "System", SubNamespace: "System.Memory", Instant: false},
    {Name: "system.memory.total", Namespace: "System", SubNamespace: "System.Memory", Instant: true},

    {Name: "system.host.procs", Namespace: "System", SubNamespace: "System.Host", Instant: true},
    {Name: "system.host.users_loggedin", Namespace: "System", SubNamespace: "System.Host", Instant: true},
    {Name: "system.host.info", Namespace: "System", SubNamespace: "System.Host", Instant: true},
    {Name: "system.host.uptime", Namespace: "System", SubNamespace: "System.Host", Instant: true},

    {Name: "system.diskio.read_bytes", Namespace: "System", SubNamespace: "System.DiskIO", Instant: false},
    {Name: "system.diskio.read_time", Namespace: "System", SubNamespace: "System.DiskIO", Instant: false},
    {Name: "system.diskio.write_time", Namespace: "System", SubNamespace: "System.DiskIO", Instant: false},
    {Name: "system.diskio.merged_read_count", Namespace: "System", SubNamespace: "System.DiskIO", Instant: false},
    {Name: "system.diskio.merged_write_count", Namespace: "System", SubNamespace: "System.DiskIO", Instant: false},
    {Name: "system.diskio.weighted_io", Namespace: "System", SubNamespace: "System.DiskIO", Instant: false},
    {Name: "system.diskio.read_count", Namespace: "System", SubNamespace: "System.DiskIO", Instant: false},
    {Name: "system.diskio.write_count", Namespace: "System", SubNamespace: "System.DiskIO", Instant: false},
    {Name: "system.diskio.write_bytes", Namespace: "System", SubNamespace: "System.DiskIO", Instant: false},
    {Name: "system.diskio.io_time", Namespace: "System", SubNamespace: "System.DiskIO", Instant: false},

    {Name: "system.disk.used_percent", Namespace: "System", SubNamespace: "System.Disk", Instant: false},
    {Name: "system.disk.inodes_total", Namespace: "System", SubNamespace: "System.Disk", Instant: true},
    {Name: "system.disk.total", Namespace: "System", SubNamespace: "System.Disk", Instant: true},
    {Name: "system.disk.used", Namespace: "System", SubNamespace: "System.Disk", Instant: true},
    {Name: "system.disk.inodes_used", Namespace: "System", SubNamespace: "System.Disk", Instant: true},
    {Name: "system.disk.inodes_free", Namespace: "System", SubNamespace: "System.Disk", Instant: true},
    {Name: "system.disk.inodes_used_percent", Namespace: "System", SubNamespace: "System.Disk", Instant: false},
    {Name: "system.disk.free", Namespace: "System", SubNamespace: "System.Disk", Instant: true},

    {Name: "system.network.packets_recv", Namespace: "System", SubNamespace: "System.Network", Instant: false},
    {Name: "system.network.err_in", Namespace: "System", SubNamespace: "System.Network", Instant: false},
    {Name: "system.network.err_out", Namespace: "System", SubNamespace: "System.Network", Instant: false},
    {Name: "system.network.bytes_sent", Namespace: "System", SubNamespace: "System.Network", Instant: false},
    {Name: "system.network.bytes_recv", Namespace: "System", SubNamespace: "System.Network", Instant: false},
    {Name: "system.network.packets_sent", Namespace: "System", SubNamespace: "System.Network", Instant: false},
}
```

<a name="Div"></a>
## func [Div](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/http/templates/helpers.go#L82>)

```go
func Div(a, b float64) float64
```

Div performs safe division, returning 0 if the divisor is zero.

<a name="FlattenInstant"></a>
## func [FlattenInstant](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/http/templates/metrics.go#L93>)

```go
func FlattenInstant(rows []model.MetricRow) map[string]float64
```

FlattenInstant flattens the MetricRows returned by store and makes it usable for template

<a name="FlattenRange"></a>
## func [FlattenRange](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/http/templates/metrics.go#L103>)

```go
func FlattenRange(rows []model.MetricRow) map[string][]model.MetricPoint
```



<a name="FormatUptime"></a>
## func [FormatUptime](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/http/templates/helpers.go#L63>)

```go
func FormatUptime(seconds float64) string
```



<a name="GetMetricNames"></a>
## func [GetMetricNames](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/http/templates/metrics.go#L123>)

```go
func GetMetricNames(metrics []model.MetricSelector, instantOnly bool) []string
```



<a name="HasPermission"></a>
## func [HasPermission](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/http/templates/helpers.go#L109>)

```go
func HasPermission(userPermissions []string, permission string) bool
```

HasPermission checks if a user has a specific permission.

<a name="HasPrefix"></a>
## func [HasPrefix](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/http/templates/helpers.go#L118>)

```go
func HasPrefix(s, prefix string) bool
```



<a name="HumanizeBytes"></a>
## func [HumanizeBytes](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/http/templates/helpers.go#L34>)

```go
func HumanizeBytes(b float64) string
```

HumanizeBytes converts a byte size in bytes to a human\-readable string.

<a name="Marshal"></a>
## func [Marshal](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/http/templates/helpers.go#L53>)

```go
func Marshal(v interface{}) template.JS
```

Marshal converts a Go value to a JSON string and returns it as a template.JS type.

<a name="SafeHTML"></a>
## func [SafeHTML](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/http/templates/helpers.go#L106>)

```go
func SafeHTML(s string) template.HTML
```

SafeHTML returns a template.HTML type to safely render HTML content.

<a name="Seq"></a>
## func [Seq](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/http/templates/helpers.go#L73>)

```go
func Seq(from, to int) []int
```

Seq generates a slice of integers from \`from\` to \`to\`, inclusive.

<a name="Since"></a>
## func [Since](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/http/templates/helpers.go#L90>)

```go
func Since(ts string) string
```

Since calculates the time duration since a given timestamp in seconds.

<a name="Breadcrumb"></a>
## type [Breadcrumb](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/http/templates/template.go#L76-L79>)

Breadcrumb represents a single breadcrumb in the navigation trail.

```go
type Breadcrumb struct {
    Label string
    URL   string
}
```

<a name="GoSightTemplate"></a>
## type [GoSightTemplate](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/http/templates/template.go#L49-L58>)



```go
type GoSightTemplate struct {
    Cfg *config.Config

    Tmpl *template.Template

    MetricStore metricstore.MetricStore
    MetricIndex *metricindex.MetricIndex
    UserStore   userstore.UserStore
    // contains filtered or unexported fields
}
```

<a name="NewGoSightTemplate"></a>
### func [NewGoSightTemplate](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/http/templates/template.go#L83-L88>)

```go
func NewGoSightTemplate(ctx context.Context, cfg *config.Config, metricStore metricstore.MetricStore, metricIndex *metricindex.MetricIndex, userStore userstore.UserStore) (*GoSightTemplate, error)
```



<a name="GoSightTemplate.BuildPageData"></a>
### func \(\*GoSightTemplate\) [BuildPageData](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/http/templates/template.go#L197-L198>)

```go
func (t *GoSightTemplate) BuildPageData(user *usermodel.User, breadcrumbs, labels map[string]string, path, title string, meta *model.Meta, permissions []string) *TemplateData
```

BuildPageData constructs the TemplateData for rendering a page.

<a name="GoSightTemplate.RenderTemplate"></a>
### func \(\*GoSightTemplate\) [RenderTemplate](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/http/templates/template.go#L244>)

```go
func (t *GoSightTemplate) RenderTemplate(w http.ResponseWriter, layout, page string, data any) error
```

RenderTemplate renders a template with the given layout and page, passing in the provided data.

<a name="TemplateData"></a>
## type [TemplateData](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/http/templates/template.go#L61-L73>)

TemplateData holds the data passed to templates for rendering.

```go
type TemplateData struct {
    Title       string
    User        *usermodel.User
    UserData    usermodel.SafeUser
    Permissions []string
    Metrics     map[string]float64 // TODO: Revaluate need.
    Timeseries  map[string][]model.MetricPoint
    Tags        map[string]string
    Labels      map[string]string
    Meta        *model.Meta
    Breadcrumbs []Breadcrumb
    CurrentPath string
}
```

# alertstore

```go
import "github.com/aaronlmathis/gosight-server/internal/store/alertstore"
```

## Index

- [type AlertStore](<#AlertStore>)


<a name="AlertStore"></a>
## type [AlertStore](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/store/alertstore/alertstore.go#L37-L46>)



```go
type AlertStore interface {
    UpsertAlert(ctx context.Context, a *model.AlertInstance) error
    ResolveAlert(ctx context.Context, ruleID, target string, resolvedAt time.Time) error
    ListAlerts(ctx context.Context) ([]model.AlertInstance, error)
    ListActiveAlerts(ctx context.Context) ([]model.AlertInstance, error)
    ListAlertHistory(ctx context.Context, since time.Time) ([]model.AlertInstance, error)
    ListAlertsFiltered(ctx context.Context, q model.AlertQuery) ([]model.AlertInstance, error)
    CountAlertsFiltered(ctx context.Context, q model.AlertQuery) (int, error)
    GetByID(ctx context.Context, id string) (model.AlertInstance, error)
}
```

# datastore

```go
import "github.com/aaronlmathis/gosight-server/internal/store/datastore"
```

## Index

- [type DataStore](<#DataStore>)


<a name="DataStore"></a>
## type [DataStore](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/store/datastore/datastore.go#L33-L66>)



```go
type DataStore interface {
    // Satisfy Buffered Data Store interface
    Write(ctx context.Context, batches []*model.ProcessPayload) error

    // Agent methods
    UpsertAgent(ctx context.Context, agent *model.Agent) error
    GetAgentByHostname(ctx context.Context, hostname string) (*model.Agent, error)
    GetAgentByID(ctx context.Context, id string) (*model.Agent, error)
    ListAgents(ctx context.Context) ([]*model.Agent, error)

    // Container methods
    UpsertContainer(ctx context.Context, container *model.Container) error
    GetContainerByID(ctx context.Context, id string) (*model.Container, error)
    ListContainers(ctx context.Context) ([]*model.Container, error)

    // Tag methods
    GetTags(ctx context.Context, endpointID string) (map[string]string, error)
    SetTags(ctx context.Context, endpointID string, tags map[string]string) error
    DeleteTag(ctx context.Context, endpointID, key string) error
    ListTags(ctx context.Context, endpointID string) (map[string]string, error)
    GetAllTags(ctx context.Context) ([]model.Tag, error)

    ListKeys(ctx context.Context) ([]string, error)
    ListValues(ctx context.Context, key string) ([]string, error)

    // Process methods
    InsertFullProcessPayload(ctx context.Context, payload *model.ProcessPayload) error
    InsertProcessSnapshot(ctx context.Context, snap *model.ProcessPayload) (int64, error)
    InsertProcessInfos(ctx context.Context, snapshotID int64, payload *model.ProcessPayload) error
    QueryProcessInfos(ctx context.Context, filter *model.ProcessQueryFilter) ([]model.ProcessInfo, error)

    // Lifecycle
    Close() error
}
```

# eventstore

```go
import "github.com/aaronlmathis/gosight-server/internal/store/eventstore"
```

## Index

- [type EventStore](<#EventStore>)
- [type JSONEventStore](<#JSONEventStore>)
  - [func NewJSONEventStore\(path string\) \(\*JSONEventStore, error\)](<#NewJSONEventStore>)
  - [func \(s \*JSONEventStore\) AddEvent\(ctx context.Context, e model.EventEntry\) error](<#JSONEventStore.AddEvent>)
  - [func \(s \*JSONEventStore\) GetByID\(ctx context.Context, id string\) \(model.EventEntry, error\)](<#JSONEventStore.GetByID>)
  - [func \(s \*JSONEventStore\) GetRecentEvents\(ctx context.Context, filter model.EventFilter\) \(\[\]model.EventEntry, error\)](<#JSONEventStore.GetRecentEvents>)


<a name="EventStore"></a>
## type [EventStore](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/store/eventstore/eventstore.go#L39-L42>)



```go
type EventStore interface {
    AddEvent(ctx context.Context, e model.EventEntry) error
    GetRecentEvents(ctx context.Context, filter model.EventFilter) ([]model.EventEntry, error)
}
```

<a name="JSONEventStore"></a>
## type [JSONEventStore](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/store/eventstore/json.go#L21-L25>)



```go
type JSONEventStore struct {
    // contains filtered or unexported fields
}
```

<a name="NewJSONEventStore"></a>
### func [NewJSONEventStore](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/store/eventstore/json.go#L30>)

```go
func NewJSONEventStore(path string) (*JSONEventStore, error)
```

NewJSONEventStore creates a new JSONEventStore instance. It takes a file path as an argument and loads the events from the file. If the file does not exist, it creates a new one.

<a name="JSONEventStore.AddEvent"></a>
### func \(\*JSONEventStore\) [AddEvent](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/store/eventstore/json.go#L76>)

```go
func (s *JSONEventStore) AddEvent(ctx context.Context, e model.EventEntry) error
```

AddEvent adds a new event to the store. It appends the event to the data slice and saves the updated slice to the file.

<a name="JSONEventStore.GetByID"></a>
### func \(\*JSONEventStore\) [GetByID](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/store/eventstore/json.go#L41>)

```go
func (s *JSONEventStore) GetByID(ctx context.Context, id string) (model.EventEntry, error)
```

GetByID retrieves an event by its ID.

<a name="JSONEventStore.GetRecentEvents"></a>
### func \(\*JSONEventStore\) [GetRecentEvents](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/store/eventstore/json.go#L93>)

```go
func (s *JSONEventStore) GetRecentEvents(ctx context.Context, filter model.EventFilter) ([]model.EventEntry, error)
```

QueryEvents retrieves events from the store based on the provided filter. It iterates through the data slice in reverse order and applies the filter criteria. The results are returned as a slice of EventEntry structs. The filter can include various criteria such as level, type, category, source, scope, target, and time range. QueryEvents retrieves events from the store based on the provided filter. It applies the filter criteria and returns a slice of EventEntry structs.

# logstore

```go
import "github.com/aaronlmathis/gosight-server/internal/store/logstore"
```

## Index

- [type LogStore](<#LogStore>)
  - [func InitLogStore\(ctx context.Context, cfg \*config.Config, logCache cache.LogCache\) \(LogStore, error\)](<#InitLogStore>)


<a name="LogStore"></a>
## type [LogStore](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/store/logstore/logstore.go#L31-L36>)



```go
type LogStore interface {
    Name() string
    Write(metrics []model.LogPayload) error
    Close() error
    GetLogs(filter model.LogFilter) ([]model.LogEntry, error)
}
```

<a name="InitLogStore"></a>
### func [InitLogStore](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/store/logstore/registery.go#L15>)

```go
func InitLogStore(ctx context.Context, cfg *config.Config, logCache cache.LogCache) (LogStore, error)
```



# metastore

```go
import "github.com/aaronlmathis/gosight-server/internal/store/metastore"
```

## Index

- [type MetaTracker](<#MetaTracker>)
  - [func NewMetaTracker\(\) \*MetaTracker](<#NewMetaTracker>)
  - [func \(m \*MetaTracker\) Get\(endpointID string\) \(model.Meta, bool\)](<#MetaTracker.Get>)
  - [func \(m \*MetaTracker\) Set\(endpointID string, meta model.Meta\)](<#MetaTracker.Set>)


<a name="MetaTracker"></a>
## type [MetaTracker](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/store/metastore/metastore.go#L9-L12>)



```go
type MetaTracker struct {
    // contains filtered or unexported fields
}
```

<a name="NewMetaTracker"></a>
### func [NewMetaTracker](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/store/metastore/metastore.go#L14>)

```go
func NewMetaTracker() *MetaTracker
```



<a name="MetaTracker.Get"></a>
### func \(\*MetaTracker\) [Get](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/store/metastore/metastore.go#L26>)

```go
func (m *MetaTracker) Get(endpointID string) (model.Meta, bool)
```



<a name="MetaTracker.Set"></a>
### func \(\*MetaTracker\) [Set](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/store/metastore/metastore.go#L20>)

```go
func (m *MetaTracker) Set(endpointID string, meta model.Meta)
```



# metricindex

```go
import "github.com/aaronlmathis/gosight-server/internal/store/metricindex"
```

## Index

- [type MetricIndex](<#MetricIndex>)
  - [func NewMetricIndex\(\) \*MetricIndex](<#NewMetricIndex>)
  - [func \(idx \*MetricIndex\) Add\(namespace, sub, name string, dims map\[string\]string\)](<#MetricIndex.Add>)
  - [func \(idx \*MetricIndex\) FilterMetricNames\(filters map\[string\]string\) \[\]string](<#MetricIndex.FilterMetricNames>)
  - [func \(idx \*MetricIndex\) GetAllMetricNames\(\) \[\]string](<#MetricIndex.GetAllMetricNames>)
  - [func \(idx \*MetricIndex\) GetDimensions\(\) map\[string\]\[\]string](<#MetricIndex.GetDimensions>)
  - [func \(idx \*MetricIndex\) GetDimensionsForMetric\(fullMetric string\) \(\[\]string, error\)](<#MetricIndex.GetDimensionsForMetric>)
  - [func \(idx \*MetricIndex\) GetLabelValues\(label, contains string\) \[\]string](<#MetricIndex.GetLabelValues>)
  - [func \(idx \*MetricIndex\) GetMetricNames\(ns, sub string\) \[\]string](<#MetricIndex.GetMetricNames>)
  - [func \(idx \*MetricIndex\) GetNamespaces\(\) \[\]string](<#MetricIndex.GetNamespaces>)
  - [func \(idx \*MetricIndex\) GetSubNamespaces\(ns string\) \[\]string](<#MetricIndex.GetSubNamespaces>)
  - [func \(idx \*MetricIndex\) ListLabelValues\(key, contains string\) \[\]string](<#MetricIndex.ListLabelValues>)


<a name="MetricIndex"></a>
## type [MetricIndex](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/store/metricindex/metricIndex.go#L37-L45>)



```go
type MetricIndex struct {
    Namespaces       map[string]struct{}
    SubNamespaces    map[string]map[string]struct{}            // namespace  subnamespace
    MetricNames      map[string]map[string]map[string]struct{} // ns  sub  metric names
    Dimensions       map[string]map[string]struct{}            // dim key  value set
    MetricDimensions map[string]map[string]string              // metricFullName  dim key  value
    LabelValues      map[string]map[string]struct{}
    // contains filtered or unexported fields
}
```

<a name="NewMetricIndex"></a>
### func [NewMetricIndex](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/store/metricindex/metricIndex.go#L47>)

```go
func NewMetricIndex() *MetricIndex
```



<a name="MetricIndex.Add"></a>
### func \(\*MetricIndex\) [Add](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/store/metricindex/metricIndex.go#L58>)

```go
func (idx *MetricIndex) Add(namespace, sub, name string, dims map[string]string)
```



<a name="MetricIndex.FilterMetricNames"></a>
### func \(\*MetricIndex\) [FilterMetricNames](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/store/metricindex/metricIndex.go#L211>)

```go
func (idx *MetricIndex) FilterMetricNames(filters map[string]string) []string
```

FilterMetricNames returns all metric names that match given label filters

<a name="MetricIndex.GetAllMetricNames"></a>
### func \(\*MetricIndex\) [GetAllMetricNames](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/store/metricindex/metricIndex.go#L126>)

```go
func (idx *MetricIndex) GetAllMetricNames() []string
```



<a name="MetricIndex.GetDimensions"></a>
### func \(\*MetricIndex\) [GetDimensions](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/store/metricindex/metricIndex.go#L159>)

```go
func (idx *MetricIndex) GetDimensions() map[string][]string
```



<a name="MetricIndex.GetDimensionsForMetric"></a>
### func \(\*MetricIndex\) [GetDimensionsForMetric](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/store/metricindex/metricIndex.go#L171>)

```go
func (idx *MetricIndex) GetDimensionsForMetric(fullMetric string) ([]string, error)
```



<a name="MetricIndex.GetLabelValues"></a>
### func \(\*MetricIndex\) [GetLabelValues](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/store/metricindex/metricIndex.go#L188>)

```go
func (idx *MetricIndex) GetLabelValues(label, contains string) []string
```



<a name="MetricIndex.GetMetricNames"></a>
### func \(\*MetricIndex\) [GetMetricNames](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/store/metricindex/metricIndex.go#L145>)

```go
func (idx *MetricIndex) GetMetricNames(ns, sub string) []string
```



<a name="MetricIndex.GetNamespaces"></a>
### func \(\*MetricIndex\) [GetNamespaces](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/store/metricindex/metricIndex.go#L102>)

```go
func (idx *MetricIndex) GetNamespaces() []string
```



<a name="MetricIndex.GetSubNamespaces"></a>
### func \(\*MetricIndex\) [GetSubNamespaces](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/store/metricindex/metricIndex.go#L112>)

```go
func (idx *MetricIndex) GetSubNamespaces(ns string) []string
```



<a name="MetricIndex.ListLabelValues"></a>
### func \(\*MetricIndex\) [ListLabelValues](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/store/metricindex/metricIndex.go#L253>)

```go
func (idx *MetricIndex) ListLabelValues(key, contains string) []string
```

ListLabelValues returns all known values for a given label key \(optionally filtered\)

# metricstore

```go
import "github.com/aaronlmathis/gosight-server/internal/store/metricstore"
```

## Index

- [type MetricStore](<#MetricStore>)
  - [func InitMetricStore\(ctx context.Context, cfg \*config.Config, metricCache cache.MetricCache\) \(MetricStore, error\)](<#InitMetricStore>)


<a name="MetricStore"></a>
## type [MetricStore](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/store/metricstore/store.go#L36-L46>)



```go
type MetricStore interface {
    Write(batch []model.MetricPayload) error
    Close() error

    QueryInstant(metric string, filters map[string]string) ([]model.MetricRow, error)
    QueryRange(metric string, start, end time.Time, step string, filters map[string]string) ([]model.Point, error)
    QueryMultiInstant(metricNames []string, filters map[string]string) ([]model.MetricRow, error)
    QueryMultiRange(metrics []string, start, end time.Time, step string, filters map[string]string) ([]model.MetricRow, error)
    FetchDimensionsForMetric(metric string) ([]string, error)
    ListLabelValues(label string, contains string) ([]string, error)
}
```

<a name="InitMetricStore"></a>
### func [InitMetricStore](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/store/metricstore/registry.go#L38>)

```go
func InitMetricStore(ctx context.Context, cfg *config.Config, metricCache cache.MetricCache) (MetricStore, error)
```



# routestore

```go
import "github.com/aaronlmathis/gosight-server/internal/store/routestore"
```

SPDX\-License\-Identifier: GPL\-3.0\-or\-later

Copyright \(C\) 2025 Aaron Mathis aaron.mathis@gmail.com

This file is part of GoSight.

GoSight is free software: you can redistribute it and/or modify it under the terms of the GNU General Public License as published by the Free Software Foundation, either version 3 of the License, or \(at your option\) any later version.

GoSight is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for more details.

You should have received a copy of the GNU General Public License along with GoSight. If not, see https://www.gnu.org/licenses/.

Package routestore provides functionality to load and manage action routes

## Index

- [type RouteStore](<#RouteStore>)
  - [func NewRouteStore\(path string\) \(\*RouteStore, error\)](<#NewRouteStore>)
  - [func \(rs \*RouteStore\) BuildMap\(\) map\[string\]model.ActionRoute](<#RouteStore.BuildMap>)


<a name="RouteStore"></a>
## type [RouteStore](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/store/routestore/loader.go#L32-L34>)

RouteStore is a structure that holds a list of action routes.

```go
type RouteStore struct {
    Routes []model.ActionRoute
}
```

<a name="NewRouteStore"></a>
### func [NewRouteStore](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/store/routestore/loader.go#L37>)

```go
func NewRouteStore(path string) (*RouteStore, error)
```

LoadRoutesFromFile loads action routes from a YAML file.

<a name="RouteStore.BuildMap"></a>
### func \(\*RouteStore\) [BuildMap](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/store/routestore/loader.go#L51>)

```go
func (rs *RouteStore) BuildMap() map[string]model.ActionRoute
```



# rulestore

```go
import "github.com/aaronlmathis/gosight-server/internal/store/rulestore"
```

## Index

- [type JSONRuleStore](<#JSONRuleStore>)
  - [func NewJSONStore\(path string\) \(\*JSONRuleStore, error\)](<#NewJSONStore>)
  - [func \(j \*JSONRuleStore\) AddRule\(ctx context.Context, r model.AlertRule\) error](<#JSONRuleStore.AddRule>)
  - [func \(j \*JSONRuleStore\) DeleteRule\(ctx context.Context, id string\) error](<#JSONRuleStore.DeleteRule>)
  - [func \(j \*JSONRuleStore\) GetActiveRules\(ctx context.Context\) \(\[\]model.AlertRule, error\)](<#JSONRuleStore.GetActiveRules>)
  - [func \(s \*JSONRuleStore\) GetRuleByID\(ctx context.Context, id string\) \(model.AlertRule, error\)](<#JSONRuleStore.GetRuleByID>)
  - [func \(s \*JSONRuleStore\) GetRuleByName\(ctx context.Context, name string\) \(model.AlertRule, error\)](<#JSONRuleStore.GetRuleByName>)
  - [func \(j \*JSONRuleStore\) ListRules\(ctx context.Context\) \(\[\]model.AlertRule, error\)](<#JSONRuleStore.ListRules>)
  - [func \(j \*JSONRuleStore\) UpdateRule\(ctx context.Context, r model.AlertRule\) error](<#JSONRuleStore.UpdateRule>)
- [type MemoryRuleStore](<#MemoryRuleStore>)
  - [func NewMemoryStore\(\) \*MemoryRuleStore](<#NewMemoryStore>)
  - [func \(s \*MemoryRuleStore\) AddRule\(ctx context.Context, r model.AlertRule\) error](<#MemoryRuleStore.AddRule>)
  - [func \(s \*MemoryRuleStore\) DeleteRule\(ctx context.Context, id string\) error](<#MemoryRuleStore.DeleteRule>)
  - [func \(s \*MemoryRuleStore\) GetActiveRules\(ctx context.Context\) \(\[\]model.AlertRule, error\)](<#MemoryRuleStore.GetActiveRules>)
  - [func \(s \*MemoryRuleStore\) ListRules\(ctx context.Context\) \(\[\]model.AlertRule, error\)](<#MemoryRuleStore.ListRules>)
  - [func \(s \*MemoryRuleStore\) UpdateRule\(ctx context.Context, r model.AlertRule\) error](<#MemoryRuleStore.UpdateRule>)
- [type RuleStore](<#RuleStore>)
- [type YAMLRuleStore](<#YAMLRuleStore>)
  - [func NewYAMLStore\(path string\) \(\*YAMLRuleStore, error\)](<#NewYAMLStore>)
  - [func \(s \*YAMLRuleStore\) AddRule\(ctx context.Context, r model.AlertRule\) error](<#YAMLRuleStore.AddRule>)
  - [func \(s \*YAMLRuleStore\) DeleteRule\(ctx context.Context, id string\) error](<#YAMLRuleStore.DeleteRule>)
  - [func \(s \*YAMLRuleStore\) GetActiveRules\(ctx context.Context\) \(\[\]model.AlertRule, error\)](<#YAMLRuleStore.GetActiveRules>)
  - [func \(s \*YAMLRuleStore\) GetRuleByID\(ctx context.Context, id string\) \(model.AlertRule, error\)](<#YAMLRuleStore.GetRuleByID>)
  - [func \(s \*YAMLRuleStore\) GetRuleByName\(ctx context.Context, name string\) \(model.AlertRule, error\)](<#YAMLRuleStore.GetRuleByName>)
  - [func \(s \*YAMLRuleStore\) ListRules\(ctx context.Context\) \(\[\]model.AlertRule, error\)](<#YAMLRuleStore.ListRules>)
  - [func \(s \*YAMLRuleStore\) UpdateRule\(ctx context.Context, r model.AlertRule\) error](<#YAMLRuleStore.UpdateRule>)


<a name="JSONRuleStore"></a>
## type [JSONRuleStore](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/store/rulestore/jsonrulestore.go#L35-L39>)

JSONRuleStore is a rule store that uses a JSON file for persistence. It implements the RuleStore interface and provides methods for adding,

```go
type JSONRuleStore struct {
    // contains filtered or unexported fields
}
```

<a name="NewJSONStore"></a>
### func [NewJSONStore](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/store/rulestore/jsonrulestore.go#L43>)

```go
func NewJSONStore(path string) (*JSONRuleStore, error)
```

NewJSONStore creates a new JSONRuleStore with the specified file path. It loads existing rules from the file if it exists.

<a name="JSONRuleStore.AddRule"></a>
### func \(\*JSONRuleStore\) [AddRule](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/store/rulestore/jsonrulestore.go#L80>)

```go
func (j *JSONRuleStore) AddRule(ctx context.Context, r model.AlertRule) error
```

AddRule adds a new rule to the store. It locks the store for writing, adds the rule, and then saves the rules to the file.

<a name="JSONRuleStore.DeleteRule"></a>
### func \(\*JSONRuleStore\) [DeleteRule](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/store/rulestore/jsonrulestore.go#L96>)

```go
func (j *JSONRuleStore) DeleteRule(ctx context.Context, id string) error
```

DeleteRule removes a rule from the store. It locks the store for writing, deletes the rule, and then saves the rules to the file.

<a name="JSONRuleStore.GetActiveRules"></a>
### func \(\*JSONRuleStore\) [GetActiveRules](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/store/rulestore/jsonrulestore.go#L120>)

```go
func (j *JSONRuleStore) GetActiveRules(ctx context.Context) ([]model.AlertRule, error)
```

GetActiveRules returns a list of all active rules in the store. It calls ListRules to get all rules and filters them based on the Enabled field.

<a name="JSONRuleStore.GetRuleByID"></a>
### func \(\*JSONRuleStore\) [GetRuleByID](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/store/rulestore/jsonrulestore.go#L132>)

```go
func (s *JSONRuleStore) GetRuleByID(ctx context.Context, id string) (model.AlertRule, error)
```

GetRuleByID retrieves a rule by its ID from the JSON rule store.

<a name="JSONRuleStore.GetRuleByName"></a>
### func \(\*JSONRuleStore\) [GetRuleByName](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/store/rulestore/jsonrulestore.go#L143>)

```go
func (s *JSONRuleStore) GetRuleByName(ctx context.Context, name string) (model.AlertRule, error)
```

GetRuleByName retrieves a rule by its Name from the JSON rule store.

<a name="JSONRuleStore.ListRules"></a>
### func \(\*JSONRuleStore\) [ListRules](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/store/rulestore/jsonrulestore.go#L107>)

```go
func (j *JSONRuleStore) ListRules(ctx context.Context) ([]model.AlertRule, error)
```



<a name="JSONRuleStore.UpdateRule"></a>
### func \(\*JSONRuleStore\) [UpdateRule](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/store/rulestore/jsonrulestore.go#L90>)

```go
func (j *JSONRuleStore) UpdateRule(ctx context.Context, r model.AlertRule) error
```

UpdateRule updates an existing rule in the store. It locks the store for writing, updates the rule, and then saves the rules to the file.

<a name="MemoryRuleStore"></a>
## type [MemoryRuleStore](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/store/rulestore/memorystore.go#L36-L39>)



```go
type MemoryRuleStore struct {
    // contains filtered or unexported fields
}
```

<a name="NewMemoryStore"></a>
### func [NewMemoryStore](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/store/rulestore/memorystore.go#L41>)

```go
func NewMemoryStore() *MemoryRuleStore
```



<a name="MemoryRuleStore.AddRule"></a>
### func \(\*MemoryRuleStore\) [AddRule](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/store/rulestore/memorystore.go#L45>)

```go
func (s *MemoryRuleStore) AddRule(ctx context.Context, r model.AlertRule) error
```



<a name="MemoryRuleStore.DeleteRule"></a>
### func \(\*MemoryRuleStore\) [DeleteRule](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/store/rulestore/memorystore.go#L56>)

```go
func (s *MemoryRuleStore) DeleteRule(ctx context.Context, id string) error
```



<a name="MemoryRuleStore.GetActiveRules"></a>
### func \(\*MemoryRuleStore\) [GetActiveRules](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/store/rulestore/memorystore.go#L74>)

```go
func (s *MemoryRuleStore) GetActiveRules(ctx context.Context) ([]model.AlertRule, error)
```



<a name="MemoryRuleStore.ListRules"></a>
### func \(\*MemoryRuleStore\) [ListRules](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/store/rulestore/memorystore.go#L63>)

```go
func (s *MemoryRuleStore) ListRules(ctx context.Context) ([]model.AlertRule, error)
```



<a name="MemoryRuleStore.UpdateRule"></a>
### func \(\*MemoryRuleStore\) [UpdateRule](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/store/rulestore/memorystore.go#L52>)

```go
func (s *MemoryRuleStore) UpdateRule(ctx context.Context, r model.AlertRule) error
```



<a name="RuleStore"></a>
## type [RuleStore](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/store/rulestore/rulestore.go#L35-L43>)

RuleStore defines the interface for managing alert rules.

```go
type RuleStore interface {
    AddRule(ctx context.Context, rule model.AlertRule) error
    UpdateRule(ctx context.Context, rule model.AlertRule) error
    DeleteRule(ctx context.Context, id string) error
    GetActiveRules(ctx context.Context) ([]model.AlertRule, error)
    GetRuleByID(ctx context.Context, id string) (model.AlertRule, error)
    GetRuleByName(ctx context.Context, name string) (model.AlertRule, error)
    ListRules(ctx context.Context) ([]model.AlertRule, error)
}
```

<a name="YAMLRuleStore"></a>
## type [YAMLRuleStore](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/store/rulestore/yamlrulestore.go#L37-L41>)

YAMLRuleStore is a rule store that uses a YAML file for persistence. It implements the RuleStore interface and provides methods for adding, updating, deleting, and retrieving rules.

```go
type YAMLRuleStore struct {
    // contains filtered or unexported fields
}
```

<a name="NewYAMLStore"></a>
### func [NewYAMLStore](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/store/rulestore/yamlrulestore.go#L44>)

```go
func NewYAMLStore(path string) (*YAMLRuleStore, error)
```

NewYAMLStore creates a new YAMLRuleStore with the specified file path.

<a name="YAMLRuleStore.AddRule"></a>
### func \(\*YAMLRuleStore\) [AddRule](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/store/rulestore/yamlrulestore.go#L97>)

```go
func (s *YAMLRuleStore) AddRule(ctx context.Context, r model.AlertRule) error
```

AddRule adds a new rule to the store.

<a name="YAMLRuleStore.DeleteRule"></a>
### func \(\*YAMLRuleStore\) [DeleteRule](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/store/rulestore/yamlrulestore.go#L110>)

```go
func (s *YAMLRuleStore) DeleteRule(ctx context.Context, id string) error
```

DeleteRule removes a rule from the store.

<a name="YAMLRuleStore.GetActiveRules"></a>
### func \(\*YAMLRuleStore\) [GetActiveRules](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/store/rulestore/yamlrulestore.go#L132>)

```go
func (s *YAMLRuleStore) GetActiveRules(ctx context.Context) ([]model.AlertRule, error)
```



<a name="YAMLRuleStore.GetRuleByID"></a>
### func \(\*YAMLRuleStore\) [GetRuleByID](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/store/rulestore/yamlrulestore.go#L144>)

```go
func (s *YAMLRuleStore) GetRuleByID(ctx context.Context, id string) (model.AlertRule, error)
```

GetRuleByID retrieves a rule by its ID.

<a name="YAMLRuleStore.GetRuleByName"></a>
### func \(\*YAMLRuleStore\) [GetRuleByName](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/store/rulestore/yamlrulestore.go#L155>)

```go
func (s *YAMLRuleStore) GetRuleByName(ctx context.Context, name string) (model.AlertRule, error)
```

GetRuleByName retrieves a rule by its Name \(case\-sensitive\).

<a name="YAMLRuleStore.ListRules"></a>
### func \(\*YAMLRuleStore\) [ListRules](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/store/rulestore/yamlrulestore.go#L118>)

```go
func (s *YAMLRuleStore) ListRules(ctx context.Context) ([]model.AlertRule, error)
```

ListRules returns a list of all rules in the store.

<a name="YAMLRuleStore.UpdateRule"></a>
### func \(\*YAMLRuleStore\) [UpdateRule](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/store/rulestore/yamlrulestore.go#L105>)

```go
func (s *YAMLRuleStore) UpdateRule(ctx context.Context, r model.AlertRule) error
```

UpdateRule updates an existing rule in the store.

# userstore

```go
import "github.com/aaronlmathis/gosight-server/internal/store/userstore"
```

Package userstore defines the RBAC storage interface and types

## Index

- [type UserStore](<#UserStore>)


<a name="UserStore"></a>
## type [UserStore](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/store/userstore/userstore.go#L10-L22>)



```go
type UserStore interface {
    GetUserByEmail(ctx context.Context, email string) (*usermodel.User, error)
    GetUserByUsername(ctx context.Context, username string) (*usermodel.User, error)
    GetUserByID(ctx context.Context, username string) (*usermodel.User, error)
    GetUserWithPermissions(ctx context.Context, userID string) (*usermodel.User, error)
    GetUserBySSO(ctx context.Context, provider string, ssoID string) (*usermodel.User, error)
    SaveUser(ctx context.Context, u *usermodel.User) error
    CreateRole(ctx context.Context, r *usermodel.Role) error
    AssignRoleToUser(ctx context.Context, userID, roleID string) error
    CreatePermission(ctx context.Context, p *usermodel.Permission) error
    AttachPermissionToRole(ctx context.Context, roleID, permID string) error
    Close() error
}
```

# pgalertstore

```go
import "github.com/aaronlmathis/gosight-server/internal/store/alertstore/pgalertstore"
```

## Index

- [type PGAlertStore](<#PGAlertStore>)
  - [func NewPGAlertStore\(db \*sql.DB\) \*PGAlertStore](<#NewPGAlertStore>)
  - [func \(s \*PGAlertStore\) CountAlertsFiltered\(ctx context.Context, q model.AlertQuery\) \(int, error\)](<#PGAlertStore.CountAlertsFiltered>)
  - [func \(s \*PGAlertStore\) GetByID\(ctx context.Context, id string\) \(model.AlertInstance, error\)](<#PGAlertStore.GetByID>)
  - [func \(s \*PGAlertStore\) ListActiveAlerts\(ctx context.Context\) \(\[\]model.AlertInstance, error\)](<#PGAlertStore.ListActiveAlerts>)
  - [func \(s \*PGAlertStore\) ListAlertHistory\(ctx context.Context, since time.Time\) \(\[\]model.AlertInstance, error\)](<#PGAlertStore.ListAlertHistory>)
  - [func \(s \*PGAlertStore\) ListAlerts\(ctx context.Context\) \(\[\]model.AlertInstance, error\)](<#PGAlertStore.ListAlerts>)
  - [func \(s \*PGAlertStore\) ListAlertsFiltered\(ctx context.Context, q model.AlertQuery\) \(\[\]model.AlertInstance, error\)](<#PGAlertStore.ListAlertsFiltered>)
  - [func \(s \*PGAlertStore\) ResolveAlert\(ctx context.Context, ruleID, target string, resolvedAt time.Time\) error](<#PGAlertStore.ResolveAlert>)
  - [func \(s \*PGAlertStore\) UpsertAlert\(ctx context.Context, a \*model.AlertInstance\) error](<#PGAlertStore.UpsertAlert>)


<a name="PGAlertStore"></a>
## type [PGAlertStore](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/store/alertstore/pgalertstore/pgalertstore.go#L46-L48>)

PGAlertStore is a PostgreSQL implementation of the AlertStore interface.

```go
type PGAlertStore struct {
    // contains filtered or unexported fields
}
```

<a name="NewPGAlertStore"></a>
### func [NewPGAlertStore](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/store/alertstore/pgalertstore/pgalertstore.go#L51>)

```go
func NewPGAlertStore(db *sql.DB) *PGAlertStore
```

NewPGAlertStore creates a new PGAlertStore instance with the given database connection.

<a name="PGAlertStore.CountAlertsFiltered"></a>
### func \(\*PGAlertStore\) [CountAlertsFiltered](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/store/alertstore/pgalertstore/pgalertstore.go#L375>)

```go
func (s *PGAlertStore) CountAlertsFiltered(ctx context.Context, q model.AlertQuery) (int, error)
```



<a name="PGAlertStore.GetByID"></a>
### func \(\*PGAlertStore\) [GetByID](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/store/alertstore/pgalertstore/pgalertstore.go#L58>)

```go
func (s *PGAlertStore) GetByID(ctx context.Context, id string) (model.AlertInstance, error)
```

GetByID retrieves an alert by its ID from the PostgreSQL database. GetByID retrieves an alert instance by ID from the PostgreSQL database. GetByID retrieves an alert by its ID from the PostgreSQL database.

<a name="PGAlertStore.ListActiveAlerts"></a>
### func \(\*PGAlertStore\) [ListActiveAlerts](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/store/alertstore/pgalertstore/pgalertstore.go#L237>)

```go
func (s *PGAlertStore) ListActiveAlerts(ctx context.Context) ([]model.AlertInstance, error)
```



<a name="PGAlertStore.ListAlertHistory"></a>
### func \(\*PGAlertStore\) [ListAlertHistory](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/store/alertstore/pgalertstore/pgalertstore.go#L256>)

```go
func (s *PGAlertStore) ListAlertHistory(ctx context.Context, since time.Time) ([]model.AlertInstance, error)
```



<a name="PGAlertStore.ListAlerts"></a>
### func \(\*PGAlertStore\) [ListAlerts](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/store/alertstore/pgalertstore/pgalertstore.go#L119>)

```go
func (s *PGAlertStore) ListAlerts(ctx context.Context) ([]model.AlertInstance, error)
```



<a name="PGAlertStore.ListAlertsFiltered"></a>
### func \(\*PGAlertStore\) [ListAlertsFiltered](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/store/alertstore/pgalertstore/pgalertstore.go#L299>)

```go
func (s *PGAlertStore) ListAlertsFiltered(ctx context.Context, q model.AlertQuery) ([]model.AlertInstance, error)
```



<a name="PGAlertStore.ResolveAlert"></a>
### func \(\*PGAlertStore\) [ResolveAlert](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/store/alertstore/pgalertstore/pgalertstore.go#L224>)

```go
func (s *PGAlertStore) ResolveAlert(ctx context.Context, ruleID, target string, resolvedAt time.Time) error
```



<a name="PGAlertStore.UpsertAlert"></a>
### func \(\*PGAlertStore\) [UpsertAlert](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/store/alertstore/pgalertstore/pgalertstore.go#L194>)

```go
func (s *PGAlertStore) UpsertAlert(ctx context.Context, a *model.AlertInstance) error
```

UpsertAlert inserts or updates an alert instance in the database.

# pgstore

```go
import "github.com/aaronlmathis/gosight-server/internal/store/datastore/pgsql"
```

Package pgstore implements the userstore.Store interface using PostgreSQL

## Index

- [type PGDataStore](<#PGDataStore>)
  - [func NewPGDataStore\(db \*sql.DB\) \*PGDataStore](<#NewPGDataStore>)
  - [func \(s \*PGDataStore\) Close\(\) error](<#PGDataStore.Close>)
  - [func \(s \*PGDataStore\) DeleteTag\(ctx context.Context, endpointID, key string\) error](<#PGDataStore.DeleteTag>)
  - [func \(s \*PGDataStore\) GetAgentByHostname\(ctx context.Context, hostname string\) \(\*model.Agent, error\)](<#PGDataStore.GetAgentByHostname>)
  - [func \(s \*PGDataStore\) GetAgentByID\(ctx context.Context, id string\) \(\*model.Agent, error\)](<#PGDataStore.GetAgentByID>)
  - [func \(s \*PGDataStore\) GetAllTags\(ctx context.Context\) \(\[\]model.Tag, error\)](<#PGDataStore.GetAllTags>)
  - [func \(s \*PGDataStore\) GetContainerByID\(ctx context.Context, id string\) \(\*model.Container, error\)](<#PGDataStore.GetContainerByID>)
  - [func \(s \*PGDataStore\) GetTags\(ctx context.Context, endpointID string\) \(map\[string\]string, error\)](<#PGDataStore.GetTags>)
  - [func \(s \*PGDataStore\) InsertFullProcessPayload\(ctx context.Context, payload \*model.ProcessPayload\) error](<#PGDataStore.InsertFullProcessPayload>)
  - [func \(s \*PGDataStore\) InsertProcessInfos\(ctx context.Context, snapshotID int64, payload \*model.ProcessPayload\) error](<#PGDataStore.InsertProcessInfos>)
  - [func \(s \*PGDataStore\) InsertProcessSnapshot\(ctx context.Context, snap \*model.ProcessPayload\) \(int64, error\)](<#PGDataStore.InsertProcessSnapshot>)
  - [func \(s \*PGDataStore\) ListAgents\(ctx context.Context\) \(\[\]\*model.Agent, error\)](<#PGDataStore.ListAgents>)
  - [func \(s \*PGDataStore\) ListContainers\(ctx context.Context\) \(\[\]\*model.Container, error\)](<#PGDataStore.ListContainers>)
  - [func \(s \*PGDataStore\) ListKeys\(ctx context.Context\) \(\[\]string, error\)](<#PGDataStore.ListKeys>)
  - [func \(s \*PGDataStore\) ListTags\(ctx context.Context, endpointID string\) \(map\[string\]string, error\)](<#PGDataStore.ListTags>)
  - [func \(s \*PGDataStore\) ListValues\(ctx context.Context, key string\) \(\[\]string, error\)](<#PGDataStore.ListValues>)
  - [func \(s \*PGDataStore\) QueryProcessInfos\(ctx context.Context, filter \*model.ProcessQueryFilter\) \(\[\]model.ProcessInfo, error\)](<#PGDataStore.QueryProcessInfos>)
  - [func \(s \*PGDataStore\) SetTags\(ctx context.Context, endpointID string, tags map\[string\]string\) error](<#PGDataStore.SetTags>)
  - [func \(s \*PGDataStore\) UpsertAgent\(ctx context.Context, agent \*model.Agent\) error](<#PGDataStore.UpsertAgent>)
  - [func \(s \*PGDataStore\) UpsertContainer\(ctx context.Context, c \*model.Container\) error](<#PGDataStore.UpsertContainer>)
  - [func \(s \*PGDataStore\) Write\(ctx context.Context, batches \[\]\*model.ProcessPayload\) error](<#PGDataStore.Write>)


<a name="PGDataStore"></a>
## type [PGDataStore](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/store/datastore/pgsql/pgdatastore.go#L35-L37>)

Package pgstore implements the userstore.Store interface using PostgreSQL PGDataStore is a struct that represents a PostgreSQL data store It contains a pointer to the sql.DB object for database operations

```go
type PGDataStore struct {
    // contains filtered or unexported fields
}
```

<a name="NewPGDataStore"></a>
### func [NewPGDataStore](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/store/datastore/pgsql/pgdatastore.go#L40>)

```go
func NewPGDataStore(db *sql.DB) *PGDataStore
```

New creates a new PGDataStore instance

<a name="PGDataStore.Close"></a>
### func \(\*PGDataStore\) [Close](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/store/datastore/pgsql/pgdatastore.go#L46>)

```go
func (s *PGDataStore) Close() error
```

Close closes the database connection It checks if the db is not nil before attempting to close it

<a name="PGDataStore.DeleteTag"></a>
### func \(\*PGDataStore\) [DeleteTag](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/store/datastore/pgsql/tags.go#L105>)

```go
func (s *PGDataStore) DeleteTag(ctx context.Context, endpointID, key string) error
```

DeleteTag removes a specific tag for a given endpoint ID.

<a name="PGDataStore.GetAgentByHostname"></a>
### func \(\*PGDataStore\) [GetAgentByHostname](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/store/datastore/pgsql/tracker.go#L132>)

```go
func (s *PGDataStore) GetAgentByHostname(ctx context.Context, hostname string) (*model.Agent, error)
```

GetAgentByHostname retrieves an agent by its hostname

<a name="PGDataStore.GetAgentByID"></a>
### func \(\*PGDataStore\) [GetAgentByID](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/store/datastore/pgsql/tracker.go#L82>)

```go
func (s *PGDataStore) GetAgentByID(ctx context.Context, id string) (*model.Agent, error)
```

GetAgentByAgentID retrieves an agent by its agent\_id This is used for the agent to check in with the server

<a name="PGDataStore.GetAllTags"></a>
### func \(\*PGDataStore\) [GetAllTags](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/store/datastore/pgsql/tags.go#L53>)

```go
func (s *PGDataStore) GetAllTags(ctx context.Context) ([]model.Tag, error)
```



<a name="PGDataStore.GetContainerByID"></a>
### func \(\*PGDataStore\) [GetContainerByID](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/store/datastore/pgsql/tracker.go#L347>)

```go
func (s *PGDataStore) GetContainerByID(ctx context.Context, id string) (*model.Container, error)
```

GetContainerByID retrieves a container by its container\_id

<a name="PGDataStore.GetTags"></a>
### func \(\*PGDataStore\) [GetTags](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/store/datastore/pgsql/tags.go#L34>)

```go
func (s *PGDataStore) GetTags(ctx context.Context, endpointID string) (map[string]string, error)
```

GetTags retrieves all tags for a given endpoint ID.

<a name="PGDataStore.InsertFullProcessPayload"></a>
### func \(\*PGDataStore\) [InsertFullProcessPayload](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/store/datastore/pgsql/processes.go#L91>)

```go
func (s *PGDataStore) InsertFullProcessPayload(ctx context.Context, payload *model.ProcessPayload) error
```

InsertFullProcessPayload inserts a complete process payload into the database,

<a name="PGDataStore.InsertProcessInfos"></a>
### func \(\*PGDataStore\) [InsertProcessInfos](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/store/datastore/pgsql/processes.go#L127>)

```go
func (s *PGDataStore) InsertProcessInfos(ctx context.Context, snapshotID int64, payload *model.ProcessPayload) error
```

InsertProcessInfos inserts multiple process information records associated with a snapshot.

<a name="PGDataStore.InsertProcessSnapshot"></a>
### func \(\*PGDataStore\) [InsertProcessSnapshot](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/store/datastore/pgsql/processes.go#L100>)

```go
func (s *PGDataStore) InsertProcessSnapshot(ctx context.Context, snap *model.ProcessPayload) (int64, error)
```

InsertProcessSnapshot inserts a new process snapshot into the database.

<a name="PGDataStore.ListAgents"></a>
### func \(\*PGDataStore\) [ListAgents](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/store/datastore/pgsql/tracker.go#L184>)

```go
func (s *PGDataStore) ListAgents(ctx context.Context) ([]*model.Agent, error)
```

ListAgents retrieves all agents from the database This is used for the web UI to display all agents and for the agent to check in with the server

<a name="PGDataStore.ListContainers"></a>
### func \(\*PGDataStore\) [ListContainers](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/store/datastore/pgsql/tracker.go#L307>)

```go
func (s *PGDataStore) ListContainers(ctx context.Context) ([]*model.Container, error)
```

ListContainers retrieves all containers from the database This is used for the web UI to display all containers and for the agent to check in with the server

<a name="PGDataStore.ListKeys"></a>
### func \(\*PGDataStore\) [ListKeys](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/store/datastore/pgsql/tags.go#L116>)

```go
func (s *PGDataStore) ListKeys(ctx context.Context) ([]string, error)
```

ListKeys returns all unique tag keys

<a name="PGDataStore.ListTags"></a>
### func \(\*PGDataStore\) [ListTags](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/store/datastore/pgsql/tags.go#L111>)

```go
func (s *PGDataStore) ListTags(ctx context.Context, endpointID string) (map[string]string, error)
```

ListTags retrieves all tags for a given endpoint ID.

<a name="PGDataStore.ListValues"></a>
### func \(\*PGDataStore\) [ListValues](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/store/datastore/pgsql/tags.go#L135>)

```go
func (s *PGDataStore) ListValues(ctx context.Context, key string) ([]string, error)
```

ListValues returns all values for a given key

<a name="PGDataStore.QueryProcessInfos"></a>
### func \(\*PGDataStore\) [QueryProcessInfos](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/store/datastore/pgsql/processes.go#L173>)

```go
func (s *PGDataStore) QueryProcessInfos(ctx context.Context, filter *model.ProcessQueryFilter) ([]model.ProcessInfo, error)
```



<a name="PGDataStore.SetTags"></a>
### func \(\*PGDataStore\) [SetTags](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/store/datastore/pgsql/tags.go#L75>)

```go
func (s *PGDataStore) SetTags(ctx context.Context, endpointID string, tags map[string]string) error
```

SetTags replaces all tags for a given endpoint ID with the provided tags.

<a name="PGDataStore.UpsertAgent"></a>
### func \(\*PGDataStore\) [UpsertAgent](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/store/datastore/pgsql/tracker.go#L42>)

```go
func (s *PGDataStore) UpsertAgent(ctx context.Context, agent *model.Agent) error
```



<a name="PGDataStore.UpsertContainer"></a>
### func \(\*PGDataStore\) [UpsertContainer](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/store/datastore/pgsql/tracker.go#L257>)

```go
func (s *PGDataStore) UpsertContainer(ctx context.Context, c *model.Container) error
```

UpsertContainer inserts or updates a container in the database This is used for the agent to check in with the server It also updates the last\_seen field to the current time and the status field to "Running" if the container is running or "Stopped" if the container is stopped UpsertContainer inserts or updates a container in the database

<a name="PGDataStore.Write"></a>
### func \(\*PGDataStore\) [Write](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/store/datastore/pgsql/processes.go#L36>)

```go
func (s *PGDataStore) Write(ctx context.Context, batches []*model.ProcessPayload) error
```

Write fullfills the interface in BufferedDataStore

# pgeventstore

```go
import "github.com/aaronlmathis/gosight-server/internal/store/eventstore/pgeventstore"
```

## Index

- [type PGEventStore](<#PGEventStore>)
  - [func NewPGEventStore\(db \*sql.DB\) \*PGEventStore](<#NewPGEventStore>)
  - [func \(s \*PGEventStore\) AddEvent\(ctx context.Context, e model.EventEntry\) error](<#PGEventStore.AddEvent>)
  - [func \(s \*PGEventStore\) GetRecentEvents\(ctx context.Context, filter model.EventFilter\) \(\[\]model.EventEntry, error\)](<#PGEventStore.GetRecentEvents>)


<a name="PGEventStore"></a>
## type [PGEventStore](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/store/eventstore/pgeventstore/pgeventstore.go#L13-L15>)



```go
type PGEventStore struct {
    // contains filtered or unexported fields
}
```

<a name="NewPGEventStore"></a>
### func [NewPGEventStore](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/store/eventstore/pgeventstore/pgeventstore.go#L17>)

```go
func NewPGEventStore(db *sql.DB) *PGEventStore
```



<a name="PGEventStore.AddEvent"></a>
### func \(\*PGEventStore\) [AddEvent](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/store/eventstore/pgeventstore/pgeventstore.go#L24>)

```go
func (s *PGEventStore) AddEvent(ctx context.Context, e model.EventEntry) error
```

AddEvent adds an event to the event store. If the event ID is empty, a new UUID is generated. The event is stored in the database with the provided details.

<a name="PGEventStore.GetRecentEvents"></a>
### func \(\*PGEventStore\) [GetRecentEvents](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/store/eventstore/pgeventstore/pgeventstore.go#L48>)

```go
func (s *PGEventStore) GetRecentEvents(ctx context.Context, filter model.EventFilter) ([]model.EventEntry, error)
```

QueryEvents retrieves events from the event store based on the provided filter. The filter can include various criteria such as level, type, category, source, scope, target, and time range. The results are returned as a slice of EventEntry structs.

# filestore

```go
import "github.com/aaronlmathis/gosight-server/internal/store/logstore/filestore.go"
```

## Index

- [type FileStore](<#FileStore>)
  - [func New\(dir string\) \*FileStore](<#New>)
  - [func \(f \*FileStore\) Close\(\) error](<#FileStore.Close>)
  - [func \(v \*FileStore\) GetLogs\(filter model.LogFilter\) \(\[\]model.LogEntry, error\)](<#FileStore.GetLogs>)
  - [func \(f \*FileStore\) Name\(\) string](<#FileStore.Name>)
  - [func \(f \*FileStore\) Write\(payloads \[\]model.LogPayload\) error](<#FileStore.Write>)


<a name="FileStore"></a>
## type [FileStore](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/store/logstore/filestore.go/filestore.go#L39-L41>)



```go
type FileStore struct {
    // contains filtered or unexported fields
}
```

<a name="New"></a>
### func [New](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/store/logstore/filestore.go/filestore.go#L43>)

```go
func New(dir string) *FileStore
```



<a name="FileStore.Close"></a>
### func \(\*FileStore\) [Close](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/store/logstore/filestore.go/filestore.go#L88>)

```go
func (f *FileStore) Close() error
```



<a name="FileStore.GetLogs"></a>
### func \(\*FileStore\) [GetLogs](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/store/logstore/filestore.go/queries.go#L15>)

```go
func (v *FileStore) GetLogs(filter model.LogFilter) ([]model.LogEntry, error)
```



<a name="FileStore.Name"></a>
### func \(\*FileStore\) [Name](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/store/logstore/filestore.go/filestore.go#L50>)

```go
func (f *FileStore) Name() string
```



<a name="FileStore.Write"></a>
### func \(\*FileStore\) [Write](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/store/logstore/filestore.go/filestore.go#L54>)

```go
func (f *FileStore) Write(payloads []model.LogPayload) error
```



# victorialogstore

```go
import "github.com/aaronlmathis/gosight-server/internal/store/logstore/victoriametrics"
```

## Index

- [func BuildPromLabels\(meta \*model.Meta\) map\[string\]string](<#BuildPromLabels>)
- [func BuildPromQL\(metric string, filters map\[string\]string\) string](<#BuildPromQL>)
- [type VictoriaLogStore](<#VictoriaLogStore>)
  - [func NewVictoriaLogStore\(url string, dir string, logCache cache.LogCache\) \(\*VictoriaLogStore, error\)](<#NewVictoriaLogStore>)
  - [func \(v \*VictoriaLogStore\) Close\(\) error](<#VictoriaLogStore.Close>)
  - [func \(v \*VictoriaLogStore\) GetLogByID\(logID string\) \(\*model.LogEntry, error\)](<#VictoriaLogStore.GetLogByID>)
  - [func \(v \*VictoriaLogStore\) GetLogs\(filter model.LogFilter\) \(\[\]model.LogEntry, error\)](<#VictoriaLogStore.GetLogs>)
  - [func \(v \*VictoriaLogStore\) Name\(\) string](<#VictoriaLogStore.Name>)
  - [func \(v \*VictoriaLogStore\) Write\(batch \[\]model.LogPayload\) error](<#VictoriaLogStore.Write>)


<a name="BuildPromLabels"></a>
## func [BuildPromLabels](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/store/logstore/victoriametrics/helpers.go#L129>)

```go
func BuildPromLabels(meta *model.Meta) map[string]string
```



<a name="BuildPromQL"></a>
## func [BuildPromQL](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/store/logstore/victoriametrics/helpers.go#L230>)

```go
func BuildPromQL(metric string, filters map[string]string) string
```

BuildPromQL constructs a Prometheus Query Language \(PromQL\) query string

<a name="VictoriaLogStore"></a>
## type [VictoriaLogStore](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/store/logstore/victoriametrics/victoriametrics.go#L39-L44>)



```go
type VictoriaLogStore struct {
    // contains filtered or unexported fields
}
```

<a name="NewVictoriaLogStore"></a>
### func [NewVictoriaLogStore](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/store/logstore/victoriametrics/victoriametrics.go#L47>)

```go
func NewVictoriaLogStore(url string, dir string, logCache cache.LogCache) (*VictoriaLogStore, error)
```

NewVictoriaLogStore

<a name="VictoriaLogStore.Close"></a>
### func \(\*VictoriaLogStore\) [Close](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/store/logstore/victoriametrics/victoriametrics.go#L108>)

```go
func (v *VictoriaLogStore) Close() error
```



<a name="VictoriaLogStore.GetLogByID"></a>
### func \(\*VictoriaLogStore\) [GetLogByID](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/store/logstore/victoriametrics/queries.go#L184>)

```go
func (v *VictoriaLogStore) GetLogByID(logID string) (*model.LogEntry, error)
```



<a name="VictoriaLogStore.GetLogs"></a>
### func \(\*VictoriaLogStore\) [GetLogs](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/store/logstore/victoriametrics/queries.go#L139>)

```go
func (v *VictoriaLogStore) GetLogs(filter model.LogFilter) ([]model.LogEntry, error)
```



<a name="VictoriaLogStore.Name"></a>
### func \(\*VictoriaLogStore\) [Name](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/store/logstore/victoriametrics/victoriametrics.go#L56>)

```go
func (v *VictoriaLogStore) Name() string
```



<a name="VictoriaLogStore.Write"></a>
### func \(\*VictoriaLogStore\) [Write](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/store/logstore/victoriametrics/victoriametrics.go#L60>)

```go
func (v *VictoriaLogStore) Write(batch []model.LogPayload) error
```



# victoriametricstore

```go
import "github.com/aaronlmathis/gosight-server/internal/store/metricstore/victoriametrics"
```

## Index

- [func BuildPromLabels\(meta \*model.Meta\) map\[string\]string](<#BuildPromLabels>)
- [func BuildPromQL\(metric string, filters map\[string\]string\) string](<#BuildPromQL>)
- [type VictoriaStore](<#VictoriaStore>)
  - [func NewVictoriaStore\(url string, metricCache cache.MetricCache\) \(\*VictoriaStore, error\)](<#NewVictoriaStore>)
  - [func \(v \*VictoriaStore\) Close\(\) error](<#VictoriaStore.Close>)
  - [func \(v \*VictoriaStore\) FetchDimensionsForMetric\(metric string\) \(\[\]string, error\)](<#VictoriaStore.FetchDimensionsForMetric>)
  - [func \(v \*VictoriaStore\) GetAllKnownMetricNames\(\) \[\]string](<#VictoriaStore.GetAllKnownMetricNames>)
  - [func \(v \*VictoriaStore\) ListLabelValues\(label string, contains string\) \(\[\]string, error\)](<#VictoriaStore.ListLabelValues>)
  - [func \(v \*VictoriaStore\) QueryInstant\(metric string, filters map\[string\]string\) \(\[\]model.MetricRow, error\)](<#VictoriaStore.QueryInstant>)
  - [func \(v \*VictoriaStore\) QueryMultiInstant\(metricNames \[\]string, filters map\[string\]string\) \(\[\]model.MetricRow, error\)](<#VictoriaStore.QueryMultiInstant>)
  - [func \(v \*VictoriaStore\) QueryMultiRange\(metrics \[\]string, start, end time.Time, step string, filters map\[string\]string\) \(\[\]model.MetricRow, error\)](<#VictoriaStore.QueryMultiRange>)
  - [func \(v \*VictoriaStore\) QueryRange\(metric string, start, end time.Time, step string, filters map\[string\]string\) \(\[\]model.Point, error\)](<#VictoriaStore.QueryRange>)
  - [func \(v \*VictoriaStore\) Write\(batch \[\]model.MetricPayload\) error](<#VictoriaStore.Write>)


<a name="BuildPromLabels"></a>
## func [BuildPromLabels](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/store/metricstore/victoriametrics/helpers.go#L95>)

```go
func BuildPromLabels(meta *model.Meta) map[string]string
```



<a name="BuildPromQL"></a>
## func [BuildPromQL](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/store/metricstore/victoriametrics/helpers.go#L245>)

```go
func BuildPromQL(metric string, filters map[string]string) string
```

BuildPromQL constructs a Prometheus Query Language \(PromQL\) query string

<a name="VictoriaStore"></a>
## type [VictoriaStore](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/store/metricstore/victoriametrics/victoriametrics.go#L38-L42>)



```go
type VictoriaStore struct {
    // contains filtered or unexported fields
}
```

<a name="NewVictoriaStore"></a>
### func [NewVictoriaStore](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/store/metricstore/victoriametrics/victoriametrics.go#L45>)

```go
func NewVictoriaStore(url string, metricCache cache.MetricCache) (*VictoriaStore, error)
```

NewVictoriaStore

<a name="VictoriaStore.Close"></a>
### func \(\*VictoriaStore\) [Close](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/store/metricstore/victoriametrics/victoriametrics.go#L87>)

```go
func (v *VictoriaStore) Close() error
```



<a name="VictoriaStore.FetchDimensionsForMetric"></a>
### func \(\*VictoriaStore\) [FetchDimensionsForMetric](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/store/metricstore/victoriametrics/queries.go#L353>)

```go
func (v *VictoriaStore) FetchDimensionsForMetric(metric string) ([]string, error)
```

FetchDimensionsForMetric queries VictoriaMetrics for a given metric and extracts dimension keys.

<a name="VictoriaStore.GetAllKnownMetricNames"></a>
### func \(\*VictoriaStore\) [GetAllKnownMetricNames](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/store/metricstore/victoriametrics/queries.go#L155>)

```go
func (v *VictoriaStore) GetAllKnownMetricNames() []string
```



<a name="VictoriaStore.ListLabelValues"></a>
### func \(\*VictoriaStore\) [ListLabelValues](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/store/metricstore/victoriametrics/queries.go#L416>)

```go
func (v *VictoriaStore) ListLabelValues(label string, contains string) ([]string, error)
```



<a name="VictoriaStore.QueryInstant"></a>
### func \(\*VictoriaStore\) [QueryInstant](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/store/metricstore/victoriametrics/queries.go#L41>)

```go
func (v *VictoriaStore) QueryInstant(metric string, filters map[string]string) ([]model.MetricRow, error)
```

QueryInstant fetches the latest data points for a given metric with optional label filters.

<a name="VictoriaStore.QueryMultiInstant"></a>
### func \(\*VictoriaStore\) [QueryMultiInstant](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/store/metricstore/victoriametrics/queries.go#L159>)

```go
func (v *VictoriaStore) QueryMultiInstant(metricNames []string, filters map[string]string) ([]model.MetricRow, error)
```



<a name="VictoriaStore.QueryMultiRange"></a>
### func \(\*VictoriaStore\) [QueryMultiRange](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/store/metricstore/victoriametrics/queries.go#L253>)

```go
func (v *VictoriaStore) QueryMultiRange(metrics []string, start, end time.Time, step string, filters map[string]string) ([]model.MetricRow, error)
```



<a name="VictoriaStore.QueryRange"></a>
### func \(\*VictoriaStore\) [QueryRange](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/store/metricstore/victoriametrics/queries.go#L94>)

```go
func (v *VictoriaStore) QueryRange(metric string, start, end time.Time, step string, filters map[string]string) ([]model.Point, error)
```

QueryRange fetches time series data for a metric over a time range with optional label filters.

<a name="VictoriaStore.Write"></a>
### func \(\*VictoriaStore\) [Write](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/store/metricstore/victoriametrics/victoriametrics.go#L53>)

```go
func (v *VictoriaStore) Write(batch []model.MetricPayload) error
```



# userstore

```go
import "github.com/aaronlmathis/gosight-server/internal/store/userstore/mysqlstore"
```

## Index



# pgstore

```go
import "github.com/aaronlmathis/gosight-server/internal/store/userstore/pgstore"
```

Package pgstore implements the userstore.Store interface using PostgreSQL

## Index

- [type PGStore](<#PGStore>)
  - [func New\(db \*sql.DB\) \*PGStore](<#New>)
  - [func \(s \*PGStore\) AssignRoleToUser\(ctx context.Context, userID, roleID string\) error](<#PGStore.AssignRoleToUser>)
  - [func \(s \*PGStore\) AttachPermissionToRole\(ctx context.Context, roleID, permID string\) error](<#PGStore.AttachPermissionToRole>)
  - [func \(s \*PGStore\) Close\(\) error](<#PGStore.Close>)
  - [func \(s \*PGStore\) CreatePermission\(ctx context.Context, p \*usermodel.Permission\) error](<#PGStore.CreatePermission>)
  - [func \(s \*PGStore\) CreateRole\(ctx context.Context, r \*usermodel.Role\) error](<#PGStore.CreateRole>)
  - [func \(s \*PGStore\) GetUserByEmail\(ctx context.Context, email string\) \(\*usermodel.User, error\)](<#PGStore.GetUserByEmail>)
  - [func \(s \*PGStore\) GetUserByID\(ctx context.Context, ID string\) \(\*usermodel.User, error\)](<#PGStore.GetUserByID>)
  - [func \(s \*PGStore\) GetUserBySSO\(ctx context.Context, provider, ssoID string\) \(\*usermodel.User, error\)](<#PGStore.GetUserBySSO>)
  - [func \(s \*PGStore\) GetUserByUsername\(ctx context.Context, username string\) \(\*usermodel.User, error\)](<#PGStore.GetUserByUsername>)
  - [func \(s \*PGStore\) GetUserWithPermissions\(ctx context.Context, userID string\) \(\*usermodel.User, error\)](<#PGStore.GetUserWithPermissions>)
  - [func \(s \*PGStore\) SaveUser\(ctx context.Context, u \*usermodel.User\) error](<#PGStore.SaveUser>)


<a name="PGStore"></a>
## type [PGStore](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/store/userstore/pgstore/pg.go#L11-L13>)



```go
type PGStore struct {
    // contains filtered or unexported fields
}
```

<a name="New"></a>
### func [New](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/store/userstore/pgstore/pg.go#L15>)

```go
func New(db *sql.DB) *PGStore
```



<a name="PGStore.AssignRoleToUser"></a>
### func \(\*PGStore\) [AssignRoleToUser](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/store/userstore/pgstore/pg.go#L136>)

```go
func (s *PGStore) AssignRoleToUser(ctx context.Context, userID, roleID string) error
```



<a name="PGStore.AttachPermissionToRole"></a>
### func \(\*PGStore\) [AttachPermissionToRole](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/store/userstore/pgstore/pg.go#L170>)

```go
func (s *PGStore) AttachPermissionToRole(ctx context.Context, roleID, permID string) error
```



<a name="PGStore.Close"></a>
### func \(\*PGStore\) [Close](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/store/userstore/pgstore/pg.go#L19>)

```go
func (s *PGStore) Close() error
```



<a name="PGStore.CreatePermission"></a>
### func \(\*PGStore\) [CreatePermission](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/store/userstore/pgstore/pg.go#L169>)

```go
func (s *PGStore) CreatePermission(ctx context.Context, p *usermodel.Permission) error
```



<a name="PGStore.CreateRole"></a>
### func \(\*PGStore\) [CreateRole](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/store/userstore/pgstore/pg.go#L167>)

```go
func (s *PGStore) CreateRole(ctx context.Context, r *usermodel.Role) error
```



<a name="PGStore.GetUserByEmail"></a>
### func \(\*PGStore\) [GetUserByEmail](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/store/userstore/pgstore/pg.go#L50>)

```go
func (s *PGStore) GetUserByEmail(ctx context.Context, email string) (*usermodel.User, error)
```



<a name="PGStore.GetUserByID"></a>
### func \(\*PGStore\) [GetUserByID](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/store/userstore/pgstore/pg.go#L26>)

```go
func (s *PGStore) GetUserByID(ctx context.Context, ID string) (*usermodel.User, error)
```



<a name="PGStore.GetUserBySSO"></a>
### func \(\*PGStore\) [GetUserBySSO](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/store/userstore/pgstore/pg.go#L140>)

```go
func (s *PGStore) GetUserBySSO(ctx context.Context, provider, ssoID string) (*usermodel.User, error)
```



<a name="PGStore.GetUserByUsername"></a>
### func \(\*PGStore\) [GetUserByUsername](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/store/userstore/pgstore/pg.go#L38>)

```go
func (s *PGStore) GetUserByUsername(ctx context.Context, username string) (*usermodel.User, error)
```



<a name="PGStore.GetUserWithPermissions"></a>
### func \(\*PGStore\) [GetUserWithPermissions](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/store/userstore/pgstore/pg.go#L62>)

```go
func (s *PGStore) GetUserWithPermissions(ctx context.Context, userID string) (*usermodel.User, error)
```



<a name="PGStore.SaveUser"></a>
### func \(\*PGStore\) [SaveUser](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/store/userstore/pgstore/pg.go#L154>)

```go
func (s *PGStore) SaveUser(ctx context.Context, u *usermodel.User) error
```



Generated by [gomarkdoc](<https://github.com/princjef/gomarkdoc>)
