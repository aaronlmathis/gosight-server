<!-- Code generated by gomarkdoc. DO NOT EDIT -->

# alerts

```go
import "github.com/aaronlmathis/gosight-server/internal/alerts"
```

Package alerts provides a manager for handling alert instances. It manages the state of alerts, including firing and resolving them, and dispatches events related to alert state changes. It also provides a way to list active alerts and handle log\-based alerts. The manager uses a store to persist alert instances and a dispatcher to trigger actions based on alert state changes.

## Index

- [type Manager](<#Manager>)
  - [func NewManager\(emitter \*events.Emitter, dispatcher \*dispatcher.Dispatcher, store alertstore.AlertStore, hub \*websocket.AlertsHub\) \*Manager](<#NewManager>)
  - [func \(m \*Manager\) HandleLogState\(ctx context.Context, rule model.AlertRule, meta \*model.Meta, log model.LogEntry, triggered bool\)](<#Manager.HandleLogState>)
  - [func \(m \*Manager\) HandleState\(ctx context.Context, rule model.AlertRule, meta \*model.Meta, value float64, triggered bool\)](<#Manager.HandleState>)
  - [func \(m \*Manager\) ListActive\(\) \[\]model.AlertInstance](<#Manager.ListActive>)


<a name="Manager"></a>
## type [Manager](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/alerts/manager.go#L47-L54>)

Manager is responsible for managing alert instances. It handles the state of alerts, including firing and resolving them, and dispatches events related to alert state changes.

```go
type Manager struct {
    // contains filtered or unexported fields
}
```

<a name="NewManager"></a>
### func [NewManager](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/alerts/manager.go#L61>)

```go
func NewManager(emitter *events.Emitter, dispatcher *dispatcher.Dispatcher, store alertstore.AlertStore, hub *websocket.AlertsHub) *Manager
```

NewManager creates a new Manager instance. It takes an emitter for emitting events, a dispatcher for triggering actions, a store for persisting alert instances, and a hub for broadcasting alerts. The manager maintains a map of active alert instances, keyed by rule ID and endpoint ID. It also provides methods for handling alert state changes and listing active alerts.

<a name="Manager.HandleLogState"></a>
### func \(\*Manager\) [HandleLogState](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/alerts/manager.go#L168>)

```go
func (m *Manager) HandleLogState(ctx context.Context, rule model.AlertRule, meta *model.Meta, log model.LogEntry, triggered bool)
```

HandleLogState processes the state of a log\-based alert based on the given rule, metadata, log entry, and triggered status. It creates a new alert instance if the alert is triggered and updates the existing instance if it is already firing. It also emits an event for the log alert and triggers any actions associated with the rule. The log entry is expected to be in the format of model.LogEntry, and the metadata is expected to be in the format of model.Meta.

<a name="Manager.HandleState"></a>
### func \(\*Manager\) [HandleState](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/alerts/manager.go#L78>)

```go
func (m *Manager) HandleState(ctx context.Context, rule model.AlertRule, meta *model.Meta, value float64, triggered bool)
```

HandleState processes the state of an alert based on the given rule, metadata, value, and triggered status.

<a name="Manager.ListActive"></a>
### func \(\*Manager\) [ListActive](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/alerts/manager.go#L287>)

```go
func (m *Manager) ListActive() []model.AlertInstance
```

ListActive returns a list of all active alert instances. It iterates over the active map and appends each alert instance to a slice. The slice is then returned to the caller.

Generated by [gomarkdoc](<https://github.com/princjef/gomarkdoc>)
