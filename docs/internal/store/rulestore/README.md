<!-- Code generated by gomarkdoc. DO NOT EDIT -->

# rulestore

```go
import "github.com/aaronlmathis/gosight-server/internal/store/rulestore"
```

Package rulestore provides a rule store implementation that uses a YAML file for persistence. It implements the RuleStore interface and provides methods for adding, updating, deleting, and retrieving rules.

## Index

- [type JSONRuleStore](<#JSONRuleStore>)
  - [func NewJSONStore\(path string\) \(\*JSONRuleStore, error\)](<#NewJSONStore>)
  - [func \(j \*JSONRuleStore\) AddRule\(ctx context.Context, r model.AlertRule\) error](<#JSONRuleStore.AddRule>)
  - [func \(j \*JSONRuleStore\) DeleteRule\(ctx context.Context, id string\) error](<#JSONRuleStore.DeleteRule>)
  - [func \(j \*JSONRuleStore\) GetActiveRules\(ctx context.Context\) \(\[\]model.AlertRule, error\)](<#JSONRuleStore.GetActiveRules>)
  - [func \(s \*JSONRuleStore\) GetRuleByID\(ctx context.Context, id string\) \(model.AlertRule, error\)](<#JSONRuleStore.GetRuleByID>)
  - [func \(s \*JSONRuleStore\) GetRuleByName\(ctx context.Context, name string\) \(model.AlertRule, error\)](<#JSONRuleStore.GetRuleByName>)
  - [func \(j \*JSONRuleStore\) ListRules\(ctx context.Context\) \(\[\]model.AlertRule, error\)](<#JSONRuleStore.ListRules>)
  - [func \(j \*JSONRuleStore\) UpdateRule\(ctx context.Context, r model.AlertRule\) error](<#JSONRuleStore.UpdateRule>)
- [type MemoryRuleStore](<#MemoryRuleStore>)
  - [func NewMemoryStore\(\) \*MemoryRuleStore](<#NewMemoryStore>)
  - [func \(s \*MemoryRuleStore\) AddRule\(ctx context.Context, r model.AlertRule\) error](<#MemoryRuleStore.AddRule>)
  - [func \(s \*MemoryRuleStore\) DeleteRule\(ctx context.Context, id string\) error](<#MemoryRuleStore.DeleteRule>)
  - [func \(s \*MemoryRuleStore\) GetActiveRules\(ctx context.Context\) \(\[\]model.AlertRule, error\)](<#MemoryRuleStore.GetActiveRules>)
  - [func \(s \*MemoryRuleStore\) ListRules\(ctx context.Context\) \(\[\]model.AlertRule, error\)](<#MemoryRuleStore.ListRules>)
  - [func \(s \*MemoryRuleStore\) UpdateRule\(ctx context.Context, r model.AlertRule\) error](<#MemoryRuleStore.UpdateRule>)
- [type RuleStore](<#RuleStore>)
- [type YAMLRuleStore](<#YAMLRuleStore>)
  - [func NewYAMLStore\(path string\) \(\*YAMLRuleStore, error\)](<#NewYAMLStore>)
  - [func \(s \*YAMLRuleStore\) AddRule\(ctx context.Context, r model.AlertRule\) error](<#YAMLRuleStore.AddRule>)
  - [func \(s \*YAMLRuleStore\) DeleteRule\(ctx context.Context, id string\) error](<#YAMLRuleStore.DeleteRule>)
  - [func \(s \*YAMLRuleStore\) GetActiveRules\(ctx context.Context\) \(\[\]model.AlertRule, error\)](<#YAMLRuleStore.GetActiveRules>)
  - [func \(s \*YAMLRuleStore\) GetRuleByID\(ctx context.Context, id string\) \(model.AlertRule, error\)](<#YAMLRuleStore.GetRuleByID>)
  - [func \(s \*YAMLRuleStore\) GetRuleByName\(ctx context.Context, name string\) \(model.AlertRule, error\)](<#YAMLRuleStore.GetRuleByName>)
  - [func \(s \*YAMLRuleStore\) ListRules\(ctx context.Context\) \(\[\]model.AlertRule, error\)](<#YAMLRuleStore.ListRules>)
  - [func \(s \*YAMLRuleStore\) UpdateRule\(ctx context.Context, r model.AlertRule\) error](<#YAMLRuleStore.UpdateRule>)


<a name="JSONRuleStore"></a>
## type [JSONRuleStore](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/store/rulestore/jsonrulestore.go#L35-L39>)

JSONRuleStore is a rule store that uses a JSON file for persistence. It implements the RuleStore interface and provides methods for adding,

```go
type JSONRuleStore struct {
    // contains filtered or unexported fields
}
```

<a name="NewJSONStore"></a>
### func [NewJSONStore](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/store/rulestore/jsonrulestore.go#L43>)

```go
func NewJSONStore(path string) (*JSONRuleStore, error)
```

NewJSONStore creates a new JSONRuleStore with the specified file path. It loads existing rules from the file if it exists.

<a name="JSONRuleStore.AddRule"></a>
### func \(\*JSONRuleStore\) [AddRule](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/store/rulestore/jsonrulestore.go#L80>)

```go
func (j *JSONRuleStore) AddRule(ctx context.Context, r model.AlertRule) error
```

AddRule adds a new rule to the store. It locks the store for writing, adds the rule, and then saves the rules to the file.

<a name="JSONRuleStore.DeleteRule"></a>
### func \(\*JSONRuleStore\) [DeleteRule](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/store/rulestore/jsonrulestore.go#L96>)

```go
func (j *JSONRuleStore) DeleteRule(ctx context.Context, id string) error
```

DeleteRule removes a rule from the store. It locks the store for writing, deletes the rule, and then saves the rules to the file.

<a name="JSONRuleStore.GetActiveRules"></a>
### func \(\*JSONRuleStore\) [GetActiveRules](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/store/rulestore/jsonrulestore.go#L120>)

```go
func (j *JSONRuleStore) GetActiveRules(ctx context.Context) ([]model.AlertRule, error)
```

GetActiveRules returns a list of all active rules in the store. It calls ListRules to get all rules and filters them based on the Enabled field.

<a name="JSONRuleStore.GetRuleByID"></a>
### func \(\*JSONRuleStore\) [GetRuleByID](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/store/rulestore/jsonrulestore.go#L132>)

```go
func (s *JSONRuleStore) GetRuleByID(ctx context.Context, id string) (model.AlertRule, error)
```

GetRuleByID retrieves a rule by its ID from the JSON rule store.

<a name="JSONRuleStore.GetRuleByName"></a>
### func \(\*JSONRuleStore\) [GetRuleByName](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/store/rulestore/jsonrulestore.go#L143>)

```go
func (s *JSONRuleStore) GetRuleByName(ctx context.Context, name string) (model.AlertRule, error)
```

GetRuleByName retrieves a rule by its Name from the JSON rule store.

<a name="JSONRuleStore.ListRules"></a>
### func \(\*JSONRuleStore\) [ListRules](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/store/rulestore/jsonrulestore.go#L107>)

```go
func (j *JSONRuleStore) ListRules(ctx context.Context) ([]model.AlertRule, error)
```



<a name="JSONRuleStore.UpdateRule"></a>
### func \(\*JSONRuleStore\) [UpdateRule](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/store/rulestore/jsonrulestore.go#L90>)

```go
func (j *JSONRuleStore) UpdateRule(ctx context.Context, r model.AlertRule) error
```

UpdateRule updates an existing rule in the store. It locks the store for writing, updates the rule, and then saves the rules to the file.

<a name="MemoryRuleStore"></a>
## type [MemoryRuleStore](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/store/rulestore/memorystore.go#L33-L36>)

MemoryRuleStore is an in\-memory implementation of the RuleStore interface. It provides methods for adding, updating, deleting, and retrieving rules.

```go
type MemoryRuleStore struct {
    // contains filtered or unexported fields
}
```

<a name="NewMemoryStore"></a>
### func [NewMemoryStore](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/store/rulestore/memorystore.go#L41>)

```go
func NewMemoryStore() *MemoryRuleStore
```

NewMemoryStore creates a new MemoryRuleStore. It initializes an empty rules map. This store is not persistent and will lose data on application restart.

<a name="MemoryRuleStore.AddRule"></a>
### func \(\*MemoryRuleStore\) [AddRule](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/store/rulestore/memorystore.go#L47>)

```go
func (s *MemoryRuleStore) AddRule(ctx context.Context, r model.AlertRule) error
```

AddRule adds a new rule to the store. If a rule with the same ID already exists, it will be overwritten.

<a name="MemoryRuleStore.DeleteRule"></a>
### func \(\*MemoryRuleStore\) [DeleteRule](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/store/rulestore/memorystore.go#L62>)

```go
func (s *MemoryRuleStore) DeleteRule(ctx context.Context, id string) error
```

DeleteRule deletes a rule from the store by its ID. If the rule does not exist, it will be ignored.

<a name="MemoryRuleStore.GetActiveRules"></a>
### func \(\*MemoryRuleStore\) [GetActiveRules](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/store/rulestore/memorystore.go#L85>)

```go
func (s *MemoryRuleStore) GetActiveRules(ctx context.Context) ([]model.AlertRule, error)
```

GetActiveRules returns a list of all active rules in the store. An active rule is one that has its Enabled field set to true. It returns an empty list if no active rules are present.

<a name="MemoryRuleStore.ListRules"></a>
### func \(\*MemoryRuleStore\) [ListRules](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/store/rulestore/memorystore.go#L71>)

```go
func (s *MemoryRuleStore) ListRules(ctx context.Context) ([]model.AlertRule, error)
```

ListRules returns a list of all rules in the store. It returns an empty list if no rules are present.

<a name="MemoryRuleStore.UpdateRule"></a>
### func \(\*MemoryRuleStore\) [UpdateRule](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/store/rulestore/memorystore.go#L56>)

```go
func (s *MemoryRuleStore) UpdateRule(ctx context.Context, r model.AlertRule) error
```

UpdateRule updates an existing rule in the store. If the rule does not exist, it will be added as a new rule.

<a name="RuleStore"></a>
## type [RuleStore](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/store/rulestore/rulestore.go#L35-L43>)

RuleStore defines the interface for managing alert rules.

```go
type RuleStore interface {
    AddRule(ctx context.Context, rule model.AlertRule) error
    UpdateRule(ctx context.Context, rule model.AlertRule) error
    DeleteRule(ctx context.Context, id string) error
    GetActiveRules(ctx context.Context) ([]model.AlertRule, error)
    GetRuleByID(ctx context.Context, id string) (model.AlertRule, error)
    GetRuleByName(ctx context.Context, name string) (model.AlertRule, error)
    ListRules(ctx context.Context) ([]model.AlertRule, error)
}
```

<a name="YAMLRuleStore"></a>
## type [YAMLRuleStore](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/store/rulestore/yamlrulestore.go#L39-L43>)

YAMLRuleStore is a rule store that uses a YAML file for persistence. It implements the RuleStore interface and provides methods for adding, updating, deleting, and retrieving rules.

```go
type YAMLRuleStore struct {
    // contains filtered or unexported fields
}
```

<a name="NewYAMLStore"></a>
### func [NewYAMLStore](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/store/rulestore/yamlrulestore.go#L46>)

```go
func NewYAMLStore(path string) (*YAMLRuleStore, error)
```

NewYAMLStore creates a new YAMLRuleStore with the specified file path.

<a name="YAMLRuleStore.AddRule"></a>
### func \(\*YAMLRuleStore\) [AddRule](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/store/rulestore/yamlrulestore.go#L98>)

```go
func (s *YAMLRuleStore) AddRule(ctx context.Context, r model.AlertRule) error
```

AddRule adds a new rule to the store.

<a name="YAMLRuleStore.DeleteRule"></a>
### func \(\*YAMLRuleStore\) [DeleteRule](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/store/rulestore/yamlrulestore.go#L111>)

```go
func (s *YAMLRuleStore) DeleteRule(ctx context.Context, id string) error
```

DeleteRule removes a rule from the store.

<a name="YAMLRuleStore.GetActiveRules"></a>
### func \(\*YAMLRuleStore\) [GetActiveRules](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/store/rulestore/yamlrulestore.go#L133>)

```go
func (s *YAMLRuleStore) GetActiveRules(ctx context.Context) ([]model.AlertRule, error)
```



<a name="YAMLRuleStore.GetRuleByID"></a>
### func \(\*YAMLRuleStore\) [GetRuleByID](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/store/rulestore/yamlrulestore.go#L145>)

```go
func (s *YAMLRuleStore) GetRuleByID(ctx context.Context, id string) (model.AlertRule, error)
```

GetRuleByID retrieves a rule by its ID.

<a name="YAMLRuleStore.GetRuleByName"></a>
### func \(\*YAMLRuleStore\) [GetRuleByName](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/store/rulestore/yamlrulestore.go#L156>)

```go
func (s *YAMLRuleStore) GetRuleByName(ctx context.Context, name string) (model.AlertRule, error)
```

GetRuleByName retrieves a rule by its Name \(case\-sensitive\).

<a name="YAMLRuleStore.ListRules"></a>
### func \(\*YAMLRuleStore\) [ListRules](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/store/rulestore/yamlrulestore.go#L119>)

```go
func (s *YAMLRuleStore) ListRules(ctx context.Context) ([]model.AlertRule, error)
```

ListRules returns a list of all rules in the store.

<a name="YAMLRuleStore.UpdateRule"></a>
### func \(\*YAMLRuleStore\) [UpdateRule](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/store/rulestore/yamlrulestore.go#L106>)

```go
func (s *YAMLRuleStore) UpdateRule(ctx context.Context, r model.AlertRule) error
```

UpdateRule updates an existing rule in the store.

Generated by [gomarkdoc](<https://github.com/princjef/gomarkdoc>)
