<!-- Code generated by gomarkdoc. DO NOT EDIT -->

# cache

```go
import "github.com/aaronlmathis/gosight-server/internal/cache"
```

File: gosight\-server/internal/cache/cache.go Description: Package cache provides a unified cache for the GoSight server. It includes caches for processes, metrics, tags, logs, and other components. The cache is used to store and retrieve data efficiently.

File: gosight\-server/internal/cache/helpers.go Description: helpers.go contains utility functions for the cache package. These functions are used to manipulate and query the cache data structures.

Package cache provides a unified cache for the GoSight server. It includes caches for processes, metrics, tags, logs, and other components.

## Index

- [func AddMetaFieldsToLabels\(meta \*model.Meta, labels map\[string\]StringSet\)](<#AddMetaFieldsToLabels>)
- [type Cache](<#Cache>)
- [type LogCache](<#LogCache>)
  - [func NewLogCache\(\) LogCache](<#NewLogCache>)
- [type MetricCache](<#MetricCache>)
  - [func NewMetricCache\(\) MetricCache](<#NewMetricCache>)
- [type MetricEntry](<#MetricEntry>)
- [type ProcessCache](<#ProcessCache>)
  - [func NewProcessCache\(\) ProcessCache](<#NewProcessCache>)
- [type StringSet](<#StringSet>)
  - [func \(s StringSet\) Add\(val string\)](<#StringSet.Add>)
- [type TagCache](<#TagCache>)
  - [func NewTagCache\(\) TagCache](<#NewTagCache>)


<a name="AddMetaFieldsToLabels"></a>
## func [AddMetaFieldsToLabels](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/cache/metrics.go#L438>)

```go
func AddMetaFieldsToLabels(meta *model.Meta, labels map[string]StringSet)
```

AddMetaFieldsToLabels adds metadata fields to the labels map. It takes a pointer to a model.Meta object and a map of labels. The function adds various metadata fields \(e.g., agent ID, host ID, etc.\) to the labels map, ensuring that the keys and values are unique.

<a name="Cache"></a>
## type [Cache](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/cache/cache.go#L31-L42>)

Cache is a struct that holds all the caches used in the GoSight server. It includes caches for processes, metrics, tags, logs, and other components. Each cache is represented by a specific type, such as ProcessCache, MetricCache, TagCache, and LogCache.

```go
type Cache struct {
    Processes ProcessCache
    Metrics   MetricCache
    Tags      TagCache
    Logs      LogCache
}
```

<a name="LogCache"></a>
## type [LogCache](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/cache/logcache.go#L34-L38>)

LogCache is an interface that defines methods for adding and retrieving log entries. It is used to cache log entries for quick access and retrieval. The cache is thread\-safe and uses a mutex to synchronize access to the underlying data structure.

```go
type LogCache interface {
    Add(batch []*model.StoredLog)
    Get(logID string) (*model.LogEntry, bool)
    GetLogs() []*model.StoredLog
}
```

<a name="NewLogCache"></a>
### func [NewLogCache](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/cache/logcache.go#L50>)

```go
func NewLogCache() LogCache
```



<a name="MetricCache"></a>
## type [MetricCache](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/cache/metrics.go#L39-L59>)

MetricCache is an in\-memory cache for metrics as well as their meta data and tags. It is used to store and retrieve metric information efficiently. The cache is designed to be thread\-safe and allows concurrent access. It uses a mutex to synchronize access to the underlying data structure.

```go
type MetricCache interface {
    Add(payload *model.MetricPayload)
    GetNamespaces() []string                                // Get all known namespaces
    GetSubNamespaces(nameSpace string) []string             // Get all subnamespaces for a namespace
    GetMetricNames(nameSpace, subNamespace string) []string // Get all metric names for Namespace+Subnamespace

    GetAllMetricNames() []string                    // Get all known metric names
    GetAvailableDimensions() map[string][]string    // Get all available dimensions (known)
    GetMetricDimensions(metricName string) []string // Get all dimension keys known for a metric

    GetAllTagKeys() []string                   // Get all known tag keys
    GetAllTagValuesForKey(key string) []string // Get all known values for tag key

    GetAllKnownLabelValues(label, contains string) []string  // Get all known values for a given label key (dimensions + tags) (optionally filtered)
    GetLabelValues(label, contains string) []string          // Get all label values for a known label (optionally filtered)
    GetMetricsWithLabels(filters map[string]string) []string // Get all metric names that match a given label filter

    Prune()

    GetAllEntries() []*MetricEntry
}
```

<a name="NewMetricCache"></a>
### func [NewMetricCache](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/cache/metrics.go#L98>)

```go
func NewMetricCache() MetricCache
```

NewMetricCache creates a new instance of MetricCache. It initializes the cache with empty maps for namespaces, subnamespaces, metric entries, label values, endpoint metadata, and last seen timestamps. The cache is designed to be thread\-safe and allows concurrent access.

<a name="MetricEntry"></a>
## type [MetricEntry](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/cache/metrics.go#L66-L77>)

MetricEntry represents a metric entry in the cache. It contains information about the metric, including its namespace, subnamespace, name, unit, type, dimensions, labels, tags, and emitters. The dimensions and labels are stored as maps of string sets, allowing for efficient membership testing and uniqueness.

```go
type MetricEntry struct {
    Namespace string
    SubNS     string
    Name      string
    Unit      string
    Type      string

    Dimensions map[string]StringSet // Dimensions are metric specific key value pairs, added by collectors
    Labels     map[string]StringSet // Labels are a superset of dimensions, including custom user-defined tags and meta fields
    Tags       map[string]StringSet // Tags are user-defined key value pairs, added by the user in the Meta
    Emitters   map[string]struct{}  // endpoint IDs
}
```

<a name="ProcessCache"></a>
## type [ProcessCache](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/cache/processes.go#L34-L38>)

ProcessCache stores recent process snapshots per endpoint.

```go
type ProcessCache interface {
    Add(snapshot model.ProcessSnapshot)
    Get(endpointID string) []model.ProcessSnapshot
    Prune()
}
```

<a name="NewProcessCache"></a>
### func [NewProcessCache](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/cache/processes.go#L51>)

```go
func NewProcessCache() ProcessCache
```

NewProcessCache creates a new instance of ProcessCache. It initializes the cache with an empty map for storing process snapshots. The cache is protected by a mutex to ensure thread safety.

<a name="StringSet"></a>
## type [StringSet](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/cache/helpers.go#L33>)

StringSet is a set of strings, implemented as a map with empty struct values. This allows for efficient membership testing and uniqueness. The empty struct consumes no memory, so this is a memory\-efficient way to store a set of strings. The zero value of StringSet is an empty set.

```go
type StringSet map[string]struct{}
```

<a name="StringSet.Add"></a>
### func \(StringSet\) [Add](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/cache/tags.go#L33>)

```go
func (s StringSet) Add(val string)
```

Add adds a value to the StringSet

<a name="TagCache"></a>
## type [TagCache](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/cache/tags.go#L42-L54>)



```go
type TagCache interface {
    Add(payload *model.MetricPayload)
    GetTagsForEndpoint(endpointID string) map[string]StringSet
    GetFlattenedTagsForEndpoint(endpointID string) map[string]string
    GetTagKeys() []string
    GetTagValues(key string) StringSet
    Flush(dataStore datastore.DataStore)
    LoadFromStore(tags []model.Tag)
    Prune()

    // For debugtools
    GetAllEndpoints() map[string]map[string]StringSet
}
```

<a name="NewTagCache"></a>
### func [NewTagCache](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/cache/tags.go#L75>)

```go
func NewTagCache() TagCache
```

NewTagCache creates a new TagCache It initializes the maps to avoid nil checks later It is not thread\-safe and should only be called once at startup

Generated by [gomarkdoc](<https://github.com/princjef/gomarkdoc>)
