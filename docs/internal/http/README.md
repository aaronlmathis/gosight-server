<!-- Code generated by gomarkdoc. DO NOT EDIT -->

# httpserver

```go
import "github.com/aaronlmathis/gosight-server/internal/http"
```

File: server/internal/http/handleAlertContextAPI.go

Basic Handler for http server server/internal/http/handler.go

server/internal/http/router.go Router for HTTPServer

## Index

- [func FilterAgents\(list \[\]\*model.Agent, filter EndpointFilter\) \[\]\*model.Agent](<#FilterAgents>)
- [func FilterContainers\(list \[\]\*model.Container, filter EndpointFilter\) \[\]\*model.Container](<#FilterContainers>)
- [func GetFlash\(w http.ResponseWriter, r \*http.Request\) string](<#GetFlash>)
- [func InjectUserContext\(ctx context.Context, user \*usermodel.User\) context.Context](<#InjectUserContext>)
- [func SetFlash\(w http.ResponseWriter, message string\)](<#SetFlash>)
- [func SortAndLimitAgents\(list \[\]\*model.Agent, sortBy, order string, limit int\) \[\]\*model.Agent](<#SortAndLimitAgents>)
- [func SortAndLimitContainers\(list \[\]\*model.Container, sortBy, order string, limit int\) \[\]\*model.Container](<#SortAndLimitContainers>)
- [func SortBy\(alerts \*\[\]model.AlertInstance, field, order string\)](<#SortBy>)
- [type APIMetricStore](<#APIMetricStore>)
  - [func \(a \*APIMetricStore\) Close\(\) error](<#APIMetricStore.Close>)
  - [func \(a \*APIMetricStore\) FetchDimensionsForMetric\(metric string\) \(\[\]string, error\)](<#APIMetricStore.FetchDimensionsForMetric>)
  - [func \(a \*APIMetricStore\) QueryInstant\(metric string, filters map\[string\]string\) \(\[\]model.MetricRow, error\)](<#APIMetricStore.QueryInstant>)
  - [func \(a \*APIMetricStore\) QueryMultiInstant\(metricNames \[\]string, filters map\[string\]string\) \(\[\]model.MetricRow, error\)](<#APIMetricStore.QueryMultiInstant>)
  - [func \(a \*APIMetricStore\) QueryMultiRange\(metrics \[\]string, start, end time.Time, step string, filters map\[string\]string\) \(\[\]model.MetricRow, error\)](<#APIMetricStore.QueryMultiRange>)
  - [func \(a \*APIMetricStore\) QueryRange\(metric string, start, end time.Time, step string, filters map\[string\]string\) \(\[\]model.Point, error\)](<#APIMetricStore.QueryRange>)
  - [func \(a \*APIMetricStore\) Write\(metrics \[\]model.MetricPayload\) error](<#APIMetricStore.Write>)
- [type AlertContextResponse](<#AlertContextResponse>)
- [type ContainerMetrics](<#ContainerMetrics>)
- [type ContainerRow](<#ContainerRow>)
- [type EndpointFilter](<#EndpointFilter>)
  - [func ParseEndpointFilters\(r \*http.Request\) EndpointFilter](<#ParseEndpointFilters>)
- [type HostRow](<#HostRow>)
- [type HttpServer](<#HttpServer>)
  - [func NewServer\(sys \*sys.SystemContext\) \*HttpServer](<#NewServer>)
  - [func \(s \*HttpServer\) BuildAuthEventMeta\(user \*usermodel.User, r \*http.Request\) map\[string\]string](<#HttpServer.BuildAuthEventMeta>)
  - [func \(s \*HttpServer\) GetDimensions\(w http.ResponseWriter, r \*http.Request\)](<#HttpServer.GetDimensions>)
  - [func \(s \*HttpServer\) GetMetricData\(w http.ResponseWriter, r \*http.Request\)](<#HttpServer.GetMetricData>)
  - [func \(s \*HttpServer\) GetMetricDimensions\(w http.ResponseWriter, r \*http.Request\)](<#HttpServer.GetMetricDimensions>)
  - [func \(s \*HttpServer\) GetMetricLatest\(w http.ResponseWriter, r \*http.Request\)](<#HttpServer.GetMetricLatest>)
  - [func \(s \*HttpServer\) GetMetricNames\(w http.ResponseWriter, r \*http.Request\)](<#HttpServer.GetMetricNames>)
  - [func \(s \*HttpServer\) GetNamespaces\(w http.ResponseWriter, r \*http.Request\)](<#HttpServer.GetNamespaces>)
  - [func \(s \*HttpServer\) GetSubNamespaces\(w http.ResponseWriter, r \*http.Request\)](<#HttpServer.GetSubNamespaces>)
  - [func \(s \*HttpServer\) HandleAPIQuery\(w http.ResponseWriter, r \*http.Request\)](<#HttpServer.HandleAPIQuery>)
  - [func \(s \*HttpServer\) HandleActiveAlertsAPI\(w http.ResponseWriter, r \*http.Request\)](<#HttpServer.HandleActiveAlertsAPI>)
  - [func \(s \*HttpServer\) HandleActivityPage\(w http.ResponseWriter, r \*http.Request\)](<#HttpServer.HandleActivityPage>)
  - [func \(s \*HttpServer\) HandleAddAlertRulePage\(w http.ResponseWriter, r \*http.Request\)](<#HttpServer.HandleAddAlertRulePage>)
  - [func \(s \*HttpServer\) HandleAgentsAPI\(w http.ResponseWriter, r \*http.Request\)](<#HttpServer.HandleAgentsAPI>)
  - [func \(s \*HttpServer\) HandleAgentsPage\(w http.ResponseWriter, r \*http.Request, templateDir, env string\)](<#HttpServer.HandleAgentsPage>)
  - [func \(s \*HttpServer\) HandleAlertContext\(w http.ResponseWriter, r \*http.Request\)](<#HttpServer.HandleAlertContext>)
  - [func \(s \*HttpServer\) HandleAlertRulesAPI\(w http.ResponseWriter, r \*http.Request\)](<#HttpServer.HandleAlertRulesAPI>)
  - [func \(s \*HttpServer\) HandleAlertsAPI\(w http.ResponseWriter, r \*http.Request\)](<#HttpServer.HandleAlertsAPI>)
  - [func \(s \*HttpServer\) HandleAlertsActivePage\(w http.ResponseWriter, r \*http.Request\)](<#HttpServer.HandleAlertsActivePage>)
  - [func \(s \*HttpServer\) HandleAlertsHistoryPage\(w http.ResponseWriter, r \*http.Request\)](<#HttpServer.HandleAlertsHistoryPage>)
  - [func \(s \*HttpServer\) HandleAlertsPage\(w http.ResponseWriter, r \*http.Request\)](<#HttpServer.HandleAlertsPage>)
  - [func \(s \*HttpServer\) HandleAlertsSummaryAPI\(w http.ResponseWriter, r \*http.Request\)](<#HttpServer.HandleAlertsSummaryAPI>)
  - [func \(s \*HttpServer\) HandleCacheAudit\(w http.ResponseWriter, r \*http.Request\)](<#HttpServer.HandleCacheAudit>)
  - [func \(s \*HttpServer\) HandleCallback\(w http.ResponseWriter, r \*http.Request\)](<#HttpServer.HandleCallback>)
  - [func \(s \*HttpServer\) HandleCommandsAPI\(w http.ResponseWriter, r \*http.Request\)](<#HttpServer.HandleCommandsAPI>)
  - [func \(s \*HttpServer\) HandleContainers\(w http.ResponseWriter, r \*http.Request\)](<#HttpServer.HandleContainers>)
  - [func \(s \*HttpServer\) HandleCreateAlertRuleAPI\(w http.ResponseWriter, r \*http.Request\)](<#HttpServer.HandleCreateAlertRuleAPI>)
  - [func \(s \*HttpServer\) HandleDeleteTag\(w http.ResponseWriter, r \*http.Request\)](<#HttpServer.HandleDeleteTag>)
  - [func \(s \*HttpServer\) HandleEndpointDetail\(w http.ResponseWriter, r \*http.Request\)](<#HttpServer.HandleEndpointDetail>)
  - [func \(s \*HttpServer\) HandleEndpointPage\(w http.ResponseWriter, r \*http.Request\)](<#HttpServer.HandleEndpointPage>)
  - [func \(s \*HttpServer\) HandleEndpointsAPI\(w http.ResponseWriter, r \*http.Request\)](<#HttpServer.HandleEndpointsAPI>)
  - [func \(s \*HttpServer\) HandleEndpointsByTypeAPI\(w http.ResponseWriter, r \*http.Request\)](<#HttpServer.HandleEndpointsByTypeAPI>)
  - [func \(s \*HttpServer\) HandleEventsAPI\(w http.ResponseWriter, r \*http.Request\)](<#HttpServer.HandleEventsAPI>)
  - [func \(s \*HttpServer\) HandleExportQuery\(w http.ResponseWriter, r \*http.Request\)](<#HttpServer.HandleExportQuery>)
  - [func \(s \*HttpServer\) HandleGetTags\(w http.ResponseWriter, r \*http.Request\)](<#HttpServer.HandleGetTags>)
  - [func \(s \*HttpServer\) HandleGlobalSearchAPI\(w http.ResponseWriter, r \*http.Request\)](<#HttpServer.HandleGlobalSearchAPI>)
  - [func \(s \*HttpServer\) HandleIndexPage\(w http.ResponseWriter, r \*http.Request\)](<#HttpServer.HandleIndexPage>)
  - [func \(s \*HttpServer\) HandleLabelValues\(w http.ResponseWriter, r \*http.Request\)](<#HttpServer.HandleLabelValues>)
  - [func \(s \*HttpServer\) HandleLogAPI\(w http.ResponseWriter, r \*http.Request\)](<#HttpServer.HandleLogAPI>)
  - [func \(s \*HttpServer\) HandleLogin\(w http.ResponseWriter, r \*http.Request\)](<#HttpServer.HandleLogin>)
  - [func \(s \*HttpServer\) HandleLoginStart\(w http.ResponseWriter, r \*http.Request\)](<#HttpServer.HandleLoginStart>)
  - [func \(s \*HttpServer\) HandleLogout\(w http.ResponseWriter, r \*http.Request\)](<#HttpServer.HandleLogout>)
  - [func \(s \*HttpServer\) HandleLogsPage\(w http.ResponseWriter, r \*http.Request\)](<#HttpServer.HandleLogsPage>)
  - [func \(s \*HttpServer\) HandleMFA\(w http.ResponseWriter, r \*http.Request\)](<#HttpServer.HandleMFA>)
  - [func \(s \*HttpServer\) HandleMFAPage\(w http.ResponseWriter, r \*http.Request\)](<#HttpServer.HandleMFAPage>)
  - [func \(s \*HttpServer\) HandleMetricExplorerPage\(w http.ResponseWriter, r \*http.Request\)](<#HttpServer.HandleMetricExplorerPage>)
  - [func \(s \*HttpServer\) HandlePatchTags\(w http.ResponseWriter, r \*http.Request\)](<#HttpServer.HandlePatchTags>)
  - [func \(s \*HttpServer\) HandleRecentLogs\(w http.ResponseWriter, r \*http.Request\)](<#HttpServer.HandleRecentLogs>)
  - [func \(s \*HttpServer\) HandleSetTags\(w http.ResponseWriter, r \*http.Request\)](<#HttpServer.HandleSetTags>)
  - [func \(s \*HttpServer\) HandleTagKeys\(w http.ResponseWriter, r \*http.Request\)](<#HttpServer.HandleTagKeys>)
  - [func \(s \*HttpServer\) HandleTagValues\(w http.ResponseWriter, r \*http.Request\)](<#HttpServer.HandleTagValues>)
  - [func \(s \*HttpServer\) Shutdown\(\) error](<#HttpServer.Shutdown>)
  - [func \(s \*HttpServer\) Start\(\) error](<#HttpServer.Start>)
- [type LogResponse](<#LogResponse>)
- [type SearchResult](<#SearchResult>)


<a name="FilterAgents"></a>
## func [FilterAgents](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/http/handleEndpoints.go#L284>)

```go
func FilterAgents(list []*model.Agent, filter EndpointFilter) []*model.Agent
```

FilterAgents filters a list of agents based on the provided filter criteria. It checks for matching endpoint ID, hostname, status, host ID, tags, and last seen time. The filtered list is then sorted and limited based on the specified criteria.

<a name="FilterContainers"></a>
## func [FilterContainers](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/http/handleEndpoints.go#L397>)

```go
func FilterContainers(list []*model.Container, filter EndpointFilter) []*model.Container
```

FilterContainers filters a list of containers based on the provided filter criteria. It checks for matching endpoint ID, hostname, status, host ID, tags, and last seen time. The filtered list is then sorted and limited based on the specified criteria.

<a name="GetFlash"></a>
## func [GetFlash](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/http/flash.go#L47>)

```go
func GetFlash(w http.ResponseWriter, r *http.Request) string
```



<a name="InjectUserContext"></a>
## func [InjectUserContext](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/http/context.go#L11>)

```go
func InjectUserContext(ctx context.Context, user *usermodel.User) context.Context
```



<a name="SetFlash"></a>
## func [SetFlash](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/http/flash.go#L35>)

```go
func SetFlash(w http.ResponseWriter, message string)
```



<a name="SortAndLimitAgents"></a>
## func [SortAndLimitAgents](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/http/handleEndpoints.go#L432>)

```go
func SortAndLimitAgents(list []*model.Agent, sortBy, order string, limit int) []*model.Agent
```

SortAndLimitAgents sorts a list of agents based on the specified criteria and limits the number of results. It sorts by hostname or last seen time, and can reverse the order.

<a name="SortAndLimitContainers"></a>
## func [SortAndLimitContainers](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/http/handleEndpoints.go#L454>)

```go
func SortAndLimitContainers(list []*model.Container, sortBy, order string, limit int) []*model.Container
```

SortAndLimitContainers sorts a list of containers based on the specified criteria and limits the number of results. It sorts by name or last seen time, and can reverse the order.

<a name="SortBy"></a>
## func [SortBy](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/http/handleAlertsAPI.go#L206>)

```go
func SortBy(alerts *[]model.AlertInstance, field, order string)
```



<a name="APIMetricStore"></a>
## type [APIMetricStore](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/http/apistore.go#L13-L15>)



```go
type APIMetricStore struct {
    Store metricstore.MetricStore
}
```

<a name="APIMetricStore.Close"></a>
### func \(\*APIMetricStore\) [Close](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/http/apistore.go#L21>)

```go
func (a *APIMetricStore) Close() error
```



<a name="APIMetricStore.FetchDimensionsForMetric"></a>
### func \(\*APIMetricStore\) [FetchDimensionsForMetric](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/http/apistore.go#L41>)

```go
func (a *APIMetricStore) FetchDimensionsForMetric(metric string) ([]string, error)
```



<a name="APIMetricStore.QueryInstant"></a>
### func \(\*APIMetricStore\) [QueryInstant](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/http/apistore.go#L25>)

```go
func (a *APIMetricStore) QueryInstant(metric string, filters map[string]string) ([]model.MetricRow, error)
```



<a name="APIMetricStore.QueryMultiInstant"></a>
### func \(\*APIMetricStore\) [QueryMultiInstant](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/http/apistore.go#L34>)

```go
func (a *APIMetricStore) QueryMultiInstant(metricNames []string, filters map[string]string) ([]model.MetricRow, error)
```



<a name="APIMetricStore.QueryMultiRange"></a>
### func \(\*APIMetricStore\) [QueryMultiRange](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/http/apistore.go#L37>)

```go
func (a *APIMetricStore) QueryMultiRange(metrics []string, start, end time.Time, step string, filters map[string]string) ([]model.MetricRow, error)
```



<a name="APIMetricStore.QueryRange"></a>
### func \(\*APIMetricStore\) [QueryRange](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/http/apistore.go#L30>)

```go
func (a *APIMetricStore) QueryRange(metric string, start, end time.Time, step string, filters map[string]string) ([]model.Point, error)
```



<a name="APIMetricStore.Write"></a>
### func \(\*APIMetricStore\) [Write](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/http/apistore.go#L17>)

```go
func (a *APIMetricStore) Write(metrics []model.MetricPayload) error
```



<a name="AlertContextResponse"></a>
## type [AlertContextResponse](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/http/handleAlertsContextAPI.go#L34-L38>)



```go
type AlertContextResponse struct {
    Alert  model.AlertInstance `json:"alert"`
    Logs   []model.LogEntry    `json:"logs"`
    Events []model.EventEntry  `json:"events"`
}
```

<a name="ContainerMetrics"></a>
## type [ContainerMetrics](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/http/containers.go#L37-L49>)



```go
type ContainerMetrics struct {
    Host   string            `json:"host"`
    Name   string            `json:"name"`
    Image  string            `json:"image"`
    Status string            `json:"status"`
    CPU    *float64          `json:"cpu,omitempty"`
    Mem    *float64          `json:"mem,omitempty"`
    RX     *float64          `json:"rx,omitempty"`
    TX     *float64          `json:"tx,omitempty"`
    Uptime *float64          `json:"uptime,omitempty"`
    Labels map[string]string `json:"labels,omitempty"`
    Ports  string            `json:"ports,omitempty"`
}
```

<a name="ContainerRow"></a>
## type [ContainerRow](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/http/handleEndpoints.go#L51-L61>)



```go
type ContainerRow struct {
    ID     string
    Name   string
    Image  string
    Status string
    CPU    string
    Mem    string
    RX     string
    TX     string
    Uptime string
}
```

<a name="EndpointFilter"></a>
## type [EndpointFilter](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/http/handleEndpoints.go#L147-L162>)



```go
type EndpointFilter struct {
    EndpointID string
    Hostname   string
    Status     string
    HostID     string
    IP         string // ← Add this
    OS         string
    Arch       string

    Tags        map[string]string
    LastSeenMin time.Duration
    LastSeenMax time.Duration
    Limit       int
    Sort        string
    Order       string
}
```

<a name="ParseEndpointFilters"></a>
### func [ParseEndpointFilters](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/http/handleEndpoints.go#L167>)

```go
func ParseEndpointFilters(r *http.Request) EndpointFilter
```

ParseEndpointFilters parses the query parameters from the request and returns an EndpointFilter struct. It extracts the endpoint ID, hostname, status, host ID, IP address, OS, architecture, tags, last seen time range, limit, sort field, and order \(ascending/descending\).

<a name="HostRow"></a>
## type [HostRow](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/http/handleEndpoints.go#L46-L49>)



```go
type HostRow struct {
    Agent   model.Agent
    Metrics map[string]string // uptime, cpu %, mem %, etc.
}
```

<a name="HttpServer"></a>
## type [HttpServer](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/http/httpserver.go#L37-L42>)



```go
type HttpServer struct {
    Router *mux.Router
    Sys    *sys.SystemContext
    Tmpl   *gosighttemplate.GoSightTemplate
    // contains filtered or unexported fields
}
```

<a name="NewServer"></a>
### func [NewServer](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/http/httpserver.go#L46>)

```go
func NewServer(sys *sys.SystemContext) *HttpServer
```

NewServer creates a new HTTP server instance with the provided system context. It initializes the router and sets up the server configuration.

<a name="HttpServer.BuildAuthEventMeta"></a>
### func \(\*HttpServer\) [BuildAuthEventMeta](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/http/helpers.go#L41>)

```go
func (s *HttpServer) BuildAuthEventMeta(user *usermodel.User, r *http.Request) map[string]string
```



<a name="HttpServer.GetDimensions"></a>
### func \(\*HttpServer\) [GetDimensions](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/http/handleMetricCacheAPI.go#L84>)

```go
func (s *HttpServer) GetDimensions(w http.ResponseWriter, r *http.Request)
```

GetDimensions retrieves all available dimensions. It returns a JSON object containing the dimensions. The URL format is: /api/v1/dimensions

<a name="HttpServer.GetMetricData"></a>
### func \(\*HttpServer\) [GetMetricData](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/http/handleMetricCacheAPI.go#L113>)

```go
func (s *HttpServer) GetMetricData(w http.ResponseWriter, r *http.Request)
```

GetMetricData retrieves metric data for a specific metric. It accepts a namespace, subnamespace, and metric name as URL parameters. The response is a JSON object containing the metric data. The URL format is: /api/v1/\{namespace\}/\{sub\}/\{metric\}/data

<a name="HttpServer.GetMetricDimensions"></a>
### func \(\*HttpServer\) [GetMetricDimensions](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/http/handleMetricCacheAPI.go#L92>)

```go
func (s *HttpServer) GetMetricDimensions(w http.ResponseWriter, r *http.Request)
```

GetMetricDimensions retrieves the dimensions for a specific metric. It accepts a namespace, subnamespace, and metric name as URL parameters. The response is a JSON object containing the dimensions. The URL format is: /api/v1/\{namespace\}/\{sub\}/\{metric\}/dimensions

<a name="HttpServer.GetMetricLatest"></a>
### func \(\*HttpServer\) [GetMetricLatest](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/http/handleMetricCacheAPI.go#L164>)

```go
func (s *HttpServer) GetMetricLatest(w http.ResponseWriter, r *http.Request)
```

GetMetricLatest retrieves the latest value for a specific metric. It accepts a namespace, subnamespace, and metric name as URL parameters. The response is a JSON object containing the latest value and timestamp. The URL format is: /api/v1/\{namespace\}/\{sub\}/\{metric\}/latest

<a name="HttpServer.GetMetricNames"></a>
### func \(\*HttpServer\) [GetMetricNames](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/http/handleMetricCacheAPI.go#L69>)

```go
func (s *HttpServer) GetMetricNames(w http.ResponseWriter, r *http.Request)
```

GetMetricNames retrieves all metric names for a given namespace and subnamespace. It returns a JSON object containing the metric names. The URL format is: /api/v1/\{namespace\}/\{sub\}/metrics

<a name="HttpServer.GetNamespaces"></a>
### func \(\*HttpServer\) [GetNamespaces](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/http/handleMetricCacheAPI.go#L47>)

```go
func (s *HttpServer) GetNamespaces(w http.ResponseWriter, r *http.Request)
```

GetNamespaces retrieves all namespaces. It returns a JSON object containing the namespaces. The URL format is: /api/v1/

<a name="HttpServer.GetSubNamespaces"></a>
### func \(\*HttpServer\) [GetSubNamespaces](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/http/handleMetricCacheAPI.go#L56>)

```go
func (s *HttpServer) GetSubNamespaces(w http.ResponseWriter, r *http.Request)
```

GetSubNamespaces retrieves all sub\-namespaces for a given namespace. It returns a JSON object containing the sub\-namespaces. The URL format is: /api/v1/\{namespace\}

<a name="HttpServer.HandleAPIQuery"></a>
### func \(\*HttpServer\) [HandleAPIQuery](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/http/handleMetricCacheAPI.go#L203>)

```go
func (s *HttpServer) HandleAPIQuery(w http.ResponseWriter, r *http.Request)
```

HandleAPIQuery handles flexible label\-based queries without requiring a metric name. Supports optional time range via start= and end= query params. It also supports sorting and limiting the results. The query parameters are: \- metric: the metric name\(s\) to query \- start: the start time for the query \(RFC3339 format\) \- end: the end time for the query \(RFC3339 format\) \- step: the step interval for the query \(default is 15s\) \- limit: the maximum number of results to return \- sort: the sort order for the results \(asc or desc\) \- tags: additional filters for the query \(key=value pairs\) The response is a JSON object containing the query results.

<a name="HttpServer.HandleActiveAlertsAPI"></a>
### func \(\*HttpServer\) [HandleActiveAlertsAPI](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/http/handleAlertsAPI.go#L94>)

```go
func (s *HttpServer) HandleActiveAlertsAPI(w http.ResponseWriter, r *http.Request)
```



<a name="HttpServer.HandleActivityPage"></a>
### func \(\*HttpServer\) [HandleActivityPage](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/http/handleActivity.go#L36>)

```go
func (s *HttpServer) HandleActivityPage(w http.ResponseWriter, r *http.Request)
```

HandleActivityPage handles requests to the activity page.

<a name="HttpServer.HandleAddAlertRulePage"></a>
### func \(\*HttpServer\) [HandleAddAlertRulePage](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/http/handleAlerts.go#L145>)

```go
func (s *HttpServer) HandleAddAlertRulePage(w http.ResponseWriter, r *http.Request)
```



<a name="HttpServer.HandleAgentsAPI"></a>
### func \(\*HttpServer\) [HandleAgentsAPI](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/http/handleAgents.go#L70>)

```go
func (s *HttpServer) HandleAgentsAPI(w http.ResponseWriter, r *http.Request)
```

// HandleAgentsAPI returns a JSON list of active agents

```
func (s *HttpServer) HandleAgentsAPI(w http.ResponseWriter, r *http.Request) {
	agents := s.Sys.Agents.GetAgents()

	sort.SliceStable(agents, func(i, j int) bool {
		return agents[i].Hostname < agents[j].Hostname
	})

	w.Header().Set("Content-Type", "application/json")
	_ = json.NewEncoder(w).Encode(agents)
}
```

<a name="HttpServer.HandleAgentsPage"></a>
### func \(\*HttpServer\) [HandleAgentsPage](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/http/handleAgents.go#L39>)

```go
func (s *HttpServer) HandleAgentsPage(w http.ResponseWriter, r *http.Request, templateDir, env string)
```

RenderAgentsPage serves the agents.html template

<a name="HttpServer.HandleAlertContext"></a>
### func \(\*HttpServer\) [HandleAlertContext](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/http/handleAlertsContextAPI.go#L40>)

```go
func (s *HttpServer) HandleAlertContext(w http.ResponseWriter, r *http.Request)
```



<a name="HttpServer.HandleAlertRulesAPI"></a>
### func \(\*HttpServer\) [HandleAlertRulesAPI](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/http/handleAlertsAPI.go#L111>)

```go
func (s *HttpServer) HandleAlertRulesAPI(w http.ResponseWriter, r *http.Request)
```



<a name="HttpServer.HandleAlertsAPI"></a>
### func \(\*HttpServer\) [HandleAlertsAPI](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/http/handleAlertsAPI.go#L42>)

```go
func (s *HttpServer) HandleAlertsAPI(w http.ResponseWriter, r *http.Request)
```



<a name="HttpServer.HandleAlertsActivePage"></a>
### func \(\*HttpServer\) [HandleAlertsActivePage](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/http/handleAlerts.go#L72>)

```go
func (s *HttpServer) HandleAlertsActivePage(w http.ResponseWriter, r *http.Request)
```



<a name="HttpServer.HandleAlertsHistoryPage"></a>
### func \(\*HttpServer\) [HandleAlertsHistoryPage](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/http/handleAlerts.go#L108>)

```go
func (s *HttpServer) HandleAlertsHistoryPage(w http.ResponseWriter, r *http.Request)
```

HandleAlertsHistoryPage handles the page for viewing alert history at /alerts/history

<a name="HttpServer.HandleAlertsPage"></a>
### func \(\*HttpServer\) [HandleAlertsPage](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/http/handleAlerts.go#L35>)

```go
func (s *HttpServer) HandleAlertsPage(w http.ResponseWriter, r *http.Request)
```

HandleAlertsHistoryPage handles the page for viewing configured alerts at /alerts

<a name="HttpServer.HandleAlertsSummaryAPI"></a>
### func \(\*HttpServer\) [HandleAlertsSummaryAPI](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/http/handleAlertsAPI.go#L133>)

```go
func (s *HttpServer) HandleAlertsSummaryAPI(w http.ResponseWriter, r *http.Request)
```

HandleAlertsSummaryAPI handles requests to the /api/alerts/summary endpoint It returns a summary of alerts grouped by rule\_id, showing the latest state and last change time.

<a name="HttpServer.HandleCacheAudit"></a>
### func \(\*HttpServer\) [HandleCacheAudit](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/http/handleDebug.go#L10>)

```go
func (s *HttpServer) HandleCacheAudit(w http.ResponseWriter, r *http.Request)
```



<a name="HttpServer.HandleCallback"></a>
### func \(\*HttpServer\) [HandleCallback](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/http/handleAuth.go#L52>)

```go
func (s *HttpServer) HandleCallback(w http.ResponseWriter, r *http.Request)
```

handleCallback handles the callback route for various auth providers.

<a name="HttpServer.HandleCommandsAPI"></a>
### func \(\*HttpServer\) [HandleCommandsAPI](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/http/handleCommandsAPI.go#L36>)

```go
func (s *HttpServer) HandleCommandsAPI(w http.ResponseWriter, r *http.Request)
```



<a name="HttpServer.HandleContainers"></a>
### func \(\*HttpServer\) [HandleContainers](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/http/containers.go#L51>)

```go
func (s *HttpServer) HandleContainers(w http.ResponseWriter, r *http.Request)
```



<a name="HttpServer.HandleCreateAlertRuleAPI"></a>
### func \(\*HttpServer\) [HandleCreateAlertRuleAPI](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/http/handleAlertsAPI.go#L167>)

```go
func (s *HttpServer) HandleCreateAlertRuleAPI(w http.ResponseWriter, r *http.Request)
```

HandleCreateAlert handles POST /api/v1/alerts

<a name="HttpServer.HandleDeleteTag"></a>
### func \(\*HttpServer\) [HandleDeleteTag](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/http/handleTagsAPI.go#L102>)

```go
func (s *HttpServer) HandleDeleteTag(w http.ResponseWriter, r *http.Request)
```

HandleDeleteTag deletes a specific tag key

<a name="HttpServer.HandleEndpointDetail"></a>
### func \(\*HttpServer\) [HandleEndpointDetail](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/http/handleEndpoints.go#L101>)

```go
func (s *HttpServer) HandleEndpointDetail(w http.ResponseWriter, r *http.Request)
```



<a name="HttpServer.HandleEndpointPage"></a>
### func \(\*HttpServer\) [HandleEndpointPage](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/http/handleEndpoints.go#L63>)

```go
func (s *HttpServer) HandleEndpointPage(w http.ResponseWriter, r *http.Request)
```



<a name="HttpServer.HandleEndpointsAPI"></a>
### func \(\*HttpServer\) [HandleEndpointsAPI](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/http/handleEndpoints.go#L200>)

```go
func (s *HttpServer) HandleEndpointsAPI(w http.ResponseWriter, r *http.Request)
```

HandleEndpointsAPI returns a JSON list of active endpoints It supports querying or listing all endpoints as well as /api/v1/endpoints/\{endpoint\_type\} \(hosts / containers\)

<a name="HttpServer.HandleEndpointsByTypeAPI"></a>
### func \(\*HttpServer\) [HandleEndpointsByTypeAPI](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/http/handleEndpoints.go#L330>)

```go
func (s *HttpServer) HandleEndpointsByTypeAPI(w http.ResponseWriter, r *http.Request)
```

HandleEndpointsByTypeAPI handles the /api/v1/endpoints/\{endpointType\} endpoint. It returns a JSON list of active endpoints filtered by the specified type \(hosts or containers\). It supports querying or listing all endpoints of the specified type. The endpoint type is specified in the URL path.

<a name="HttpServer.HandleEventsAPI"></a>
### func \(\*HttpServer\) [HandleEventsAPI](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/http/handleEventAPI.go#L30>)

```go
func (s *HttpServer) HandleEventsAPI(w http.ResponseWriter, r *http.Request)
```



<a name="HttpServer.HandleExportQuery"></a>
### func \(\*HttpServer\) [HandleExportQuery](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/http/handleMetricCacheAPI.go#L368>)

```go
func (s *HttpServer) HandleExportQuery(w http.ResponseWriter, r *http.Request)
```

ExportQueryHandler handles flexible label\-based queries without requiring a metric name. Supports optional time range via start= and end= query params.

<a name="HttpServer.HandleGetTags"></a>
### func \(\*HttpServer\) [HandleGetTags](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/http/handleTagsAPI.go#L36>)

```go
func (s *HttpServer) HandleGetTags(w http.ResponseWriter, r *http.Request)
```

HandleGetTags returns all tags for an endpoint

<a name="HttpServer.HandleGlobalSearchAPI"></a>
### func \(\*HttpServer\) [HandleGlobalSearchAPI](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/http/handleSearchAPI.go#L42>)

```go
func (s *HttpServer) HandleGlobalSearchAPI(w http.ResponseWriter, r *http.Request)
```



<a name="HttpServer.HandleIndexPage"></a>
### func \(\*HttpServer\) [HandleIndexPage](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/http/handleIndex.go#L35>)

```go
func (s *HttpServer) HandleIndexPage(w http.ResponseWriter, r *http.Request)
```



<a name="HttpServer.HandleLabelValues"></a>
### func \(\*HttpServer\) [HandleLabelValues](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/http/handleLabelsAPI.go#L36>)

```go
func (s *HttpServer) HandleLabelValues(w http.ResponseWriter, r *http.Request)
```

HandleLabelValues returns all values for a given label key from

<a name="HttpServer.HandleLogAPI"></a>
### func \(\*HttpServer\) [HandleLogAPI](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/http/handleLogAPI.go#L92>)

```go
func (s *HttpServer) HandleLogAPI(w http.ResponseWriter, r *http.Request)
```



<a name="HttpServer.HandleLogin"></a>
### func \(\*HttpServer\) [HandleLogin](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/http/handleAuth.go#L160>)

```go
func (s *HttpServer) HandleLogin(w http.ResponseWriter, r *http.Request)
```

HandleLogin renders the login page. It lists all available auth providers and handles flash messages.

<a name="HttpServer.HandleLoginStart"></a>
### func \(\*HttpServer\) [HandleLoginStart](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/http/handleAuth.go#L42>)

```go
func (s *HttpServer) HandleLoginStart(w http.ResponseWriter, r *http.Request)
```

startLogin handles the login/start route for various auth providers.

<a name="HttpServer.HandleLogout"></a>
### func \(\*HttpServer\) [HandleLogout](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/http/handleAuth.go#L283>)

```go
func (s *HttpServer) HandleLogout(w http.ResponseWriter, r *http.Request)
```

HandleLogout handles the logout process.

<a name="HttpServer.HandleLogsPage"></a>
### func \(\*HttpServer\) [HandleLogsPage](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/http/handleLogsPage.go#L34>)

```go
func (s *HttpServer) HandleLogsPage(w http.ResponseWriter, r *http.Request)
```



<a name="HttpServer.HandleMFA"></a>
### func \(\*HttpServer\) [HandleMFA](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/http/handleAuth.go#L191>)

```go
func (s *HttpServer) HandleMFA(w http.ResponseWriter, r *http.Request)
```



<a name="HttpServer.HandleMFAPage"></a>
### func \(\*HttpServer\) [HandleMFAPage](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/http/handleAuth.go#L269>)

```go
func (s *HttpServer) HandleMFAPage(w http.ResponseWriter, r *http.Request)
```



<a name="HttpServer.HandleMetricExplorerPage"></a>
### func \(\*HttpServer\) [HandleMetricExplorerPage](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/http/handleMetricExplorer.go#L40>)

```go
func (s *HttpServer) HandleMetricExplorerPage(w http.ResponseWriter, r *http.Request)
```



<a name="HttpServer.HandlePatchTags"></a>
### func \(\*HttpServer\) [HandlePatchTags](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/http/handleTagsAPI.go#L72>)

```go
func (s *HttpServer) HandlePatchTags(w http.ResponseWriter, r *http.Request)
```

HandlePatchTags updates or adds individual tags

<a name="HttpServer.HandleRecentLogs"></a>
### func \(\*HttpServer\) [HandleRecentLogs](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/http/handleLogAPI.go#L47>)

```go
func (s *HttpServer) HandleRecentLogs(w http.ResponseWriter, r *http.Request)
```



<a name="HttpServer.HandleSetTags"></a>
### func \(\*HttpServer\) [HandleSetTags](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/http/handleTagsAPI.go#L52>)

```go
func (s *HttpServer) HandleSetTags(w http.ResponseWriter, r *http.Request)
```

HandleSetTags replaces all tags for an endpoint

<a name="HttpServer.HandleTagKeys"></a>
### func \(\*HttpServer\) [HandleTagKeys](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/http/handleTagsAPI.go#L123>)

```go
func (s *HttpServer) HandleTagKeys(w http.ResponseWriter, r *http.Request)
```

HandleTagKeys returns all known tag keys

<a name="HttpServer.HandleTagValues"></a>
### func \(\*HttpServer\) [HandleTagValues](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/http/handleTagsAPI.go#L129>)

```go
func (s *HttpServer) HandleTagValues(w http.ResponseWriter, r *http.Request)
```

HandleTagValues returns all values for a given key

<a name="HttpServer.Shutdown"></a>
### func \(\*HttpServer\) [Shutdown](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/http/httpserver.go#L116>)

```go
func (s *HttpServer) Shutdown() error
```



<a name="HttpServer.Start"></a>
### func \(\*HttpServer\) [Start](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/http/httpserver.go#L61>)

```go
func (s *HttpServer) Start() error
```



<a name="LogResponse"></a>
## type [LogResponse](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/http/handleLogAPI.go#L85-L90>)

HandleLogAPI handles the HTTP request for the log API. It retrieves the logs from the log store, applies any filters specified in the query parameters, and returns the logs as a JSON response. The function uses the LogQueryParams struct to parse the query parameters and filter the logs. It handles errors and returns appropriate HTTP status codes and messages. The logs are filtered based on the specified levels, unit, source, contains string, and start and end times. The function limits the number of logs returned to the specified limit in the query parameters, with a maximum of 1000 logs. If the limit is not specified, it defaults to 100 logs. The function also handles errors and returns appropriate HTTP status codes and messages.

```go
type LogResponse struct {
    Logs       []model.LogEntry `json:"logs"`
    NextCursor string           `json:"next_cursor,omitempty"`
    HasMore    bool             `json:"has_more"`
    Count      int              `json:"count"`
}
```

<a name="SearchResult"></a>
## type [SearchResult](<https://github.com/aaronlmathis/gosight-server/blob/main/internal/http/handleSearchAPI.go#L34-L40>)



```go
type SearchResult struct {
    Hosts      []map[string]string `json:"hosts"`
    Containers []map[string]string `json:"containers"`
    Rules      []map[string]string `json:"rules"`
    Tags       []map[string]string `json:"tags"`
    Logs       []map[string]string `json:"logs"`
}
```

Generated by [gomarkdoc](<https://github.com/princjef/gomarkdoc>)
