- id: high-mem-usage
  name: Memory Over 80% Hand Typed
  enabled: false
  level: warning
  expression: "memory_used_percent > 80"
  message: "Memory usage is over 80%"
  match:
    namespace: System
    subnamespace: Memory
    metric: used_percent
    endpoint_ids:
      - host-test-123
  actions:
    - notify-local
  cooldown: 1m
  eval_interval: 10s


- id: cpu-high
  name: CPU Usage > 50%
  enabled: true
  level: warning
  expression: "cpu_usage_percent > 50"
  message: "CPU usage is over 50%"
  type: metric
  match:
    namespace: System
    subnamespace: CPU
    metric: total_percent
    endpoint_ids:
      - host-233b50c6-efa
  actions:
    - notify-local
  cooldown: 30s
  eval_interval: 10s
  repeat_interval: 1m
  notify_on_resolve: true


# Log Rules
- id: "critical-ssh-auth-failure"
  name: "Critical SSH Authentication Failure"
  enabled: true
  type: "log"
  level: "critical"
  expression: 'level == "error" && source == "sshd" && contains(message, "Failed password")'
  message: "SSH authentication failed"
  match:
    labels:
      environment: "production"
  actions:
  - "local-slacktest"

- id: "sudo-auth-failure"
  name: "Sudo Authentication Failure"
  enabled: true
  type: "log"
  level: "error"
  expression: 'level == "error" && source == "sudo" && contains(message, "incorrect password")'
  message: "Sudo authentication failure"
  match: {}
  actions:
    - "local-slacktest"

