<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>GoSight Dashboard</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <link rel="stylesheet" href="/css/output.css" />
    <!-- Flowbite CSS (optional if you're using Tailwind CDN only) -->
    <link
      href="https://cdnjs.cloudflare.com/ajax/libs/flowbite/2.2.1/flowbite.min.css"
      rel="stylesheet"
    />

    <!-- Flowbite JS (required for dropdowns, modals, etc.) -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/flowbite/2.2.1/flowbite.min.js"></script>

    <!-- Optional: Popper.js for dropdowns/tooltips -->
    <script src="https://unpkg.com/@popperjs/core@2"></script>
  </head>

  <body
    class="bg-gray-100 dark:bg-gray-900 text-gray-900 dark:text-white font-sans antialiased"
  >
      <!-- Environment banner -->
      <div class="bg-yellow-100 text-yellow-800 px-4 py-2 text-xs font-semibold text-center">
        ‚ö†Ô∏è You are viewing a DEV mockup environment ‚Äî metrics are simulated
      </div>
  
      <!-- Alert message -->
      <div class="bg-red-100 text-red-800 border border-red-300 px-4 py-3 text-sm text-center">
        üö® Alert: Disk usage on <strong>DeepThought</strong> exceeds 85%
      </div>
    <div class="flex min-h-screen">
      <!-- Sidebar -->
      <aside class="w-64 bg-gray-900 text-gray-100 p-6 flex flex-col justify-between border-r border-gray-800">
        <div>
          <!-- Logo/Header -->
          <div class="flex items-center justify-between mb-10">
            <h1 class="text-xl font-bold text-blue-400 tracking-wide">GoSight</h1>
            <span class="text-xs bg-gray-800 text-gray-300 font-semibold px-2 py-1 rounded">DEV</span>
          </div>
      
          <!-- Nav -->
          <nav class="space-y-2 text-sm" id="sidebar-nav">
            <a href="/" class="flex items-center px-3 py-2 rounded-lg hover:bg-gray-800 transition">
              <svg class="w-5 h-5 text-gray-400 mr-3" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" d="M3 9.75L12 4.5l9 5.25M4.5 10.5v7.5a1.5 1.5 0 001.5 1.5H9v-4.5h6V19.5h3a1.5 1.5 0 001.5-1.5v-7.5" />
              </svg>
              Dashboard
            </a>
      
            <a href="/metrics" class="flex items-center px-3 py-2 rounded-lg hover:bg-gray-800 transition">
              <svg class="w-5 h-5 text-gray-400 mr-3" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" d="M11 3v18m4-14v14m4-10v10m-12 4v-6m-4 2v4" />
              </svg>
              Metrics
            </a>
      
            <a href="/agents" class="flex items-center px-3 py-2 rounded-lg hover:bg-gray-800 transition">
              <svg class="w-5 h-5 text-gray-400 mr-3" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" d="M5.121 17.804A13.944 13.944 0 0112 15c2.136 0 4.153.502 5.879 1.388M15 10a3 3 0 11-6 0 3 3 0 016 0z" />
              </svg>
              Agents
            </a>
      
            <a href="/endpoints" class="flex items-center px-3 py-2 rounded-lg bg-gray-800 text-white transition">
              <svg class="w-5 h-5 text-blue-400 mr-3" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" d="M6 18L18 6M6 6l12 12" />
              </svg>
              Endpoints
            </a>
      
            <a href="/logs" class="flex items-center px-3 py-2 rounded-lg hover:bg-gray-800 transition">
              <svg class="w-5 h-5 text-gray-400 mr-3" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" d="M4 4h16v16H4z" />
              </svg>
              Logs
            </a>
      
            <a href="/config" class="flex items-center px-3 py-2 rounded-lg hover:bg-gray-800 transition">
              <svg class="w-5 h-5 text-gray-400 mr-3" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" d="M12 6v6m0 0v6m0-6h6m-6 0H6" />
              </svg>
              Config
            </a>
          </nav>
        </div>
      
        <!-- Footer -->
        <div class="text-gray-500 text-xs mt-6">
          <p class="text-gray-400">Version: <span class="text-white font-semibold">1.0.0</span></p>
        </div>
      </aside>

      <!-- Main content -->
      <div class="flex-1 flex flex-col">
        <!-- Top Nav -->
        <header class="w-full px-6 py-3 0 z-50">
          <!----BREADCRUMBS   -->
          <div class="flex items-center justify-between">
            <nav class="flex" aria-label="Breadcrumb">
              <ol class="inline-flex items-center space-x-1 md:space-x-2">
                <li class="inline-flex items-center">
                  <a
                    href="#"
                    class="inline-flex items-center text-sm font-medium text-gray-700 hover:text-blue-600 dark:text-gray-400 dark:hover:text-white"
                  >
                    <svg
                      class="w-3 h-3 mr-2.5"
                      aria-hidden="true"
                      xmlns="http://www.w3.org/2000/svg"
                      fill="currentColor"
                      viewBox="0 0 20 20"
                    >
                      <path
                        d="m19.707 9.293-2-2-7-7a1 1 0 0 0-1.414 0l-7 7-2 2a1 1 0 0 0 1.414 1.414L2 10.414V18a2 2 0 0 0 2 2h3a1 1 0 0 0 1-1v-4a1 1 0 0 1 1-1h2a1 1 0 0 1 1 1v4a1 1 0 0 0 1 1h3a2 2 0 0 0 2-2v-7.586l.293.293a1 1 0 0 0 1.414-1.414Z"
                      />
                    </svg>
                    Home
                  </a>
                </li>
                <li>
                  <div class="flex items-center">
                    <svg
                      class="w-3 h-3 text-gray-400 mx-1"
                      aria-hidden="true"
                      xmlns="http://www.w3.org/2000/svg"
                      fill="none"
                      viewBox="0 0 6 10"
                    >
                      <path
                        stroke="currentColor"
                        stroke-linecap="round"
                        stroke-linejoin="round"
                        stroke-width="2"
                        d="m1 9 4-4-4-4"
                      />
                    </svg>
                    <a
                      href="#"
                      class="ml-1 text-sm font-medium text-gray-700 hover:text-blue-600 md:ml-2 dark:text-gray-400 dark:hover:text-white"
                      >Projects</a
                    >
                  </div>
                </li>
                <li aria-current="page">
                  <div class="flex items-center">
                    <svg
                      class="w-3 h-3 text-gray-400 mx-1"
                      aria-hidden="true"
                      xmlns="http://www.w3.org/2000/svg"
                      fill="none"
                      viewBox="0 0 6 10"
                    >
                      <path
                        stroke="currentColor"
                        stroke-linecap="round"
                        stroke-linejoin="round"
                        stroke-width="2"
                        d="m1 9 4-4-4-4"
                      />
                    </svg>
                    <span
                      class="ml-1 text-sm font-medium text-gray-500 md:ml-2 dark:text-gray-400"
                      >Flowbite</span
                    >
                  </div>
                </li>
              </ol>
            </nav>
            <!--//
            <button
              type="button"
              class="flex text-sm bg-gray-800 rounded-full md:mr-0 focus:ring-4 focus:ring-gray-300 dark:focus:ring-gray-600"
              id="user-menu-button"
              aria-expanded="false"
              data-dropdown-toggle="user-dropdown"
              data-dropdown-placement="bottom"
            >
              <span class="sr-only">Open user menu</span>
              <img
                class="w-8 h-8 rounded-full"
                src="/docs/images/people/profile-picture-3.jpg"
                alt="user photo"
              />
            </button>-->
            <!-- Dropdown menu 
            <div
              class="z-50 hidden my-4 text-base list-none bg-white divide-y divide-gray-100 rounded-lg shadow-sm dark:bg-gray-700 dark:divide-gray-600"
              id="user-dropdown"
            >
              <div class="px-4 py-3">
                <span class="block text-sm text-gray-900 dark:text-white"
                  >Bonnie Green</span
                >
                <span
                  class="block text-sm text-gray-500 truncate dark:text-gray-400"
                  >name@flowbite.com</span
                >
              </div>
              <ul class="py-2" aria-labelledby="user-menu-button">
                <li>
                  <a
                    href="#"
                    class="block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 dark:hover:bg-gray-600 dark:text-gray-200 dark:hover:text-white"
                    >Dashboard</a
                  >
                </li>
                <li>
                  <a
                    href="#"
                    class="block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 dark:hover:bg-gray-600 dark:text-gray-200 dark:hover:text-white"
                    >Settings</a
                  >
                </li>
                <li>
                  <a
                    href="#"
                    class="block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 dark:hover:bg-gray-600 dark:text-gray-200 dark:hover:text-white"
                    >Earnings</a
                  >
                </li>
                <li>
                  <a
                    href="#"
                    class="block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 dark:hover:bg-gray-600 dark:text-gray-200 dark:hover:text-white"
                    >Sign out</a
                  >
                </li>
              </ul>
            </div>
            <button
              data-collapse-toggle="navbar-user"
              type="button"
              class="inline-flex items-center p-2 w-10 h-10 justify-center text-sm text-gray-500 rounded-lg md:hidden hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-gray-200 dark:text-gray-400 dark:hover:bg-gray-700 dark:focus:ring-gray-600"
              aria-controls="navbar-user"
              aria-expanded="false"
            >
              <span class="sr-only">Open main menu</span>
              <svg
                class="w-5 h-5"
                aria-hidden="true"
                xmlns="http://www.w3.org/2000/svg"
                fill="none"
                viewBox="0 0 17 14"
              >
                <path
                  stroke="currentColor"
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M1 1h15M1 7h15M1 13h15"
                />
              </svg>
            </button>
          </div>-->
        </header>
        <!--- End BREADCRUMBS    -->

        <!-- Page Content -->
        <main class="flex-1 p-6 w-full">{{ block "content" . }}{{ end }}</main>
      </div>
    </div>

    {{ block "scripts" . }}
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://unpkg.com/flowbite@1.7.0/dist/flowbite.min.js"></script>
    <script>
      console.log("Flowbite:", window.Flowbite);
      
      const charts = {};

      const renderMiniCharts = () => {
        new Chart(document.getElementById("miniCpuChart"), {
          type: "line",
          data: {
            labels: ["1m", "2m", "3m", "4m", "5m"],
            datasets: [
              {
                data: [12, 18, 14, 20, 17],
                borderColor: "#3b82f6",
                backgroundColor: "rgba(59, 130, 246, 0.1)",
                tension: 0,
                fill: true,
                pointRadius: 0,
              },
            ],
          },
          options: {
            plugins: { legend: { display: false } },
            scales: { y: { display: true }, x: { display: true } },
            elements: { line: { borderWidth: 2 } },
            responsive: true,
          },
        });

        new Chart(document.getElementById("miniMemoryChart"), {
          type: "line",
          data: {
            labels: ["1m", "2m", "3m", "4m", "5m"],
            datasets: [
              {
                data: [6.2, 6.3, 6.1, 6.4, 6.6],
                borderColor: "#10b981",
                backgroundColor: "rgba(16, 185, 129, 0.1)",
                tension: 0,
                fill: true,
                pointRadius: 0,
              },
            ],
          },
          options: {
            plugins: { legend: { display: false } },
            scales: { y: { display: true }, x: { display: true } },
            elements: { line: { borderWidth: 2 } },
            responsive: true,
          },
        });

        new Chart(document.getElementById("miniDiskChart"), {
          type: "line",
          data: {
            labels: ["1m", "2m", "3m", "4m", "5m"],
            datasets: [
              {
                data: [110, 135, 90, 120, 140],
                borderColor: "#f59e0b",
                backgroundColor: "rgba(245, 158, 11, 0.1)",
                tension: 0,
                fill: true,
                pointRadius: 0,
              },
            ],
          },
          options: {
            plugins: { legend: { display: false } },
            scales: { y: { display: true }, x: { display: true } },
            elements: { line: { borderWidth: 2 } },
            responsive: true,
          },
        });
      };

      const renderCpuCharts = () => {
        if (charts.cpuUsageChart) return;

        charts.cpuUsageChart = new Chart(
          document.getElementById("cpuUsageChart"),
          {
            type: "line",
            data: {
              labels: Array.from({ length: 60 }, (_, i) => `${i + 1}m`),
              datasets: [
                {
                  label: "CPU Usage %",
                  data: [
                    20, 23, 35, 64, 85, 2, 45, 27, 24, 22, 18, 40, 33, 56, 70,
                    15, 48, 29, 26, 30, 35, 60, 25, 19, 22, 31, 58, 12, 44, 39,
                    21, 18, 50, 62, 38, 24, 10, 36, 43, 47, 29, 34, 59, 28, 26,
                    31, 55, 61, 17, 19, 25, 41, 48, 53, 60, 20, 22, 30, 35, 40,
                  ],
                  borderColor: "#3b82f6",
                  backgroundColor: "rgba(59, 130, 246, 0.1)",
                  fill: true,
                  tension: 0,
                  pointRadius: 2,
                },
              ],
            },
            options: {
              responsive: true,
              maintainAspectRatio: false,
              scales: {
                y: {
                  beginAtZero: true,
                  min: 0,
                  max: 100,
                  ticks: {
                    callback: (val) => val + "%",
                  },
                },
                x: {
                  display: true,
                },
              },
              plugins: {
                legend: {
                  labels: { color: "#4B5563" },
                },
              },
            },
          }
        );

        charts.cpuDonutChart = new Chart(
          document.getElementById("cpuDonutChart"),
          {
            type: "doughnut",
            data: {
              labels: ["User", "System", "Idle", "Nice"],
              datasets: [
                {
                  label: "CPU Time",
                  data: [13400, 7300, 28000, 1200],
                  backgroundColor: ["#3b82f6", "#10b981", "#9ca3af", "#fbbf24"],
                  borderWidth: 1,
                },
              ],
            },
            options: {
              responsive: true,
              plugins: {
                legend: {
                  position: "bottom",
                  labels: { color: "#4B5563" },
                },
              },
            },
          }
        );
      };
      const renderMemoryCharts = () => {
  if (charts.memoryUsageChart) return;

  charts.memoryUsageChart = new Chart(
    document.getElementById("memoryUsageChart"),
    {
      type: "line",
      data: {
        labels: Array.from({ length: 10 }, (_, i) => `${10 - i}m`),
        datasets: [
          {
            label: "Memory Used (GB)",
            data: [11.5, 11.7, 12.0, 12.2, 12.4, 12.3, 12.1, 12.3, 12.4, 12.4],
            borderColor: "#10b981",
            backgroundColor: "rgba(16, 185, 129, 0.1)",
            fill: true,
            tension: 0,
            pointRadius: 2,
          },
        ],
      },
      options: {
        responsive: true,
        maintainAspectRatio: false,
        scales: {
          y: {
            beginAtZero: false,
            ticks: {
              callback: (val) => val + " GB",
            },
          },
        },
        plugins: {
          legend: {
            labels: { color: "#4B5563" },
          },
        },
      },
    }
  );

  charts.memoryDonutChart = new Chart(
    document.getElementById("memoryDonutChart"),
    {
      type: "doughnut",
      data: {
        labels: ["Used", "Free", "Buffers", "Cache"],
        datasets: [
          {
            label: "Memory Distribution",
            data: [12.4, 17.9, 0.8, 0.9],
            backgroundColor: ["#10b981", "#3b82f6", "#f59e0b", "#f87171"],
            borderWidth: 1,
          },
        ],
      },
      options: {
        responsive: true,
        plugins: {
          legend: {
            position: "bottom",
            labels: { color: "#4B5563" },
          },
        },
      },
    }
  );
};

// Memory tab render trigger
document
  .getElementById("memory-tab")
  ?.addEventListener("click", renderMemoryCharts);

      document.addEventListener("DOMContentLoaded", () => {
        renderMiniCharts(); // immediately load mini charts
        renderCpuCharts(); // preload CPU tab
        renderMemoryCharts(); // preload Memory tab
      });

      document
        .getElementById("cpu-tab")
        ?.addEventListener("click", renderCpuCharts);
    </script>

    {{ end }}
  </body>
</html>
